

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/trustweave/assets/css/just-the-docs-default.css">

  <link rel="stylesheet" href="/trustweave/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet">

  <style id="jtd-nav-activation">
  
    .site-nav ul li a {
      background-image: none;
    }

  </style>

  

  
    <script src="/trustweave/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/trustweave/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>IoT &amp; Device Identity Scenario | TrustWeave Developer Documentation</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="IoT &amp; Device Identity Scenario" />
<meta name="author" content="GeoKnoesis" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin" />
<meta property="og:description" content="Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin" />
<link rel="canonical" href="https://geoknoesis.github.io/trustweave/scenarios/iot-device-identity-scenario/" />
<meta property="og:url" content="https://geoknoesis.github.io/trustweave/scenarios/iot-device-identity-scenario/" />
<meta property="og:site_name" content="TrustWeave Developer Documentation" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="IoT &amp; Device Identity Scenario" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"GeoKnoesis"},"description":"Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin","headline":"IoT &amp; Device Identity Scenario","url":"https://geoknoesis.github.io/trustweave/scenarios/iot-device-identity-scenario/"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Main Navigation Styles - Consistent across all pages -->
<style>
  :root {
    --primary: #2563eb;
    --primary-dark: #1e40af;
    --secondary: #7c3aed;
    --accent: #10b981;
    --text: #1f2937;
    --text-light: #6b7280;
    --bg: #ffffff;
    --bg-light: #f9fafb;
    --border: #e5e7eb;
    --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }

  .main-nav {
    position: fixed;
    top: 0;
    width: 100%;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border);
    z-index: 1000;
    padding: 0.5rem 0;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  }
  
  .main-nav .nav-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .main-nav .logo {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    text-decoration: none;
    transition: opacity 0.3s;
  }

  .main-nav .logo-img {
    height: 120px;
    width: auto;
    transition: opacity 0.3s;
    display: block;
  }

  .main-nav .logo-img:not([src]),
  .main-nav .logo-img[src=""],
  .main-nav .logo-img[src*="undefined"] {
    display: none;
  }


  .main-nav .logo:hover {
    opacity: 0.8;
  }

  .main-nav .logo:hover .logo-img {
    opacity: 0.8;
  }
  
  .main-nav .nav-links {
    display: flex;
    gap: 1.5rem;
    align-items: center;
  }
  
  .main-nav .nav-links .nav-link {
    text-decoration: none;
    color: var(--text);
    font-weight: 500;
    font-size: 0.95rem;
    padding: 0.5rem 0;
    transition: color 0.3s;
    position: relative;
    white-space: nowrap;
  }
  
  .main-nav .nav-links .nav-link:hover {
    color: var(--primary);
  }

  .main-nav .nav-links .nav-link::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 2px;
    background: var(--primary);
    transition: width 0.3s ease;
  }

  .main-nav .nav-links .nav-link:hover::after,
  .main-nav .nav-links .nav-link.active::after {
    width: 100%;
  }

  .main-nav .nav-links .nav-link.active {
    color: var(--primary);
    font-weight: 600;
  }

  /* GitHub icon button */
  .main-nav .nav-links .github-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    border-radius: 0.5rem;
    transition: all 0.3s;
    padding: 0.5rem;
    color: var(--text);
    text-decoration: none;
    margin-left: 0.5rem;
  }

  .main-nav .nav-links .github-icon:hover {
    background: var(--bg-light);
    transform: translateY(-2px);
    color: var(--primary);
  }

  .main-nav .nav-links .github-icon svg {
    width: 32px;
    height: 32px;
  }

  /* Mobile menu toggle */
  .menu-toggle {
    display: none;
    flex-direction: column;
    cursor: pointer;
    gap: 5px;
    padding: 0.5rem;
    z-index: 1001;
  }

  .menu-toggle span {
    width: 25px;
    height: 3px;
    background: var(--text);
    transition: all 0.3s;
    border-radius: 2px;
  }

  .menu-toggle.active span:nth-child(1) {
    transform: rotate(45deg) translate(8px, 8px);
  }

  .menu-toggle.active span:nth-child(2) {
    opacity: 0;
  }

  .menu-toggle.active span:nth-child(3) {
    transform: rotate(-45deg) translate(7px, -7px);
  }

  /* Footer styles */
  .site-footer {
    background: var(--text);
    color: white;
    padding: 3rem 2rem;
    text-align: center;
    margin-top: 4rem;
  }

  .site-footer .footer-content {
    max-width: 1200px;
    margin: 0 auto;
  }

  .site-footer .footer-links {
    display: flex;
    justify-content: center;
    gap: 2rem;
    margin-bottom: 2rem;
    flex-wrap: wrap;
  }

  .site-footer .footer-links a {
    color: rgba(255, 255, 255, 0.8);
    text-decoration: none;
    transition: color 0.3s;
  }

  .site-footer .footer-links a:hover {
    color: white;
  }

  .site-footer .footer-text {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.875rem;
  }

  /* Adjust content for fixed nav */
  body {
    padding-top: 160px;
  }

  /* Just the Docs theme adjustments */
  .site-header {
    margin-top: 0 !important;
  }

  /* Mobile responsive */
  @media (max-width: 968px) {
    .menu-toggle {
      display: flex;
    }

    .main-nav .nav-links {
      position: fixed;
      top: 160px;
      left: 0;
      right: 0;
      background: white;
      flex-direction: column;
      padding: 2rem;
      border-bottom: 1px solid var(--border);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transform: translateY(-100%);
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      gap: 1.5rem;
      align-items: flex-start;
      max-height: calc(100vh - 160px);
      overflow-y: auto;
    }

    .main-nav .nav-links.active {
      transform: translateY(0);
      opacity: 1;
      visibility: visible;
    }

    .main-nav .nav-links .nav-link {
      width: 100%;
      padding: 0.75rem 0;
      border-bottom: 1px solid var(--border);
    }

    .main-nav .nav-links .nav-link::after {
      display: none;
    }

    .main-nav .nav-links .github-icon {
      width: 100%;
      justify-content: flex-start;
      margin-left: 0;
      padding: 0.75rem 0;
      border-bottom: 1px solid var(--border);
    }

    .main-nav .logo-img {
      height: 120px;
    }

    .site-footer .footer-links {
      flex-direction: column;
      gap: 1rem;
    }
  }

  /* Tablet adjustments */
  @media (max-width: 968px) and (min-width: 769px) {
    .main-nav .nav-links {
      gap: 1rem;
    }

    .main-nav .nav-links .nav-link {
      font-size: 0.9rem;
    }
  }
</style>

<style>
  body { padding-top: 160px !important; }
  .main-nav { z-index: 1000; position: fixed; top: 0; width: 100%; }
  #header-template { display: none; }
  
  /* Ensure footer spans full width and breaks out of containers */
  .site-footer {
    position: relative !important;
    width: 100vw !important;
    max-width: 100vw !important;
    margin-left: calc(-50vw + 50%) !important;
    margin-right: calc(-50vw + 50%) !important;
    left: 0 !important;
    right: 0 !important;
    clear: both !important;
    z-index: 100 !important;
    box-sizing: border-box !important;
  }
</style>
<!-- Hidden template for header injection -->
<div id="header-template" style="display: none;">
  <!-- Site Header - Consistent across all pages -->
<nav class="main-nav">
    <div class="nav-container">
        <a href="/trustweave/" class="logo">
            <img src="/trustweave/assets/images/trustweave-logo.jpg" alt="TrustWeave Logo" class="logo-img">
        </a>
        <div class="menu-toggle" id="menuToggle" aria-label="Toggle menu">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="nav-links" id="navLinks">
            <a href="/trustweave/" class="nav-link">Home</a>
            <a href="/trustweave/#features" class="nav-link">Features</a>
            <a href="/trustweave/use-scenarios/" class="nav-link">Use Scenarios</a>
            <a href="/trustweave/getting-started/README/" class="nav-link">Docs</a>
            <a href="/trustweave/partnership/" class="nav-link">Partners</a>
            <a href="/trustweave/about/" class="nav-link">About</a>
            <a href="https://github.com/geoknoesis/TrustWeave" target="_blank" rel="noopener noreferrer" class="github-icon" title="View on GitHub" aria-label="GitHub Repository">
                <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
            </a>
        </div>
    </div>
</nav>
<script>
    // Mobile menu toggle and active page highlighting
    (function() {
        const menuToggle = document.getElementById('menuToggle');
        const navLinks = document.getElementById('navLinks');
        
        // Mobile menu toggle
        if (menuToggle && navLinks) {
            menuToggle.addEventListener('click', () => {
                navLinks.classList.toggle('active');
                menuToggle.classList.toggle('active');
            });
            
            // Close menu when clicking on a link
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.addEventListener('click', () => {
                    navLinks.classList.remove('active');
                    menuToggle.classList.remove('active');
                });
            });
            
            // Close menu when clicking outside
            document.addEventListener('click', (e) => {
                if (!menuToggle.contains(e.target) && !navLinks.contains(e.target)) {
                    navLinks.classList.remove('active');
                    menuToggle.classList.remove('active');
                }
            });
        }

        // Highlight active page
        const currentPath = window.location.pathname;
        const navLinksList = document.querySelectorAll('.nav-links .nav-link');
        
        navLinksList.forEach(link => {
            try {
                const linkUrl = new URL(link.href, window.location.origin);
                const linkPath = linkUrl.pathname;
                const baseUrl = '/trustweave' || '';
                
                // Normalize paths
                let cleanCurrentPath = currentPath.replace(baseUrl, '').replace(/\/$/, '') || '/';
                let cleanLinkPath = linkPath.replace(baseUrl, '').replace(/\/$/, '') || '/';
                
                // Handle index pages
                if (cleanCurrentPath === '' || cleanCurrentPath === '/index.html') cleanCurrentPath = '/';
                if (cleanLinkPath === '' || cleanLinkPath === '/index.html') cleanLinkPath = '/';
                
                // Check if current path matches link path
                if (cleanCurrentPath === cleanLinkPath) {
                    link.classList.add('active');
                } else if (cleanLinkPath !== '/' && cleanCurrentPath.startsWith(cleanLinkPath + '/')) {
                    // Handle sub-pages (e.g., /introduction/ matches /introduction/README/)
                    link.classList.add('active');
                }
            } catch (e) {
                // Fallback for relative URLs or errors
                const href = link.getAttribute('href');
                if (href && (currentPath.includes(href) || (href === '/' && currentPath.endsWith('index.html')))) {
                    link.classList.add('active');
                }
            }
        });
    })();
</script>


</div>
<script>
  // Move header from template to body top
  document.addEventListener('DOMContentLoaded', function() {
    const template = document.getElementById('header-template');
    if (template) {
      const header = template.querySelector('.main-nav');
      if (header) {
        document.body.insertBefore(header, document.body.firstChild);
        template.remove();
      }
    }
  });
</script>


</head>

<body>
  <a class="skip-to-main" href="#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  
    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>

  
  
    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>

  
</svg>

  
    <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="/trustweave/" class="site-title lh-tight">
  TrustWeave Developer Documentation

</a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </button>
  </div>

  <nav aria-label="Main" id="site-nav" class="site-nav">
  
  
    <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Introduction category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/introduction/README/" class="nav-list-link">Introduction</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/introduction/what-is-trustweave/" class="nav-list-link">What is TrustWeave?</a></li><li class="nav-list-item"><a href="/trustweave/introduction/executive-overview/" class="nav-list-link">Executive Overview: TrustWeave</a></li><li class="nav-list-item"><a href="/trustweave/introduction/key-features/" class="nav-list-link">Key Features</a></li><li class="nav-list-item"><a href="/trustweave/introduction/use-cases/" class="nav-list-link">Use Cases</a></li><li class="nav-list-item"><a href="/trustweave/introduction/architecture-overview/" class="nav-list-link">Architecture Overview</a></li><li class="nav-list-item"><a href="/trustweave/introduction/mental-model/" class="nav-list-link">TrustWeave Mental Model</a></li><li class="nav-list-item"><a href="/trustweave/introduction/web-of-trust/" class="nav-list-link">The Web of Trust: Foundation for Decentralized Trust</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Core Concepts category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/core-concepts/README/" class="nav-list-link">Core Concepts</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/core-concepts/dids/" class="nav-list-link">Decentralized Identifiers (DIDs)</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/verifiable-credentials/" class="nav-list-link">Verifiable Credentials (VCs)</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/wallets/" class="nav-list-link">Wallets</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/blockchain-anchoring/" class="nav-list-link">Blockchain Anchoring</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/smart-contracts/" class="nav-list-link">Smart Contracts</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/key-management/" class="nav-list-link">Key Management</a></li></ul></li><li class="nav-list-item"><a href="/trustweave/integrations/README/" class="nav-list-link">Integration Modules</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Advanced Topics category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/advanced/README/" class="nav-list-link">Advanced Topics</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/advanced/error-handling/" class="nav-list-link">Error Handling</a></li></ul></li><li class="nav-list-item"><a href="/trustweave/modules/core-modules/" class="nav-list-link">Core Modules</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Getting Started category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/getting-started/README/" class="nav-list-link">Getting Started</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/getting-started/installation/" class="nav-list-link">Installation</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/quick-start/" class="nav-list-link">Quick Start</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/your-first-application/" class="nav-list-link">Your First Application</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/project-setup/" class="nav-list-link">Project Setup</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/ide-setup/" class="nav-list-link">IDE Setup Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/common-patterns/" class="nav-list-link">Common Patterns</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/api-patterns/" class="nav-list-link">API Patterns and Best Practices</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/workflows/" class="nav-list-link">Common Workflows</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/dsl-guide/" class="nav-list-link">TrustWeave DSL Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/troubleshooting/" class="nav-list-link">Troubleshooting Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/production-deployment/" class="nav-list-link">Production Deployment Guide</a></li></ul></li><li class="nav-list-item"><a href="/trustweave/contributing/README/" class="nav-list-link">Contributing to TrustWeave</a></li><li class="nav-list-item"><a href="/trustweave/faq/" class="nav-list-link">Frequently Asked Questions</a></li><li class="nav-list-item"><a href="/trustweave/tutorials/README/" class="nav-list-link">Tutorials</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in How-To Guides category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/how-to/README/" class="nav-list-link">How-To Guides</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/how-to/create-dids/" class="nav-list-link">Create and Manage DIDs</a></li><li class="nav-list-item"><a href="/trustweave/how-to/issue-credentials/" class="nav-list-link">Issue Credentials</a></li><li class="nav-list-item"><a href="/trustweave/how-to/verify-credentials/" class="nav-list-link">Verify Credentials</a></li><li class="nav-list-item"><a href="/trustweave/how-to/manage-wallets/" class="nav-list-link">Manage Wallets</a></li><li class="nav-list-item"><a href="/trustweave/how-to/blockchain-anchoring/" class="nav-list-link">Anchor to Blockchain</a></li></ul></li><li class="nav-list-item"><a href="/trustweave/concepts/README/" class="nav-list-link">Concepts</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in API Reference category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/api-reference/README/" class="nav-list-link">API Reference</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/api-reference/quick-reference/" class="nav-list-link">Quick Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/error-types/" class="nav-list-link">Error Types</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/data-types/" class="nav-list-link">Data Types</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/core-api/" class="nav-list-link">Core API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/wallet-api/" class="nav-list-link">Wallet API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/credential-service-api/" class="nav-list-link">Credential Service API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/smart-contract-api/" class="nav-list-link">Smart Contract API Reference</a></li></ul></li><li class="nav-list-item"><a href="/trustweave/reference/README/" class="nav-list-link">Reference</a></li></ul>
  
</nav>




  
  
    <footer class="site-footer">
      This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.
    </footer>
  
</div>

  
  <div class="main" id="top">
    <div id="main-header" class="main-header">
  
    

<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search TrustWeave Developer Documentation" aria-label="Search TrustWeave Developer Documentation" autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>

  
  
  
</div>

    <div class="main-content-wrap">
      
      <div id="main-content" class="main-content">
        <main>
          
            <h1 id="iot--device-identity-scenario">
  
  
    <a href="#iot--device-identity-scenario" class="anchor-heading" aria-labelledby="iot--device-identity-scenario"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IoT &amp; Device Identity Scenario
  
  
</h1>
    

<p>This guide demonstrates how to build an IoT device identity system using TrustWeave that enables device authentication, secure device-to-device communication, device attestation, and network authorization.</p>
<h2 id="what-youll-build">
  
  
    <a href="#what-youll-build" class="anchor-heading" aria-labelledby="what-youll-build"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What You’ll Build
  
  
</h2>
    

<p>By the end of this tutorial, you’ll have:</p>

<ul>
  <li>✅ Created DIDs for IoT devices and device manufacturers</li>
  <li>✅ Issued device attestation credentials</li>
  <li>✅ Built secure device-to-device communication</li>
  <li>✅ Implemented device capability proofs</li>
  <li>✅ Created network authorization system</li>
  <li>✅ Anchored device identity to blockchain</li>
  <li>✅ Built device lifecycle management</li>
</ul>
<h2 id="big-picture--significance">
  
  
    <a href="#big-picture--significance" class="anchor-heading" aria-labelledby="big-picture--significance"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Big Picture &amp; Significance
  
  
</h2>
    
<h3 id="the-iot-identity-challenge">
  
  
    <a href="#the-iot-identity-challenge" class="anchor-heading" aria-labelledby="the-iot-identity-challenge"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The IoT Identity Challenge
  
  
</h3>
    

<p>The Internet of Things (IoT) is rapidly expanding, with billions of devices connecting to networks. Each device needs a secure, verifiable identity to enable trusted communication, prevent unauthorized access, and ensure device authenticity.</p>

<p><strong>Industry Context</strong>:</p>
<ul>
  <li><strong>Market Size</strong>: Global IoT market projected to reach $1.8 trillion by 2028</li>
  <li><strong>Device Count</strong>: Over 30 billion IoT devices expected by 2025</li>
  <li><strong>Security Concerns</strong>: IoT devices are prime targets for cyberattacks</li>
  <li><strong>Regulatory Pressure</strong>: Increasing requirements for device security and identity</li>
  <li><strong>Interoperability</strong>: Need for devices from different manufacturers to work together</li>
</ul>

<p><strong>Why This Matters</strong>:</p>
<ol>
  <li><strong>Security</strong>: Prevent unauthorized device access and attacks</li>
  <li><strong>Trust</strong>: Verify device authenticity and capabilities</li>
  <li><strong>Interoperability</strong>: Enable devices from different manufacturers to communicate</li>
  <li><strong>Scalability</strong>: Handle millions of devices efficiently</li>
  <li><strong>Compliance</strong>: Meet regulatory requirements for device security</li>
  <li><strong>Device Lifecycle</strong>: Manage device identity throughout lifecycle</li>
</ol>
<h3 id="the-iot-device-problem">
  
  
    <a href="#the-iot-device-problem" class="anchor-heading" aria-labelledby="the-iot-device-problem"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The IoT Device Problem
  
  
</h3>
    

<p>Traditional IoT device management faces critical issues:</p>
<ul>
  <li><strong>Weak Authentication</strong>: Default passwords, no identity verification</li>
  <li><strong>No Device Identity</strong>: Devices lack verifiable identities</li>
  <li><strong>Trust Issues</strong>: Can’t verify device authenticity or capabilities</li>
  <li><strong>Scalability</strong>: Centralized management doesn’t scale</li>
  <li><strong>Interoperability</strong>: Devices from different manufacturers can’t verify each other</li>
  <li><strong>Lifecycle Management</strong>: Difficult to manage device identity over time</li>
</ul>
<h2 id="value-proposition">
  
  
    <a href="#value-proposition" class="anchor-heading" aria-labelledby="value-proposition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Value Proposition
  
  
</h2>
    
<h3 id="problems-solved">
  
  
    <a href="#problems-solved" class="anchor-heading" aria-labelledby="problems-solved"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Problems Solved
  
  
</h3>
    

<ol>
  <li><strong>Device Authentication</strong>: Cryptographic proof of device identity</li>
  <li><strong>Trust</strong>: Verify device authenticity and capabilities</li>
  <li><strong>Security</strong>: Prevent unauthorized device access</li>
  <li><strong>Interoperability</strong>: Standard format works across manufacturers</li>
  <li><strong>Scalability</strong>: Decentralized identity scales to millions of devices</li>
  <li><strong>Lifecycle Management</strong>: Manage device identity throughout lifecycle</li>
  <li><strong>Network Authorization</strong>: Control which devices can join networks</li>
</ol>
<h3 id="business-benefits">
  
  
    <a href="#business-benefits" class="anchor-heading" aria-labelledby="business-benefits"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Business Benefits
  
  
</h3>
    

<p><strong>For Device Manufacturers</strong>:</p>
<ul>
  <li><strong>Brand Protection</strong>: Prevent device counterfeiting</li>
  <li><strong>Security</strong>: Reduce security vulnerabilities</li>
  <li><strong>Compliance</strong>: Meet regulatory requirements</li>
  <li><strong>Customer Trust</strong>: Build trust through verifiable identity</li>
</ul>

<p><strong>For Network Operators</strong>:</p>
<ul>
  <li><strong>Security</strong>: Prevent unauthorized devices</li>
  <li><strong>Management</strong>: Efficient device management</li>
  <li><strong>Compliance</strong>: Meet security requirements</li>
  <li><strong>Scalability</strong>: Handle millions of devices</li>
</ul>

<p><strong>For End Users</strong>:</p>
<ul>
  <li><strong>Security</strong>: Trusted device connections</li>
  <li><strong>Privacy</strong>: Control device data sharing</li>
  <li><strong>Convenience</strong>: Seamless device integration</li>
  <li><strong>Transparency</strong>: See device capabilities and status</li>
</ul>
<h3 id="roi-considerations">
  
  
    <a href="#roi-considerations" class="anchor-heading" aria-labelledby="roi-considerations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ROI Considerations
  
  
</h3>
    

<ul>
  <li><strong>Security</strong>: Prevents costly security breaches</li>
  <li><strong>Management</strong>: Reduces device management costs by 40%</li>
  <li><strong>Compliance</strong>: Automated compliance reduces costs</li>
  <li><strong>Interoperability</strong>: Enables new revenue streams</li>
  <li><strong>Customer Trust</strong>: Increases device adoption</li>
</ul>
<h2 id="understanding-the-problem">
  
  
    <a href="#understanding-the-problem" class="anchor-heading" aria-labelledby="understanding-the-problem"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Understanding the Problem
  
  
</h2>
    

<p>IoT device identity management faces several critical challenges:</p>

<ol>
  <li><strong>Device Authentication</strong>: How to verify device identity</li>
  <li><strong>Capability Verification</strong>: How to verify device capabilities</li>
  <li><strong>Network Authorization</strong>: How to control network access</li>
  <li><strong>Device Lifecycle</strong>: How to manage identity over time</li>
  <li><strong>Interoperability</strong>: How devices from different manufacturers work together</li>
  <li><strong>Security</strong>: How to prevent unauthorized access</li>
  <li><strong>Scalability</strong>: How to handle millions of devices</li>
</ol>
<h3 id="real-world-pain-points">
  
  
    <a href="#real-world-pain-points" class="anchor-heading" aria-labelledby="real-world-pain-points"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Real-World Pain Points
  
  
</h3>
    

<p><strong>Example 1: Smart Home Security</strong></p>
<ul>
  <li>Current: Weak authentication, no device verification</li>
  <li>Problem: Vulnerable to attacks, unauthorized access</li>
  <li>Solution: Verifiable device identity with cryptographic proof</li>
</ul>

<p><strong>Example 2: Industrial IoT</strong></p>
<ul>
  <li>Current: No way to verify device authenticity</li>
  <li>Problem: Counterfeit devices, security risks</li>
  <li>Solution: Device attestation credentials</li>
</ul>

<p><strong>Example 3: Vehicle-to-Vehicle Communication</strong></p>
<ul>
  <li>Current: No device identity verification</li>
  <li>Problem: Security risks, trust issues</li>
  <li>Solution: Verifiable vehicle device identity</li>
</ul>
<h2 id="how-it-works-iot-device-identity-flow">
  
  
    <a href="#how-it-works-iot-device-identity-flow" class="anchor-heading" aria-labelledby="how-it-works-iot-device-identity-flow"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How It Works: IoT Device Identity Flow
  
  
</h2>
    

<pre><code class="language-mermaid">flowchart TD
    A["Device Manufacturer&lt;br/&gt;Creates Device DID&lt;br/&gt;Issues Device Attestation&lt;br/&gt;Certifies Device Capabilities"] --&gt;|issues credentials| B["Device Credentials&lt;br/&gt;Device Attestation&lt;br/&gt;Capability Credentials&lt;br/&gt;Network Authorization&lt;br/&gt;Proof cryptographic"]
    B --&gt;|device uses credentials| C["IoT Device&lt;br/&gt;Stores Credentials&lt;br/&gt;Authenticates to Network&lt;br/&gt;Communicates with Other Devices"]
    C --&gt;|verifies before allowing| D["Network Gateway&lt;br/&gt;Verifies Device Identity&lt;br/&gt;Checks Authorization&lt;br/&gt;Grants Network Access"]
    
    style A fill:#1976d2,stroke:#0d47a1,stroke-width:2px,color:#fff
    style B fill:#f57c00,stroke:#e65100,stroke-width:2px,color:#fff
    style C fill:#388e3c,stroke:#1b5e20,stroke-width:2px,color:#fff
    style D fill:#c2185b,stroke:#880e4f,stroke-width:2px,color:#fff
</code></pre>
<h2 id="key-concepts">
  
  
    <a href="#key-concepts" class="anchor-heading" aria-labelledby="key-concepts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Key Concepts
  
  
</h2>
    
<h3 id="device-identity-types">
  
  
    <a href="#device-identity-types" class="anchor-heading" aria-labelledby="device-identity-types"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Device Identity Types
  
  
</h3>
    

<ol>
  <li><strong>Device Attestation Credential</strong>: Proves device authenticity from manufacturer</li>
  <li><strong>Capability Credential</strong>: Describes device capabilities and features</li>
  <li><strong>Network Authorization Credential</strong>: Grants network access permissions</li>
  <li><strong>Secure Boot Credential</strong>: Proves device booted securely</li>
  <li><strong>Lifecycle Credential</strong>: Tracks device status and updates</li>
</ol>
<h3 id="device-capabilities">
  
  
    <a href="#device-capabilities" class="anchor-heading" aria-labelledby="device-capabilities"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Device Capabilities
  
  
</h3>
    

<ul>
  <li><strong>Sensors</strong>: What sensors the device has</li>
  <li><strong>Actuators</strong>: What actuators the device controls</li>
  <li><strong>Communication</strong>: Communication protocols supported</li>
  <li><strong>Processing</strong>: Processing capabilities</li>
  <li><strong>Storage</strong>: Storage capacity</li>
</ul>
<h3 id="network-authorization">
  
  
    <a href="#network-authorization" class="anchor-heading" aria-labelledby="network-authorization"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Network Authorization
  
  
</h3>
    

<ul>
  <li><strong>Network Access</strong>: Which networks device can join</li>
  <li><strong>Resource Access</strong>: What resources device can access</li>
  <li><strong>Communication</strong>: Which devices device can communicate with</li>
  <li><strong>Time Restrictions</strong>: When device can access network</li>
</ul>
<h2 id="prerequisites">
  
  
    <a href="#prerequisites" class="anchor-heading" aria-labelledby="prerequisites"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prerequisites
  
  
</h2>
    

<ul>
  <li>Java 21+</li>
  <li>Kotlin 2.2.0+</li>
  <li>Gradle 8.5+</li>
  <li>Basic understanding of Kotlin and coroutines</li>
  <li>Familiarity with IoT concepts (helpful but not required)</li>
</ul>
<h2 id="step-1-add-dependencies">
  
  
    <a href="#step-1-add-dependencies" class="anchor-heading" aria-labelledby="step-1-add-dependencies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 1: Add Dependencies
  
  
</h2>
    

<p>Add TrustWeave dependencies to your <code class="language-plaintext highlighter-rouge">build.gradle.kts</code>. These provide DID/credential APIs plus the in-memory services used for the IoT identity walkthrough.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre></td><td class="rouge-code"><pre><span class="nf">dependencies</span> <span class="p">{</span>
    <span class="c1">// Core TrustWeave modules</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"com.trustweave:trustweave-core:1.0.0-SNAPSHOT"</span><span class="p">)</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"com.trustweave:trustweave-json:1.0.0-SNAPSHOT"</span><span class="p">)</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"com.trustweave:trustweave-kms:1.0.0-SNAPSHOT"</span><span class="p">)</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"com.trustweave:trustweave-did:1.0.0-SNAPSHOT"</span><span class="p">)</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"com.trustweave:trustweave-anchor:1.0.0-SNAPSHOT"</span><span class="p">)</span>
    
    <span class="c1">// Test kit for in-memory implementations</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"com.trustweave:trustweave-testkit:1.0.0-SNAPSHOT"</span><span class="p">)</span>
    
    <span class="c1">// Kotlinx Serialization</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"org.jetbrains.kotlinx:kotlinx-serialization-json:1.6.0"</span><span class="p">)</span>
    
    <span class="c1">// Coroutines</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3"</span><span class="p">)</span>
<span class="p">}</span>

<span class="p">**</span><span class="nc">Result</span><span class="p">:**</span> <span class="nc">Once</span> <span class="n">dependencies</span> <span class="n">sync</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">run</span> <span class="n">each</span> <span class="nc">IoT</span> <span class="n">sample</span> <span class="n">without</span> <span class="n">additional</span> <span class="n">setup</span><span class="p">.</span>

<span class="err">##</span> <span class="nc">Step</span> <span class="mi">2</span><span class="p">:</span> <span class="nc">Setup</span> <span class="n">and</span> <span class="nc">Create</span> <span class="nc">Device</span> <span class="nc">Identity</span>

<span class="p">**</span><span class="nc">Purpose</span><span class="p">**:</span> <span class="nc">Initialize</span> <span class="n">the</span> <span class="nc">IoT</span> <span class="n">device</span> <span class="n">identity</span> <span class="n">system</span> <span class="n">and</span> <span class="n">create</span> <span class="n">the</span> <span class="n">foundational</span> <span class="n">device</span> <span class="nc">DID</span><span class="p">.</span>

<span class="p">**</span><span class="nc">Why</span> <span class="nc">This</span> <span class="nc">Matters</span><span class="p">**:</span> <span class="nc">Every</span> <span class="nc">IoT</span> <span class="n">device</span> <span class="n">needs</span> <span class="n">a</span> <span class="n">unique</span><span class="p">,</span> <span class="n">verifiable</span> <span class="n">identity</span><span class="p">.</span> <span class="nc">The</span> <span class="nc">DID</span> <span class="n">provides</span> <span class="n">a</span> <span class="n">decentralized</span> <span class="n">identifier</span> <span class="n">that</span> <span class="n">persists</span> <span class="n">throughout</span> <span class="n">the</span> <span class="n">device</span><span class="err">'</span><span class="n">s</span> <span class="n">lifecycle</span><span class="p">,</span> <span class="n">independent</span> <span class="n">of</span> <span class="n">any</span> <span class="n">network</span> <span class="n">or</span> <span class="n">manufacturer</span> <span class="n">changes</span><span class="p">.</span>

<span class="p">**</span><span class="nc">Rationale</span><span class="p">**:</span> <span class="nc">Using</span> <span class="nc">DIDs</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">traditional</span> <span class="n">device</span> <span class="nc">IDs</span> <span class="n">provides</span><span class="p">:</span>
<span class="p">-</span> <span class="p">**</span><span class="nc">Persistence</span><span class="p">**:</span> <span class="nc">Identity</span> <span class="n">doesn</span><span class="err">'</span><span class="n">t</span> <span class="n">change</span> <span class="k">when</span> <span class="n">manufacturer</span> <span class="n">changes</span>
<span class="p">-</span> <span class="p">**</span><span class="nc">Verifiability</span><span class="p">**:</span> <span class="nc">Cryptographic</span> <span class="n">proof</span> <span class="n">of</span> <span class="n">identity</span>
<span class="p">-</span> <span class="p">**</span><span class="nc">Decentralization</span><span class="p">**:</span> <span class="nc">No</span> <span class="n">central</span> <span class="n">registry</span> <span class="n">required</span>
<span class="p">-</span> <span class="p">**</span><span class="nc">Interoperability</span><span class="p">**:</span> <span class="nc">Works</span> <span class="n">across</span> <span class="n">different</span> <span class="n">systems</span>

<span class="err">``</span><span class="n">`kotlin</span>
<span class="k">import</span> <span class="nn">com.trustweave.testkit.did.DidKeyMockMethod</span>
<span class="k">import</span> <span class="nn">com.trustweave.testkit.kms.InMemoryKeyManagementService</span>
<span class="k">import</span> <span class="nn">com.trustweave.did.DidMethodRegistry</span>
<span class="k">import</span> <span class="nn">kotlinx.coroutines.runBlocking</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">=</span> <span class="nf">runBlocking</span> <span class="p">{</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"=== IoT &amp; Device Identity Scenario ===\n"</span><span class="p">)</span>
    
    <span class="c1">// Step 1: Setup services</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Step 1: Setting up services..."</span><span class="p">)</span>
    
    <span class="c1">// Separate KMS for manufacturer ensures manufacturer has independent keys</span>
    <span class="c1">// This is critical for security - manufacturer keys must be isolated</span>
    <span class="kd">val</span> <span class="py">manufacturerKms</span> <span class="p">=</span> <span class="nc">InMemoryKeyManagementService</span><span class="p">()</span>
    
    <span class="c1">// Device KMS represents the device's own key management</span>
    <span class="c1">// In production, this would be a hardware security module (HSM) or secure element</span>
    <span class="kd">val</span> <span class="py">deviceKms</span> <span class="p">=</span> <span class="nc">InMemoryKeyManagementService</span><span class="p">()</span>
    
    <span class="c1">// Network gateway KMS for network authorization</span>
    <span class="kd">val</span> <span class="py">gatewayKms</span> <span class="p">=</span> <span class="nc">InMemoryKeyManagementService</span><span class="p">()</span>
    
    <span class="c1">// Register DID method for creating device identities</span>
    <span class="c1">// In production, use a real DID method like did:key or did:web</span>
    <span class="kd">val</span> <span class="py">didMethod</span> <span class="p">=</span> <span class="nc">DidKeyMockMethod</span><span class="p">(</span><span class="n">manufacturerKms</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">didRegistry</span> <span class="p">=</span> <span class="nc">DidMethodRegistry</span><span class="p">().</span><span class="nf">apply</span> <span class="p">{</span> <span class="nf">register</span><span class="p">(</span><span class="n">didMethod</span><span class="p">)</span> <span class="p">}</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"Services initialized"</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-3-create-manufacturer-and-device-dids">
  
  
    <a href="#step-3-create-manufacturer-and-device-dids" class="anchor-heading" aria-labelledby="step-3-create-manufacturer-and-device-dids"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 3: Create Manufacturer and Device DIDs
  
  
</h2>
    

<p><strong>Purpose</strong>: Establish verifiable identities for the device manufacturer and the IoT device itself.</p>

<p><strong>Why This Matters</strong>: The manufacturer DID serves as a trust anchor - it proves the device came from a legitimate manufacturer. The device DID provides the device’s persistent identity that will be used throughout its lifecycle.</p>

<p><strong>Rationale</strong>:</p>
<ul>
  <li><strong>Manufacturer DID</strong>: Acts as trust anchor for device attestation</li>
  <li><strong>Device DID</strong>: Provides persistent device identity</li>
  <li><strong>Separation</strong>: Separate DIDs ensure proper identity isolation</li>
</ul>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>    <span class="c1">// Step 2: Create manufacturer DID</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\nStep 2: Creating manufacturer DID..."</span><span class="p">)</span>
    
    <span class="c1">// Manufacturer DID serves as trust anchor</span>
    <span class="c1">// All device attestation credentials will be issued by this DID</span>
    <span class="c1">// This proves devices are from legitimate manufacturer</span>
    <span class="kd">val</span> <span class="py">manufacturerDid</span> <span class="p">=</span> <span class="n">didMethod</span><span class="p">.</span><span class="nf">createDid</span><span class="p">()</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Manufacturer DID: ${manufacturerDid.id}"</span><span class="p">)</span>
    
    <span class="c1">// Step 3: Create device DID</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\nStep 3: Creating device DID..."</span><span class="p">)</span>
    
    <span class="c1">// Device DID provides persistent identity for the IoT device</span>
    <span class="c1">// This DID will be used throughout device lifecycle</span>
    <span class="c1">// Even if device changes networks or owners, DID persists</span>
    <span class="kd">val</span> <span class="py">deviceDid</span> <span class="p">=</span> <span class="n">didMethod</span><span class="p">.</span><span class="nf">createDid</span><span class="p">()</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Device DID: ${deviceDid.id}"</span><span class="p">)</span>
    
    <span class="c1">// Step 4: Create network gateway DID</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\nStep 4: Creating network gateway DID..."</span><span class="p">)</span>
    
    <span class="c1">// Gateway DID represents the network gateway that controls access</span>
    <span class="c1">// This DID will issue network authorization credentials</span>
    <span class="kd">val</span> <span class="py">gatewayDid</span> <span class="p">=</span> <span class="n">didMethod</span><span class="p">.</span><span class="nf">createDid</span><span class="p">()</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Gateway DID: ${gatewayDid.id}"</span><span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-4-create-device-attestation-credential">
  
  
    <a href="#step-4-create-device-attestation-credential" class="anchor-heading" aria-labelledby="step-4-create-device-attestation-credential"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 4: Create Device Attestation Credential
  
  
</h2>
    

<p><strong>Purpose</strong>: Issue a credential that proves the device is authentic and came from the manufacturer.</p>

<p><strong>Why This Matters</strong>: Device attestation prevents counterfeiting and ensures devices are genuine. This is critical for security - you only want legitimate devices on your network.</p>

<p><strong>Rationale</strong>: The attestation credential includes:</p>
<ul>
  <li><strong>Device Information</strong>: Model, serial number, manufacturing date</li>
  <li><strong>Manufacturer Proof</strong>: Cryptographic signature from manufacturer</li>
  <li><strong>Device Capabilities</strong>: What the device can do</li>
  <li><strong>Security Features</strong>: Security capabilities of the device</li>
</ul>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="nn">com.trustweave.credential.models.VerifiableCredential</span>
<span class="k">import</span> <span class="nn">com.trustweave.credential.CredentialIssuanceOptions</span>
<span class="k">import</span> <span class="nn">com.trustweave.credential.issuer.CredentialIssuer</span>
<span class="k">import</span> <span class="nn">com.trustweave.credential.proof.Ed25519ProofGenerator</span>
<span class="k">import</span> <span class="nn">com.trustweave.credential.proof.ProofGeneratorRegistry</span>
<span class="k">import</span> <span class="nn">kotlinx.serialization.json.buildJsonObject</span>
<span class="k">import</span> <span class="nn">kotlinx.serialization.json.put</span>
<span class="k">import</span> <span class="nn">java.time.Instant</span>

    <span class="c1">// Step 5: Create device attestation credential</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\nStep 5: Creating device attestation credential..."</span><span class="p">)</span>
    
    <span class="c1">// Device attestation proves device is authentic and from manufacturer</span>
    <span class="c1">// This credential will be used to verify device authenticity throughout its lifecycle</span>
    <span class="kd">val</span> <span class="py">deviceAttestation</span> <span class="p">=</span> <span class="nc">VerifiableCredential</span><span class="p">(</span>
        <span class="n">id</span> <span class="p">=</span> <span class="s">"https://manufacturer.example.com/devices/${deviceDid.id.substringAfterLast("</span><span class="p">:</span><span class="s">")}/attestation"</span><span class="p">,</span>
        <span class="n">type</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"DeviceAttestationCredential"</span><span class="p">,</span> <span class="s">"IoTCredential"</span><span class="p">),</span>
        <span class="n">issuer</span> <span class="p">=</span> <span class="n">manufacturerDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">deviceDid</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"device"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"model"</span><span class="p">,</span> <span class="s">"SmartSensor Pro"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"serialNumber"</span><span class="p">,</span> <span class="s">"SSP-2024-001234"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"manufacturingDate"</span><span class="p">,</span> <span class="s">"2024-01-15"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"manufacturerDid"</span><span class="p">,</span> <span class="n">manufacturerDid</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"firmwareVersion"</span><span class="p">,</span> <span class="s">"2.1.0"</span><span class="p">)</span>
            <span class="p">})</span>
        <span class="p">},</span>
        <span class="n">issuanceDate</span> <span class="p">=</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">(),</span>
        <span class="n">expirationDate</span> <span class="p">=</span> <span class="k">null</span><span class="p">,</span> <span class="c1">// Device attestation doesn't expire</span>
        <span class="n">credentialSchema</span> <span class="p">=</span> <span class="n">com</span><span class="p">.</span><span class="n">trustweave</span><span class="p">.</span><span class="n">credential</span><span class="p">.</span><span class="n">models</span><span class="p">.</span><span class="nc">CredentialSchema</span><span class="p">(</span>
            <span class="n">id</span> <span class="p">=</span> <span class="s">"https://example.com/schemas/device-attestation.json"</span><span class="p">,</span>
            <span class="n">type</span> <span class="p">=</span> <span class="s">"JsonSchemaValidator2018"</span><span class="p">,</span>
            <span class="n">schemaFormat</span> <span class="p">=</span> <span class="n">com</span><span class="p">.</span><span class="n">trustweave</span><span class="p">.</span><span class="n">spi</span><span class="p">.</span><span class="nc">SchemaFormat</span><span class="p">.</span><span class="nc">JSON_SCHEMA</span>
        <span class="p">)</span>
    <span class="p">)</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"Device attestation credential created:"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"  - Model: SmartSensor Pro"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"  - Serial: SSP-2024-001234"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"  - Manufacturer: ${manufacturerDid.id}"</span><span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-5-issue-attestation-credential-with-proof">
  
  
    <a href="#step-5-issue-attestation-credential-with-proof" class="anchor-heading" aria-labelledby="step-5-issue-attestation-credential-with-proof"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 5: Issue Attestation Credential with Proof
  
  
</h2>
    

<p><strong>Purpose</strong>: Cryptographically sign the device attestation credential to make it verifiable.</p>

<p><strong>Why This Matters</strong>: The cryptographic proof ensures the credential cannot be tampered with and proves it came from the manufacturer. This is the foundation of device trust.</p>

<p><strong>Rationale</strong>:</p>
<ul>
  <li><strong>Key Generation</strong>: Generate manufacturer’s signing key</li>
  <li><strong>Proof Generator</strong>: Create proof generator that uses manufacturer’s KMS</li>
  <li><strong>Credential Issuance</strong>: Sign credential with manufacturer’s key</li>
  <li><strong>Verification</strong>: Anyone can verify the credential came from manufacturer</li>
</ul>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre></td><td class="rouge-code"><pre>    <span class="c1">// Step 6: Issue device attestation credential</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\nStep 6: Issuing device attestation credential..."</span><span class="p">)</span>
    
    <span class="c1">// Generate manufacturer's signing key</span>
    <span class="c1">// In production, this key would be stored in a hardware security module (HSM)</span>
    <span class="c1">// The key must be kept secure - if compromised, all device attestations are at risk</span>
    <span class="kd">val</span> <span class="py">manufacturerKey</span> <span class="p">=</span> <span class="n">manufacturerKms</span><span class="p">.</span><span class="nf">generateKey</span><span class="p">(</span><span class="s">"Ed25519"</span><span class="p">)</span>
    
    <span class="c1">// Create proof generator that uses manufacturer's KMS for signing</span>
    <span class="c1">// Ed25519 is chosen for its security and efficiency</span>
    <span class="c1">// The signer function wraps the KMS sign operation</span>
    <span class="kd">val</span> <span class="py">manufacturerProofGenerator</span> <span class="p">=</span> <span class="nc">Ed25519ProofGenerator</span><span class="p">(</span>
        <span class="n">signer</span> <span class="p">=</span> <span class="p">{</span> <span class="n">data</span><span class="p">,</span> <span class="n">keyId</span> <span class="p">-&gt;</span> 
            <span class="c1">// Sign the credential data with manufacturer's key</span>
            <span class="c1">// This creates cryptographic proof that manufacturer issued this credential</span>
            <span class="n">manufacturerKms</span><span class="p">.</span><span class="nf">sign</span><span class="p">(</span><span class="n">keyId</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> 
        <span class="p">},</span>
        <span class="n">getPublicKeyId</span> <span class="p">=</span> <span class="p">{</span> <span class="n">keyId</span> <span class="p">-&gt;</span> <span class="n">manufacturerKey</span><span class="p">.</span><span class="n">id</span> <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="c1">// Register proof generator in a local registry</span>
    <span class="kd">val</span> <span class="py">manufacturerProofRegistry</span> <span class="p">=</span> <span class="nc">ProofGeneratorRegistry</span><span class="p">().</span><span class="nf">apply</span> <span class="p">{</span>
        <span class="nf">register</span><span class="p">(</span><span class="n">manufacturerProofGenerator</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// Create credential issuer that uses the proof generator</span>
    <span class="c1">// The resolveDid function checks if DIDs are valid (simplified for example)</span>
    <span class="kd">val</span> <span class="py">manufacturerIssuer</span> <span class="p">=</span> <span class="nc">CredentialIssuer</span><span class="p">(</span>
        <span class="n">proofGenerator</span> <span class="p">=</span> <span class="n">manufacturerProofGenerator</span><span class="p">,</span>
        <span class="n">resolveDid</span> <span class="p">=</span> <span class="p">{</span> <span class="n">did</span> <span class="p">-&gt;</span> <span class="n">didRegistry</span><span class="p">.</span><span class="nf">resolve</span><span class="p">(</span><span class="n">did</span><span class="p">)</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">},</span>
        <span class="n">proofRegistry</span> <span class="p">=</span> <span class="n">manufacturerProofRegistry</span>
    <span class="p">)</span>
    
    <span class="c1">// Issue the credential with cryptographic proof</span>
    <span class="c1">// The proof is attached to the credential and can be verified by anyone</span>
    <span class="kd">val</span> <span class="py">issuedAttestation</span> <span class="p">=</span> <span class="n">manufacturerIssuer</span><span class="p">.</span><span class="nf">issue</span><span class="p">(</span>
        <span class="n">credential</span> <span class="p">=</span> <span class="n">deviceAttestation</span><span class="p">,</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">manufacturerDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">keyId</span> <span class="p">=</span> <span class="n">manufacturerKey</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">options</span> <span class="p">=</span> <span class="nc">CredentialIssuanceOptions</span><span class="p">(</span><span class="n">proofType</span> <span class="p">=</span> <span class="s">"Ed25519Signature2020"</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"Device attestation credential issued:"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"  - Has proof: ${issuedAttestation.proof != null}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"  - Proof type: ${issuedAttestation.proof?.type}"</span><span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-6-create-device-capability-credential">
  
  
    <a href="#step-6-create-device-capability-credential" class="anchor-heading" aria-labelledby="step-6-create-device-capability-credential"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 6: Create Device Capability Credential
  
  
</h2>
    

<p><strong>Purpose</strong>: Issue a credential that describes what the device can do (sensors, actuators, communication protocols).</p>

<p><strong>Why This Matters</strong>: Capability credentials enable other devices and systems to understand what a device can do without direct communication. This enables automated device discovery and integration.</p>

<p><strong>Rationale</strong>:</p>
<ul>
  <li><strong>Sensors</strong>: Lists what sensors the device has (temperature, humidity, etc.)</li>
  <li><strong>Actuators</strong>: Lists what the device can control</li>
  <li><strong>Communication</strong>: Lists supported protocols (WiFi, Bluetooth, Zigbee)</li>
  <li><strong>Processing</strong>: Describes processing capabilities</li>
  <li><strong>Security</strong>: Lists security features</li>
</ul>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre></td><td class="rouge-code"><pre>    <span class="c1">// Step 7: Create device capability credential</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\nStep 7: Creating device capability credential..."</span><span class="p">)</span>
    
    <span class="c1">// Capability credential describes what the device can do</span>
    <span class="c1">// This enables other systems to understand device capabilities</span>
    <span class="c1">// Without this, systems would need to query device directly</span>
    <span class="kd">val</span> <span class="py">capabilityCredential</span> <span class="p">=</span> <span class="nc">VerifiableCredential</span><span class="p">(</span>
        <span class="n">id</span> <span class="p">=</span> <span class="s">"https://manufacturer.example.com/devices/${deviceDid.id.substringAfterLast("</span><span class="p">:</span><span class="s">")}/capabilities"</span><span class="p">,</span>
        <span class="n">type</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"DeviceCapabilityCredential"</span><span class="p">,</span> <span class="s">"IoTCredential"</span><span class="p">),</span>
        <span class="n">issuer</span> <span class="p">=</span> <span class="n">manufacturerDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">deviceDid</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"capabilities"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="c1">// Sensors: What the device can sense</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"sensors"</span><span class="p">,</span> <span class="nf">listOf</span><span class="p">(</span>
                    <span class="s">"temperature"</span><span class="p">,</span>
                    <span class="s">"humidity"</span><span class="p">,</span>
                    <span class="s">"motion"</span><span class="p">,</span>
                    <span class="s">"light"</span>
                <span class="p">))</span>
                
                <span class="c1">// Actuators: What the device can control</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"actuators"</span><span class="p">,</span> <span class="nf">listOf</span><span class="p">(</span>
                    <span class="s">"led"</span><span class="p">,</span>
                    <span class="s">"buzzer"</span>
                <span class="p">))</span>
                
                <span class="c1">// Communication protocols the device supports</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"communication"</span><span class="p">,</span> <span class="nf">listOf</span><span class="p">(</span>
                    <span class="s">"WiFi"</span><span class="p">,</span>
                    <span class="s">"Bluetooth"</span><span class="p">,</span>
                    <span class="s">"Zigbee"</span>
                <span class="p">))</span>
                
                <span class="c1">// Processing capabilities</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"processing"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"cpu"</span><span class="p">,</span> <span class="s">"ARM Cortex-M4"</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"ram"</span><span class="p">,</span> <span class="s">"256KB"</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"storage"</span><span class="p">,</span> <span class="s">"1MB"</span><span class="p">)</span>
                <span class="p">})</span>
                
                <span class="c1">// Security features</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"security"</span><span class="p">,</span> <span class="nf">listOf</span><span class="p">(</span>
                    <span class="s">"secure-boot"</span><span class="p">,</span>
                    <span class="s">"encryption"</span><span class="p">,</span>
                    <span class="s">"tls-support"</span>
                <span class="p">))</span>
            <span class="p">})</span>
        <span class="p">},</span>
        <span class="n">issuanceDate</span> <span class="p">=</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">(),</span>
        <span class="n">expirationDate</span> <span class="p">=</span> <span class="k">null</span>
    <span class="p">)</span>
    
    <span class="c1">// Issue capability credential</span>
    <span class="kd">val</span> <span class="py">issuedCapability</span> <span class="p">=</span> <span class="n">manufacturerIssuer</span><span class="p">.</span><span class="nf">issue</span><span class="p">(</span>
        <span class="n">credential</span> <span class="p">=</span> <span class="n">capabilityCredential</span><span class="p">,</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">manufacturerDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">keyId</span> <span class="p">=</span> <span class="n">manufacturerKey</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">options</span> <span class="p">=</span> <span class="nc">CredentialIssuanceOptions</span><span class="p">(</span><span class="n">proofType</span> <span class="p">=</span> <span class="s">"Ed25519Signature2020"</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"Device capability credential issued:"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"  - Sensors: temperature, humidity, motion, light"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"  - Communication: WiFi, Bluetooth, Zigbee"</span><span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-7-create-network-authorization-credential">
  
  
    <a href="#step-7-create-network-authorization-credential" class="anchor-heading" aria-labelledby="step-7-create-network-authorization-credential"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 7: Create Network Authorization Credential
  
  
</h2>
    

<p><strong>Purpose</strong>: Issue a credential that grants the device permission to join a specific network.</p>

<p><strong>Why This Matters</strong>: Network authorization prevents unauthorized devices from joining networks. Only devices with valid authorization credentials can access network resources.</p>

<p><strong>Rationale</strong>:</p>
<ul>
  <li><strong>Network Access</strong>: Specifies which network device can join</li>
  <li><strong>Resource Access</strong>: What resources device can access</li>
  <li><strong>Time Restrictions</strong>: When device can access network</li>
  <li><strong>Revocation</strong>: Can be revoked if device is compromised</li>
</ul>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre></td><td class="rouge-code"><pre>    <span class="c1">// Step 8: Create network authorization credential</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\nStep 8: Creating network authorization credential..."</span><span class="p">)</span>
    
    <span class="c1">// Network authorization grants device permission to join network</span>
    <span class="c1">// This is issued by network gateway, not manufacturer</span>
    <span class="c1">// Gateway verifies device attestation before issuing authorization</span>
    <span class="kd">val</span> <span class="py">networkAuthorization</span> <span class="p">=</span> <span class="nc">VerifiableCredential</span><span class="p">(</span>
        <span class="n">id</span> <span class="p">=</span> <span class="s">"https://gateway.example.com/authorizations/${deviceDid.id.substringAfterLast("</span><span class="p">:</span><span class="s">")}"</span><span class="p">,</span>
        <span class="n">type</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"NetworkAuthorizationCredential"</span><span class="p">,</span> <span class="s">"IoTCredential"</span><span class="p">),</span>
        <span class="n">issuer</span> <span class="p">=</span> <span class="n">gatewayDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">deviceDid</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"networkAuthorization"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"networkId"</span><span class="p">,</span> <span class="s">"smart-home-network-001"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"networkName"</span><span class="p">,</span> <span class="s">"Smart Home Network"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"authorizedResources"</span><span class="p">,</span> <span class="nf">listOf</span><span class="p">(</span>
                    <span class="s">"sensor-data"</span><span class="p">,</span>
                    <span class="s">"device-control"</span><span class="p">,</span>
                    <span class="s">"local-communication"</span>
                <span class="p">))</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"timeRestrictions"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"allowedHours"</span><span class="p">,</span> <span class="s">"00:00-23:59"</span><span class="p">)</span> <span class="c1">// 24/7 access</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"timezone"</span><span class="p">,</span> <span class="s">"UTC"</span><span class="p">)</span>
                <span class="p">})</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"authorizationDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
            <span class="p">})</span>
        <span class="p">},</span>
        <span class="n">issuanceDate</span> <span class="p">=</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">(),</span>
        <span class="n">expirationDate</span> <span class="p">=</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">plus</span><span class="p">(</span><span class="mi">365</span><span class="p">,</span> <span class="n">java</span><span class="p">.</span><span class="n">time</span><span class="p">.</span><span class="n">temporal</span><span class="p">.</span><span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">DAYS</span><span class="p">).</span><span class="nf">toString</span><span class="p">()</span>
    <span class="p">)</span>
    
    <span class="c1">// Issue network authorization</span>
    <span class="kd">val</span> <span class="py">gatewayKey</span> <span class="p">=</span> <span class="n">gatewayKms</span><span class="p">.</span><span class="nf">generateKey</span><span class="p">(</span><span class="s">"Ed25519"</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">gatewayProofGenerator</span> <span class="p">=</span> <span class="nc">Ed25519ProofGenerator</span><span class="p">(</span>
        <span class="n">signer</span> <span class="p">=</span> <span class="p">{</span> <span class="n">data</span><span class="p">,</span> <span class="n">keyId</span> <span class="p">-&gt;</span> <span class="n">gatewayKms</span><span class="p">.</span><span class="nf">sign</span><span class="p">(</span><span class="n">keyId</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="p">},</span>
        <span class="n">getPublicKeyId</span> <span class="p">=</span> <span class="p">{</span> <span class="n">keyId</span> <span class="p">-&gt;</span> <span class="n">gatewayKey</span><span class="p">.</span><span class="n">id</span> <span class="p">}</span>
    <span class="p">)</span>
    <span class="kd">val</span> <span class="py">gatewayProofRegistry</span> <span class="p">=</span> <span class="nc">ProofGeneratorRegistry</span><span class="p">().</span><span class="nf">apply</span> <span class="p">{</span>
        <span class="nf">register</span><span class="p">(</span><span class="n">gatewayProofGenerator</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">val</span> <span class="py">gatewayIssuer</span> <span class="p">=</span> <span class="nc">CredentialIssuer</span><span class="p">(</span>
        <span class="n">proofGenerator</span> <span class="p">=</span> <span class="n">gatewayProofGenerator</span><span class="p">,</span>
        <span class="n">resolveDid</span> <span class="p">=</span> <span class="p">{</span> <span class="n">did</span> <span class="p">-&gt;</span> <span class="n">didRegistry</span><span class="p">.</span><span class="nf">resolve</span><span class="p">(</span><span class="n">did</span><span class="p">)</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">},</span>
        <span class="n">proofRegistry</span> <span class="p">=</span> <span class="n">gatewayProofRegistry</span>
    <span class="p">)</span>
    
    <span class="kd">val</span> <span class="py">issuedNetworkAuth</span> <span class="p">=</span> <span class="n">gatewayIssuer</span><span class="p">.</span><span class="nf">issue</span><span class="p">(</span>
        <span class="n">credential</span> <span class="p">=</span> <span class="n">networkAuthorization</span><span class="p">,</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">gatewayDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">keyId</span> <span class="p">=</span> <span class="n">gatewayKey</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">options</span> <span class="p">=</span> <span class="nc">CredentialIssuanceOptions</span><span class="p">(</span><span class="n">proofType</span> <span class="p">=</span> <span class="s">"Ed25519Signature2020"</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"Network authorization credential issued:"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"  - Network: Smart Home Network"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"  - Authorized resources: sensor-data, device-control"</span><span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-8-verify-device-before-network-access">
  
  
    <a href="#step-8-verify-device-before-network-access" class="anchor-heading" aria-labelledby="step-8-verify-device-before-network-access"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 8: Verify Device Before Network Access
  
  
</h2>
    

<p><strong>Purpose</strong>: Verify device identity and authorization before allowing network access.</p>

<p><strong>Why This Matters</strong>: This is the critical security checkpoint. The gateway must verify:</p>
<ol>
  <li>Device is authentic (attestation valid)</li>
  <li>Device has network authorization</li>
  <li>Credentials haven’t expired or been revoked</li>
</ol>

<p><strong>Rationale</strong>:</p>
<ul>
  <li><strong>Attestation Verification</strong>: Ensures device is from legitimate manufacturer</li>
  <li><strong>Authorization Verification</strong>: Ensures device has permission to join network</li>
  <li><strong>Expiration Check</strong>: Ensures credentials are still valid</li>
  <li><strong>Revocation Check</strong>: Ensures credentials haven’t been revoked</li>
</ul>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="nn">com.trustweave.credential.verifier.CredentialVerifier</span>
<span class="k">import</span> <span class="nn">com.trustweave.credential.CredentialVerificationOptions</span>

    <span class="c1">// Step 9: Verify device before network access</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\nStep 9: Verifying device before network access..."</span><span class="p">)</span>
    
    <span class="c1">// Create verifier to check device credentials</span>
    <span class="c1">// This verifier will check cryptographic proofs and credential validity</span>
    <span class="kd">val</span> <span class="py">verifier</span> <span class="p">=</span> <span class="nc">CredentialVerifier</span><span class="p">(</span>
        <span class="n">didResolver</span> <span class="p">=</span> <span class="nc">CredentialDidResolver</span> <span class="p">{</span> <span class="n">did</span> <span class="p">-&gt;</span>
            <span class="n">didRegistry</span><span class="p">.</span><span class="nf">resolve</span><span class="p">(</span><span class="n">did</span><span class="p">).</span><span class="nf">toCredentialDidResolution</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="c1">// First, verify device attestation</span>
    <span class="c1">// This proves device is authentic and from legitimate manufacturer</span>
    <span class="kd">val</span> <span class="py">attestationVerification</span> <span class="p">=</span> <span class="n">verifier</span><span class="p">.</span><span class="nf">verify</span><span class="p">(</span>
        <span class="n">credential</span> <span class="p">=</span> <span class="n">issuedAttestation</span><span class="p">,</span>
        <span class="n">options</span> <span class="p">=</span> <span class="nc">CredentialVerificationOptions</span><span class="p">(</span>
            <span class="n">checkRevocation</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
            <span class="n">checkExpiration</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span> <span class="c1">// Attestation doesn't expire</span>
            <span class="n">validateSchema</span> <span class="p">=</span> <span class="k">true</span>
        <span class="p">)</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="p">(!</span><span class="n">attestationVerification</span><span class="p">.</span><span class="n">valid</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Device attestation verification failed:"</span><span class="p">)</span>
        <span class="n">attestationVerification</span><span class="p">.</span><span class="n">errors</span><span class="p">.</span><span class="nf">forEach</span> <span class="p">{</span> <span class="nf">println</span><span class="p">(</span><span class="s">"  - $it"</span><span class="p">)</span> <span class="p">}</span>
        <span class="k">return</span><span class="nd">@runBlocking</span>
    <span class="p">}</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Device attestation verified"</span><span class="p">)</span>
    
    <span class="c1">// Second, verify network authorization</span>
    <span class="c1">// This proves device has permission to join network</span>
    <span class="kd">val</span> <span class="py">authorizationVerification</span> <span class="p">=</span> <span class="n">verifier</span><span class="p">.</span><span class="nf">verify</span><span class="p">(</span>
        <span class="n">credential</span> <span class="p">=</span> <span class="n">issuedNetworkAuth</span><span class="p">,</span>
        <span class="n">options</span> <span class="p">=</span> <span class="nc">CredentialVerificationOptions</span><span class="p">(</span>
            <span class="n">checkRevocation</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
            <span class="n">checkExpiration</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
            <span class="n">validateSchema</span> <span class="p">=</span> <span class="k">true</span>
        <span class="p">)</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="p">(!</span><span class="n">authorizationVerification</span><span class="p">.</span><span class="n">valid</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Network authorization verification failed:"</span><span class="p">)</span>
        <span class="n">authorizationVerification</span><span class="p">.</span><span class="n">errors</span><span class="p">.</span><span class="nf">forEach</span> <span class="p">{</span> <span class="nf">println</span><span class="p">(</span><span class="s">"  - $it"</span><span class="p">)</span> <span class="p">}</span>
        <span class="k">return</span><span class="nd">@runBlocking</span>
    <span class="p">}</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Network authorization verified"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"  - Device can join network"</span><span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-9-device-to-device-communication">
  
  
    <a href="#step-9-device-to-device-communication" class="anchor-heading" aria-labelledby="step-9-device-to-device-communication"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 9: Device-to-Device Communication
  
  
</h2>
    

<p><strong>Purpose</strong>: Enable secure communication between IoT devices using their DIDs.</p>

<p><strong>Why This Matters</strong>: Devices need to verify each other’s identity before communicating. This prevents man-in-the-middle attacks and ensures devices only communicate with trusted peers.</p>

<p><strong>Rationale</strong>:</p>
<ul>
  <li><strong>Device Authentication</strong>: Each device verifies the other’s identity</li>
  <li><strong>Credential Exchange</strong>: Devices exchange credentials to establish trust</li>
  <li><strong>Secure Communication</strong>: Communication is encrypted using device keys</li>
  <li><strong>Trust Verification</strong>: Devices verify each other’s capabilities</li>
</ul>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre>    <span class="c1">// Step 10: Device-to-device communication</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\nStep 10: Setting up device-to-device communication..."</span><span class="p">)</span>
    
    <span class="c1">// Create second device for communication example</span>
    <span class="kd">val</span> <span class="py">device2Did</span> <span class="p">=</span> <span class="n">didMethod</span><span class="p">.</span><span class="nf">createDid</span><span class="p">()</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Second device DID: ${device2Did.id}"</span><span class="p">)</span>
    
    <span class="c1">// Device 1 wants to communicate with Device 2</span>
    <span class="c1">// First, Device 1 verifies Device 2's attestation</span>
    <span class="c1">// In a real scenario, Device 2 would present its attestation credential</span>
    <span class="kd">val</span> <span class="py">device2Attestation</span> <span class="p">=</span> <span class="nc">VerifiableCredential</span><span class="p">(</span>
        <span class="n">type</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"DeviceAttestationCredential"</span><span class="p">),</span>
        <span class="n">issuer</span> <span class="p">=</span> <span class="n">manufacturerDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">device2Did</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"device"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"model"</span><span class="p">,</span> <span class="s">"SmartActuator Pro"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"serialNumber"</span><span class="p">,</span> <span class="s">"SAP-2024-005678"</span><span class="p">)</span>
            <span class="p">})</span>
        <span class="p">},</span>
        <span class="n">issuanceDate</span> <span class="p">=</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">()</span>
    <span class="p">)</span>
    
    <span class="kd">val</span> <span class="py">issuedDevice2Attestation</span> <span class="p">=</span> <span class="n">manufacturerIssuer</span><span class="p">.</span><span class="nf">issue</span><span class="p">(</span>
        <span class="n">credential</span> <span class="p">=</span> <span class="n">device2Attestation</span><span class="p">,</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">manufacturerDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">keyId</span> <span class="p">=</span> <span class="n">manufacturerKey</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">options</span> <span class="p">=</span> <span class="nc">CredentialIssuanceOptions</span><span class="p">(</span><span class="n">proofType</span> <span class="p">=</span> <span class="s">"Ed25519Signature2020"</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="c1">// Verify Device 2's attestation</span>
    <span class="kd">val</span> <span class="py">device2Verification</span> <span class="p">=</span> <span class="n">verifier</span><span class="p">.</span><span class="nf">verify</span><span class="p">(</span>
        <span class="n">credential</span> <span class="p">=</span> <span class="n">issuedDevice2Attestation</span><span class="p">,</span>
        <span class="n">options</span> <span class="p">=</span> <span class="nc">CredentialVerificationOptions</span><span class="p">(</span><span class="n">checkRevocation</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">device2Verification</span><span class="p">.</span><span class="n">valid</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Device 2 verified - secure communication can proceed"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"  - Device 1 can trust Device 2"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"  - Communication can be encrypted using device keys"</span><span class="p">)</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-10-anchor-device-identity-to-blockchain">
  
  
    <a href="#step-10-anchor-device-identity-to-blockchain" class="anchor-heading" aria-labelledby="step-10-anchor-device-identity-to-blockchain"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 10: Anchor Device Identity to Blockchain
  
  
</h2>
    

<p><strong>Purpose</strong>: Create immutable record of device identity on blockchain.</p>

<p><strong>Why This Matters</strong>: Blockchain anchoring provides:</p>
<ul>
  <li><strong>Immutability</strong>: Cannot be tampered with</li>
  <li><strong>Audit Trail</strong>: Permanent record of device identity</li>
  <li><strong>Trust</strong>: Third parties can verify device identity independently</li>
  <li><strong>Non-Repudiation</strong>: Manufacturer cannot deny device issuance</li>
</ul>

<p><strong>Rationale</strong>:</p>
<ul>
  <li><strong>Device Record</strong>: Create structured record of device identity</li>
  <li><strong>Blockchain Anchoring</strong>: Anchor to blockchain for immutability</li>
  <li><strong>Digest</strong>: Cryptographic hash of device credentials</li>
  <li><strong>Verification</strong>: Anyone can verify device identity from blockchain</li>
</ul>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="nn">com.trustweave.testkit.anchor.InMemoryBlockchainAnchorClient</span>
<span class="k">import</span> <span class="nn">com.trustweave.anchor.BlockchainAnchorRegistry</span>
<span class="k">import</span> <span class="nn">com.trustweave.anchor.anchorTyped</span>
<span class="k">import</span> <span class="nn">kotlinx.serialization.Serializable</span>

<span class="nd">@Serializable</span>
<span class="kd">data class</span> <span class="nc">DeviceIdentityRecord</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">deviceDid</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">manufacturerDid</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">model</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">serialNumber</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">attestationDigest</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">)</span>

    <span class="c1">// Step 11: Anchor device identity to blockchain</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\nStep 11: Anchoring device identity to blockchain..."</span><span class="p">)</span>
    
    <span class="c1">// Setup blockchain client</span>
    <span class="kd">val</span> <span class="py">anchorClient</span> <span class="p">=</span> <span class="nc">InMemoryBlockchainAnchorClient</span><span class="p">(</span><span class="s">"eip155:1"</span><span class="p">,</span> <span class="nf">emptyMap</span><span class="p">())</span>
    <span class="kd">val</span> <span class="py">blockchainRegistry</span> <span class="p">=</span> <span class="nc">BlockchainAnchorRegistry</span><span class="p">().</span><span class="nf">apply</span> <span class="p">{</span>
        <span class="nf">register</span><span class="p">(</span><span class="s">"eip155:1"</span><span class="p">,</span> <span class="n">anchorClient</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// Compute digest of device attestation credential</span>
    <span class="c1">// This digest uniquely identifies the credential</span>
    <span class="kd">val</span> <span class="py">attestationDigest</span> <span class="p">=</span> <span class="n">com</span><span class="p">.</span><span class="n">trustweave</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="nc">DigestUtils</span><span class="p">.</span><span class="nf">sha256DigestMultibase</span><span class="p">(</span>
        <span class="nc">Json</span><span class="p">.</span><span class="nf">encodeToJsonElement</span><span class="p">(</span>
            <span class="n">com</span><span class="p">.</span><span class="n">trustweave</span><span class="p">.</span><span class="n">credential</span><span class="p">.</span><span class="n">models</span><span class="p">.</span><span class="nc">VerifiableCredential</span><span class="p">.</span><span class="nf">serializer</span><span class="p">(),</span>
            <span class="n">issuedAttestation</span>
        <span class="p">)</span>
    <span class="p">)</span>
    
    <span class="c1">// Create device identity record</span>
    <span class="c1">// This record will be permanently stored on blockchain</span>
    <span class="kd">val</span> <span class="py">deviceIdentityRecord</span> <span class="p">=</span> <span class="nc">DeviceIdentityRecord</span><span class="p">(</span>
        <span class="n">deviceDid</span> <span class="p">=</span> <span class="n">deviceDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">manufacturerDid</span> <span class="p">=</span> <span class="n">manufacturerDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">model</span> <span class="p">=</span> <span class="s">"SmartSensor Pro"</span><span class="p">,</span>
        <span class="n">serialNumber</span> <span class="p">=</span> <span class="s">"SSP-2024-001234"</span><span class="p">,</span>
        <span class="n">attestationDigest</span> <span class="p">=</span> <span class="n">attestationDigest</span>
    <span class="p">)</span>
    
    <span class="c1">// Anchor to blockchain</span>
    <span class="c1">// This creates immutable record that cannot be tampered with</span>
    <span class="kd">val</span> <span class="py">anchorResult</span> <span class="p">=</span> <span class="n">blockchainRegistry</span><span class="p">.</span><span class="nf">anchorTyped</span><span class="p">(</span>
        <span class="n">value</span> <span class="p">=</span> <span class="n">deviceIdentityRecord</span><span class="p">,</span>
        <span class="n">serializer</span> <span class="p">=</span> <span class="nc">DeviceIdentityRecord</span><span class="p">.</span><span class="nf">serializer</span><span class="p">(),</span>
        <span class="n">targetChainId</span> <span class="p">=</span> <span class="s">"eip155:137"</span>
    <span class="p">)</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"Device identity anchored to blockchain:"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"  - Transaction hash: ${anchorResult.ref.txHash}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"  - Provides immutable device identity record"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"  - Can be verified by anyone"</span><span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="extensive-step-by-step-breakdown">
  
  
    <a href="#extensive-step-by-step-breakdown" class="anchor-heading" aria-labelledby="extensive-step-by-step-breakdown"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Extensive Step-by-Step Breakdown
  
  
</h2>
    
<h3 id="step-1-setup-and-initialization">
  
  
    <a href="#step-1-setup-and-initialization" class="anchor-heading" aria-labelledby="step-1-setup-and-initialization"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 1: Setup and Initialization
  
  
</h3>
    

<p><strong>Purpose</strong>: Initialize IoT device identity system with proper key management.</p>

<p><strong>Detailed Explanation</strong>:</p>
<ol>
  <li><strong>Multiple KMS Instances</strong>: Separate key management for manufacturer, device, and gateway ensures proper key isolation. This is critical because:
    <ul>
      <li><strong>Manufacturer Keys</strong>: Must be highly secure - if compromised, all device attestations are at risk</li>
      <li><strong>Device Keys</strong>: Stored on device (ideally in HSM or secure element)</li>
      <li><strong>Gateway Keys</strong>: Used for network authorization</li>
    </ul>
  </li>
  <li>
    <p><strong>DID Method Registration</strong>: Register DID method for creating device identities. In production, use real DID methods like <code class="language-plaintext highlighter-rouge">did:key</code> or <code class="language-plaintext highlighter-rouge">did:web</code>.</p>
  </li>
  <li><strong>Why Separation Matters</strong>:
    <ul>
      <li><strong>Security</strong>: If one system is compromised, others remain secure</li>
      <li><strong>Scalability</strong>: Each system can scale independently</li>
      <li><strong>Compliance</strong>: Meets security requirements for key isolation</li>
    </ul>
  </li>
</ol>
<h3 id="step-2-create-manufacturer-did">
  
  
    <a href="#step-2-create-manufacturer-did" class="anchor-heading" aria-labelledby="step-2-create-manufacturer-did"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 2: Create Manufacturer DID
  
  
</h3>
    

<p><strong>Purpose</strong>: Establish manufacturer as trust anchor.</p>

<p><strong>Detailed Explanation</strong>:</p>
<ul>
  <li><strong>Trust Anchor</strong>: Manufacturer DID serves as root of trust</li>
  <li><strong>Credential Issuance</strong>: All device attestation credentials issued by this DID</li>
  <li><strong>Verification</strong>: Anyone can verify device came from this manufacturer</li>
  <li><strong>Persistence</strong>: Manufacturer DID persists even if company changes</li>
</ul>

<p><strong>Why This Matters</strong>: The manufacturer DID is the foundation of device trust. All device attestations reference this DID, so it must be well-known and trusted.</p>
<h3 id="step-3-create-device-did">
  
  
    <a href="#step-3-create-device-did" class="anchor-heading" aria-labelledby="step-3-create-device-did"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 3: Create Device DID
  
  
</h3>
    

<p><strong>Purpose</strong>: Provide persistent identity for IoT device.</p>

<p><strong>Detailed Explanation</strong>:</p>
<ul>
  <li><strong>Persistence</strong>: Device DID doesn’t change throughout device lifecycle</li>
  <li><strong>Independence</strong>: Not tied to any network or manufacturer system</li>
  <li><strong>Verifiability</strong>: Cryptographic proof of device identity</li>
  <li><strong>Portability</strong>: Works across different networks and systems</li>
</ul>

<p><strong>Why This Matters</strong>: Device DIDs enable devices to maintain identity even when:</p>
<ul>
  <li>Changing networks</li>
  <li>Changing owners</li>
  <li>Manufacturer systems change</li>
  <li>Device firmware is updated</li>
</ul>
<h3 id="step-4-create-device-attestation-credential-1">
  
  
    <a href="#step-4-create-device-attestation-credential-1" class="anchor-heading" aria-labelledby="step-4-create-device-attestation-credential-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 4: Create Device Attestation Credential
  
  
</h3>
    

<p><strong>Purpose</strong>: Prove device is authentic and from manufacturer.</p>

<p><strong>Detailed Explanation</strong>:</p>

<p><strong>Credential Structure</strong>:</p>
<ol>
  <li><strong>Device Information</strong>: Model, serial number, manufacturing date
    <ul>
      <li><strong>Why</strong>: Identifies specific device instance</li>
      <li><strong>Use Case</strong>: Recall management, warranty tracking</li>
    </ul>
  </li>
  <li><strong>Manufacturer Reference</strong>: Links to manufacturer DID
    <ul>
      <li><strong>Why</strong>: Proves device came from legitimate manufacturer</li>
      <li><strong>Use Case</strong>: Prevents counterfeiting</li>
    </ul>
  </li>
  <li><strong>Firmware Version</strong>: Current firmware version
    <ul>
      <li><strong>Why</strong>: Enables firmware update tracking</li>
      <li><strong>Use Case</strong>: Security patch management</li>
    </ul>
  </li>
</ol>

<p><strong>Security Features</strong>:</p>
<ul>
  <li><strong>Tamper-Proof</strong>: Cryptographic proof prevents tampering</li>
  <li><strong>Verifiable</strong>: Anyone can verify credential</li>
  <li><strong>Non-Repudiation</strong>: Manufacturer cannot deny issuance</li>
  <li><strong>Permanent</strong>: Attestation doesn’t expire (device is always from manufacturer)</li>
</ul>
<h3 id="step-5-issue-attestation-credential">
  
  
    <a href="#step-5-issue-attestation-credential" class="anchor-heading" aria-labelledby="step-5-issue-attestation-credential"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 5: Issue Attestation Credential
  
  
</h3>
    

<p><strong>Purpose</strong>: Cryptographically sign device attestation.</p>

<p><strong>Detailed Explanation</strong>:</p>

<p><strong>Proof Generation Process</strong>:</p>
<ol>
  <li><strong>Key Generation</strong>: Generate manufacturer’s signing key
    <ul>
      <li><strong>Security</strong>: Key must be stored in HSM in production</li>
      <li><strong>Backup</strong>: Key backup is critical - loss means cannot issue new credentials</li>
    </ul>
  </li>
  <li><strong>Proof Generator Creation</strong>: Create Ed25519 proof generator
    <ul>
      <li><strong>Why Ed25519</strong>: Secure, efficient, widely supported</li>
      <li><strong>Signer Function</strong>: Wraps KMS sign operation</li>
      <li><strong>Public Key ID</strong>: Enables verification</li>
    </ul>
  </li>
  <li><strong>Credential Issuance</strong>: Sign credential with manufacturer key
    <ul>
      <li><strong>Proof Attachment</strong>: Proof is attached to credential</li>
      <li><strong>Verification</strong>: Anyone can verify proof</li>
    </ul>
  </li>
</ol>

<p><strong>Why This Matters</strong>: The cryptographic proof is what makes the credential trustworthy. Without it, anyone could create fake device attestations.</p>
<h3 id="step-6-create-capability-credential">
  
  
    <a href="#step-6-create-capability-credential" class="anchor-heading" aria-labelledby="step-6-create-capability-credential"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 6: Create Capability Credential
  
  
</h3>
    

<p><strong>Purpose</strong>: Describe device capabilities.</p>

<p><strong>Detailed Explanation</strong>:</p>

<p><strong>Capability Information</strong>:</p>
<ol>
  <li><strong>Sensors</strong>: What the device can sense
    <ul>
      <li><strong>Why</strong>: Enables automated device discovery</li>
      <li><strong>Use Case</strong>: Smart home systems finding temperature sensors</li>
    </ul>
  </li>
  <li><strong>Actuators</strong>: What the device can control
    <ul>
      <li><strong>Why</strong>: Enables automated control</li>
      <li><strong>Use Case</strong>: Home automation systems controlling lights</li>
    </ul>
  </li>
  <li><strong>Communication</strong>: Supported protocols
    <ul>
      <li><strong>Why</strong>: Enables protocol selection</li>
      <li><strong>Use Case</strong>: Choosing communication protocol</li>
    </ul>
  </li>
  <li><strong>Processing</strong>: Processing capabilities
    <ul>
      <li><strong>Why</strong>: Enables workload distribution</li>
      <li><strong>Use Case</strong>: Edge computing decisions</li>
    </ul>
  </li>
</ol>

<p><strong>Why This Matters</strong>: Capability credentials enable:</p>
<ul>
  <li><strong>Automated Discovery</strong>: Systems can find devices with specific capabilities</li>
  <li><strong>Interoperability</strong>: Devices from different manufacturers can work together</li>
  <li><strong>Resource Planning</strong>: Systems can plan resource usage</li>
</ul>
<h3 id="step-7-create-network-authorization-credential-1">
  
  
    <a href="#step-7-create-network-authorization-credential-1" class="anchor-heading" aria-labelledby="step-7-create-network-authorization-credential-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 7: Create Network Authorization Credential
  
  
</h3>
    

<p><strong>Purpose</strong>: Grant device permission to join network.</p>

<p><strong>Detailed Explanation</strong>:</p>

<p><strong>Authorization Details</strong>:</p>
<ol>
  <li><strong>Network ID</strong>: Specific network device can join
    <ul>
      <li><strong>Why</strong>: Prevents unauthorized network access</li>
      <li><strong>Security</strong>: Device can only join authorized networks</li>
    </ul>
  </li>
  <li><strong>Authorized Resources</strong>: What resources device can access
    <ul>
      <li><strong>Why</strong>: Principle of least privilege</li>
      <li><strong>Security</strong>: Limits device access to necessary resources</li>
    </ul>
  </li>
  <li><strong>Time Restrictions</strong>: When device can access network
    <ul>
      <li><strong>Why</strong>: Enables time-based access control</li>
      <li><strong>Use Case</strong>: Restricting device access during maintenance</li>
    </ul>
  </li>
</ol>

<p><strong>Why This Matters</strong>: Network authorization provides:</p>
<ul>
  <li><strong>Access Control</strong>: Only authorized devices can join</li>
  <li><strong>Resource Protection</strong>: Limits what devices can access</li>
  <li><strong>Security</strong>: Prevents unauthorized access</li>
</ul>
<h3 id="step-8-verify-device-before-network-access-1">
  
  
    <a href="#step-8-verify-device-before-network-access-1" class="anchor-heading" aria-labelledby="step-8-verify-device-before-network-access-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 8: Verify Device Before Network Access
  
  
</h3>
    

<p><strong>Purpose</strong>: Security checkpoint before allowing network access.</p>

<p><strong>Detailed Explanation</strong>:</p>

<p><strong>Verification Steps</strong>:</p>
<ol>
  <li><strong>Attestation Verification</strong>: Verify device is authentic
    <ul>
      <li><strong>Why</strong>: Ensures device is from legitimate manufacturer</li>
      <li><strong>Security</strong>: Prevents counterfeit devices</li>
    </ul>
  </li>
  <li><strong>Authorization Verification</strong>: Verify device has network permission
    <ul>
      <li><strong>Why</strong>: Ensures device is authorized for this network</li>
      <li><strong>Security</strong>: Prevents unauthorized access</li>
    </ul>
  </li>
  <li><strong>Expiration Check</strong>: Verify credentials haven’t expired
    <ul>
      <li><strong>Why</strong>: Ensures credentials are still valid</li>
      <li><strong>Security</strong>: Prevents use of stale credentials</li>
    </ul>
  </li>
  <li><strong>Revocation Check</strong>: Verify credentials haven’t been revoked
    <ul>
      <li><strong>Why</strong>: Ensures device hasn’t been compromised</li>
      <li><strong>Security</strong>: Prevents compromised devices from accessing network</li>
    </ul>
  </li>
</ol>

<p><strong>Why This Matters</strong>: This verification is the critical security checkpoint. Without it, any device could join the network.</p>
<h3 id="step-9-device-to-device-communication-1">
  
  
    <a href="#step-9-device-to-device-communication-1" class="anchor-heading" aria-labelledby="step-9-device-to-device-communication-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 9: Device-to-Device Communication
  
  
</h3>
    

<p><strong>Purpose</strong>: Enable secure communication between devices.</p>

<p><strong>Detailed Explanation</strong>:</p>

<p><strong>Communication Setup</strong>:</p>
<ol>
  <li><strong>Identity Verification</strong>: Devices verify each other’s identity
    <ul>
      <li><strong>Why</strong>: Ensures devices are authentic</li>
      <li><strong>Security</strong>: Prevents man-in-the-middle attacks</li>
    </ul>
  </li>
  <li><strong>Credential Exchange</strong>: Devices exchange credentials
    <ul>
      <li><strong>Why</strong>: Establishes trust between devices</li>
      <li><strong>Security</strong>: Enables secure communication</li>
    </ul>
  </li>
  <li><strong>Key Exchange</strong>: Devices exchange encryption keys
    <ul>
      <li><strong>Why</strong>: Enables encrypted communication</li>
      <li><strong>Security</strong>: Protects data in transit</li>
    </ul>
  </li>
</ol>

<p><strong>Why This Matters</strong>: Device-to-device communication enables:</p>
<ul>
  <li><strong>Local Processing</strong>: Devices can process data locally</li>
  <li><strong>Reduced Latency</strong>: No need to go through cloud</li>
  <li><strong>Privacy</strong>: Data stays local</li>
  <li><strong>Resilience</strong>: Works even if cloud is down</li>
</ul>
<h3 id="step-10-anchor-device-identity-to-blockchain-1">
  
  
    <a href="#step-10-anchor-device-identity-to-blockchain-1" class="anchor-heading" aria-labelledby="step-10-anchor-device-identity-to-blockchain-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 10: Anchor Device Identity to Blockchain
  
  
</h3>
    

<p><strong>Purpose</strong>: Create immutable record of device identity.</p>

<p><strong>Detailed Explanation</strong>:</p>

<p><strong>Blockchain Benefits</strong>:</p>
<ol>
  <li><strong>Immutability</strong>: Record cannot be tampered with
    <ul>
      <li><strong>Why</strong>: Provides permanent record</li>
      <li><strong>Use Case</strong>: Audit trails, compliance</li>
    </ul>
  </li>
  <li><strong>Verification</strong>: Anyone can verify device identity
    <ul>
      <li><strong>Why</strong>: No need to contact manufacturer</li>
      <li><strong>Use Case</strong>: Third-party verification</li>
    </ul>
  </li>
  <li><strong>Non-Repudiation</strong>: Manufacturer cannot deny issuance
    <ul>
      <li><strong>Why</strong>: Provides legal proof</li>
      <li><strong>Use Case</strong>: Warranty claims, recalls</li>
    </ul>
  </li>
</ol>

<p><strong>Why This Matters</strong>: Blockchain anchoring provides:</p>
<ul>
  <li><strong>Trust</strong>: Third parties can verify independently</li>
  <li><strong>Compliance</strong>: Meets regulatory requirements</li>
  <li><strong>Audit</strong>: Permanent audit trail</li>
  <li><strong>Transparency</strong>: Public verification</li>
</ul>
<h2 id="advanced-features">
  
  
    <a href="#advanced-features" class="anchor-heading" aria-labelledby="advanced-features"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Advanced Features
  
  
</h2>
    
<h3 id="secure-boot-verification">
  
  
    <a href="#secure-boot-verification" class="anchor-heading" aria-labelledby="secure-boot-verification"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Secure Boot Verification
  
  
</h3>
    

<p>Verify device booted securely:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="k">fun</span> <span class="nf">createSecureBootCredential</span><span class="p">(</span>
    <span class="n">deviceDid</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">bootMeasurement</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">issuerDid</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">):</span> <span class="nc">VerifiableCredential</span> <span class="p">{</span>
    <span class="c1">// Secure boot credential proves device booted with trusted firmware</span>
    <span class="c1">// bootMeasurement is cryptographic hash of boot process</span>
    <span class="c1">// This prevents compromised firmware from running</span>
    <span class="k">return</span> <span class="nc">VerifiableCredential</span><span class="p">(</span>
        <span class="n">type</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"SecureBootCredential"</span><span class="p">),</span>
        <span class="n">issuer</span> <span class="p">=</span> <span class="n">issuerDid</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">deviceDid</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"secureBoot"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"bootMeasurement"</span><span class="p">,</span> <span class="n">bootMeasurement</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"bootDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"firmwareHash"</span><span class="p">,</span> <span class="s">"sha256:abc123..."</span><span class="p">)</span>
            <span class="p">})</span>
        <span class="p">},</span>
        <span class="n">issuanceDate</span> <span class="p">=</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">()</span>
    <span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h3 id="device-lifecycle-management">
  
  
    <a href="#device-lifecycle-management" class="anchor-heading" aria-labelledby="device-lifecycle-management"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Device Lifecycle Management
  
  
</h3>
    

<p>Track device through lifecycle:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="k">fun</span> <span class="nf">createLifecycleCredential</span><span class="p">(</span>
    <span class="n">deviceDid</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">lifecycleStage</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">issuerDid</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">):</span> <span class="nc">VerifiableCredential</span> <span class="p">{</span>
    <span class="c1">// Lifecycle credential tracks device status</span>
    <span class="c1">// Stages: manufactured, deployed, active, maintenance, decommissioned</span>
    <span class="k">return</span> <span class="nc">VerifiableCredential</span><span class="p">(</span>
        <span class="n">type</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"DeviceLifecycleCredential"</span><span class="p">),</span>
        <span class="n">issuer</span> <span class="p">=</span> <span class="n">issuerDid</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">deviceDid</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"lifecycle"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"stage"</span><span class="p">,</span> <span class="n">lifecycleStage</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"transitionDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"previousStage"</span><span class="p">,</span> <span class="s">"manufactured"</span><span class="p">)</span>
            <span class="p">})</span>
        <span class="p">},</span>
        <span class="n">issuanceDate</span> <span class="p">=</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">()</span>
    <span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h3 id="device-update-credentials">
  
  
    <a href="#device-update-credentials" class="anchor-heading" aria-labelledby="device-update-credentials"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Device Update Credentials
  
  
</h3>
    

<p>Track firmware updates:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="k">fun</span> <span class="nf">createUpdateCredential</span><span class="p">(</span>
    <span class="n">deviceDid</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">firmwareVersion</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">updateHash</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">issuerDid</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">):</span> <span class="nc">VerifiableCredential</span> <span class="p">{</span>
    <span class="c1">// Update credential proves firmware update was legitimate</span>
    <span class="c1">// Prevents malicious firmware updates</span>
    <span class="k">return</span> <span class="nc">VerifiableCredential</span><span class="p">(</span>
        <span class="n">type</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"DeviceUpdateCredential"</span><span class="p">),</span>
        <span class="n">issuer</span> <span class="p">=</span> <span class="n">issuerDid</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">deviceDid</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"update"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"firmwareVersion"</span><span class="p">,</span> <span class="n">firmwareVersion</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"updateHash"</span><span class="p">,</span> <span class="n">updateHash</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"updateDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"signedBy"</span><span class="p">,</span> <span class="n">issuerDid</span><span class="p">)</span>
            <span class="p">})</span>
        <span class="p">},</span>
        <span class="n">issuanceDate</span> <span class="p">=</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">()</span>
    <span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="real-world-use-cases">
  
  
    <a href="#real-world-use-cases" class="anchor-heading" aria-labelledby="real-world-use-cases"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Real-World Use Cases
  
  
</h2>
    
<h3 id="1-smart-home-device-authentication">
  
  
    <a href="#1-smart-home-device-authentication" class="anchor-heading" aria-labelledby="1-smart-home-device-authentication"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Smart Home Device Authentication
  
  
</h3>
    

<p><strong>Scenario</strong>: Smart home hub verifies devices before allowing them to join network.</p>

<p><strong>Implementation</strong>:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="k">fun</span> <span class="nf">authenticateSmartHomeDevice</span><span class="p">(</span>
    <span class="n">deviceAttestation</span><span class="p">:</span> <span class="nc">VerifiableCredential</span><span class="p">,</span>
    <span class="n">hubDid</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">):</span> <span class="nc">Boolean</span> <span class="p">{</span>
    <span class="c1">// Verify device attestation</span>
    <span class="kd">val</span> <span class="py">verifier</span> <span class="p">=</span> <span class="nc">CredentialVerifier</span><span class="p">(</span>
        <span class="n">didResolver</span> <span class="p">=</span> <span class="nc">CredentialDidResolver</span> <span class="p">{</span> <span class="n">did</span> <span class="p">-&gt;</span>
            <span class="n">didRegistry</span><span class="p">.</span><span class="nf">resolve</span><span class="p">(</span><span class="n">did</span><span class="p">).</span><span class="nf">toCredentialDidResolution</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="kd">val</span> <span class="py">verification</span> <span class="p">=</span> <span class="n">verifier</span><span class="p">.</span><span class="nf">verify</span><span class="p">(</span>
        <span class="n">credential</span> <span class="p">=</span> <span class="n">deviceAttestation</span><span class="p">,</span>
        <span class="n">options</span> <span class="p">=</span> <span class="nc">CredentialVerificationOptions</span><span class="p">(</span><span class="n">checkRevocation</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="p">(!</span><span class="n">verification</span><span class="p">.</span><span class="n">valid</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span>
    
    <span class="c1">// Check if device is from trusted manufacturer</span>
    <span class="kd">val</span> <span class="py">manufacturerDid</span> <span class="p">=</span> <span class="n">deviceAttestation</span><span class="p">.</span><span class="n">issuer</span>
    <span class="kd">val</span> <span class="py">trustedManufacturers</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span>
        <span class="s">"did:example:manufacturer1"</span><span class="p">,</span>
        <span class="s">"did:example:manufacturer2"</span>
    <span class="p">)</span>
    
    <span class="k">return</span> <span class="n">manufacturerDid</span> <span class="k">in</span> <span class="n">trustedManufacturers</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h3 id="2-industrial-iot-device-management">
  
  
    <a href="#2-industrial-iot-device-management" class="anchor-heading" aria-labelledby="2-industrial-iot-device-management"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Industrial IoT Device Management
  
  
</h3>
    

<p><strong>Scenario</strong>: Industrial system verifies device capabilities before deployment.</p>

<p><strong>Implementation</strong>:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="k">fun</span> <span class="nf">verifyDeviceCapabilities</span><span class="p">(</span>
    <span class="n">capabilityCredential</span><span class="p">:</span> <span class="nc">VerifiableCredential</span><span class="p">,</span>
    <span class="n">requiredCapabilities</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>
<span class="p">):</span> <span class="nc">Boolean</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">capabilities</span> <span class="p">=</span> <span class="n">capabilityCredential</span><span class="p">.</span><span class="n">credentialSubject</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">[</span><span class="s">"capabilities"</span><span class="p">]</span><span class="o">?.</span><span class="n">jsonObject</span>
        <span class="o">?:</span> <span class="k">return</span> <span class="k">false</span>
    
    <span class="kd">val</span> <span class="py">deviceSensors</span> <span class="p">=</span> <span class="n">capabilities</span><span class="p">[</span><span class="s">"sensors"</span><span class="p">]</span><span class="o">?.</span><span class="n">jsonArray</span>
        <span class="o">?.</span><span class="nf">map</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">jsonPrimitive</span><span class="p">.</span><span class="n">content</span> <span class="p">}</span>
        <span class="o">?:</span> <span class="k">return</span> <span class="k">false</span>
    
    <span class="c1">// Check if device has all required capabilities</span>
    <span class="k">return</span> <span class="n">requiredCapabilities</span><span class="p">.</span><span class="nf">all</span> <span class="p">{</span> <span class="n">it</span> <span class="k">in</span> <span class="n">deviceSensors</span> <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h3 id="3-vehicle-to-vehicle-communication">
  
  
    <a href="#3-vehicle-to-vehicle-communication" class="anchor-heading" aria-labelledby="3-vehicle-to-vehicle-communication"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. Vehicle-to-Vehicle Communication
  
  
</h3>
    

<p><strong>Scenario</strong>: Vehicles verify each other’s identity before communicating.</p>

<p><strong>Implementation</strong>:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="k">fun</span> <span class="nf">establishVehicleCommunication</span><span class="p">(</span>
    <span class="n">vehicle1Did</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">vehicle2Did</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">vehicle1Attestation</span><span class="p">:</span> <span class="nc">VerifiableCredential</span><span class="p">,</span>
    <span class="n">vehicle2Attestation</span><span class="p">:</span> <span class="nc">VerifiableCredential</span>
<span class="p">):</span> <span class="nc">Boolean</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">verifier</span> <span class="p">=</span> <span class="nc">CredentialVerifier</span><span class="p">(</span>
        <span class="n">didResolver</span> <span class="p">=</span> <span class="nc">CredentialDidResolver</span> <span class="p">{</span> <span class="n">did</span> <span class="p">-&gt;</span>
            <span class="n">didRegistry</span><span class="p">.</span><span class="nf">resolve</span><span class="p">(</span><span class="n">did</span><span class="p">).</span><span class="nf">toCredentialDidResolution</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="c1">// Verify both vehicle attestations</span>
    <span class="kd">val</span> <span class="py">v1Verification</span> <span class="p">=</span> <span class="n">verifier</span><span class="p">.</span><span class="nf">verify</span><span class="p">(</span>
        <span class="n">credential</span> <span class="p">=</span> <span class="n">vehicle1Attestation</span><span class="p">,</span>
        <span class="n">options</span> <span class="p">=</span> <span class="nc">CredentialVerificationOptions</span><span class="p">(</span><span class="n">checkRevocation</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="kd">val</span> <span class="py">v2Verification</span> <span class="p">=</span> <span class="n">verifier</span><span class="p">.</span><span class="nf">verify</span><span class="p">(</span>
        <span class="n">credential</span> <span class="p">=</span> <span class="n">vehicle2Attestation</span><span class="p">,</span>
        <span class="n">options</span> <span class="p">=</span> <span class="nc">CredentialVerificationOptions</span><span class="p">(</span><span class="n">checkRevocation</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="c1">// Both vehicles must be verified</span>
    <span class="k">return</span> <span class="n">v1Verification</span><span class="p">.</span><span class="n">valid</span> <span class="p">&amp;&amp;</span> <span class="n">v2Verification</span><span class="p">.</span><span class="n">valid</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="benefits">
  
  
    <a href="#benefits" class="anchor-heading" aria-labelledby="benefits"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Benefits
  
  
</h2>
    

<ol>
  <li><strong>Device Authentication</strong>: Cryptographic proof of device identity</li>
  <li><strong>Trust</strong>: Verify device authenticity and capabilities</li>
  <li><strong>Security</strong>: Prevent unauthorized device access</li>
  <li><strong>Interoperability</strong>: Standard format works across manufacturers</li>
  <li><strong>Scalability</strong>: Decentralized identity scales to millions of devices</li>
  <li><strong>Lifecycle Management</strong>: Manage device identity throughout lifecycle</li>
  <li><strong>Network Authorization</strong>: Control which devices can join networks</li>
  <li><strong>Device-to-Device Communication</strong>: Secure communication between devices</li>
  <li><strong>Compliance</strong>: Meet regulatory requirements</li>
  <li><strong>Audit Trail</strong>: Immutable records of device identity</li>
</ol>
<h2 id="best-practices">
  
  
    <a href="#best-practices" class="anchor-heading" aria-labelledby="best-practices"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Best Practices
  
  
</h2>
    

<ol>
  <li><strong>Secure Key Storage</strong>: Use HSMs or secure elements for device keys</li>
  <li><strong>Attestation Verification</strong>: Always verify device attestation</li>
  <li><strong>Network Authorization</strong>: Issue network authorization separately</li>
  <li><strong>Capability Verification</strong>: Verify device capabilities before use</li>
  <li><strong>Lifecycle Management</strong>: Track device through lifecycle</li>
  <li><strong>Update Management</strong>: Verify firmware updates</li>
  <li><strong>Revocation</strong>: Enable credential revocation</li>
  <li><strong>Error Handling</strong>: Handle verification failures gracefully</li>
  <li><strong>Key Rotation</strong>: Rotate keys periodically</li>
  <li><strong>Audit Logging</strong>: Log all device authentication events</li>
</ol>
<h2 id="next-steps">
  
  
    <a href="#next-steps" class="anchor-heading" aria-labelledby="next-steps"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Next Steps
  
  
</h2>
    

<ul>
  <li>Learn about <a href="/trustweave/scenarios/spatial-web-authorization-scenario/">Spatial Web Authorization Scenario</a> for related authorization concepts</li>
  <li>Explore <a href="/trustweave/scenarios/proof-of-location-scenario/">Proof of Location Scenario</a> for location-based device tracking</li>
  <li>Check out <a href="/trustweave/scenarios/supply-chain-traceability-scenario/">Supply Chain &amp; Traceability Scenario</a> for device manufacturing tracking</li>
  <li>Review <a href="/trustweave/core-concepts/dids/">Core Concepts: DIDs</a> for identity management</li>
</ul>

          

          
            
          
        </main>
        

  <hr>
  <footer>
    

    <!-- Hidden template for footer injection -->
<div id="footer-template" style="display: none;">
  <!-- Site Footer - Consistent across all pages -->
<footer class="site-footer">
    <div class="footer-content">
        <div class="footer-links">
            <a href="/trustweave/">Home</a>
            <a href="/trustweave/getting-started/README/">Documentation</a>
            <a href="https://github.com/geoknoesis/TrustWeave" target="_blank">GitHub</a>
            <a href="/trustweave/partnership/">Partners</a>
            <a href="https://github.com/geoknoesis/TrustWeave/blob/main/docs/README.md" target="_blank">Docs</a>
            <a href="https://github.com/geoknoesis/TrustWeave/blob/main/LICENSE" target="_blank">License</a>
            <a href="https://www.geoknoesis.com" target="_blank">Geoknoesis LLC</a>
        </div>
        <p class="footer-text">Made with ❤️ by Geoknoesis LLC</p>
    </div>
</footer>


</div>
<script>
  // Move footer from template to body bottom and make it full width
  document.addEventListener('DOMContentLoaded', function() {
    const template = document.getElementById('footer-template');
    if (template) {
      const footer = template.querySelector('.site-footer');
      if (footer) {
        // Move footer to body level (outside of any containers)
        document.body.appendChild(footer);
        template.remove();
        
        // Ensure footer spans full width by removing any parent constraints
        footer.style.position = 'relative';
        footer.style.width = '100vw';
        footer.style.marginLeft = 'calc(-50vw + 50%)';
        footer.style.marginRight = 'calc(-50vw + 50%)';
      }
    }
  });
</script>


    
  </footer>


      </div>
    </div>
    
      

<div class="search-overlay"></div>

    
  </div>

  
    





<script type="module">
  
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.esm.min.mjs';
  

  var config = {}
;
  mermaid.initialize(config);
  mermaid.run({
    querySelector: '.language-mermaid',
  });
</script>



  
</body>
</html>

