

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/trustweave/assets/css/just-the-docs-default.css">

  <link rel="stylesheet" href="/trustweave/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet">

  <style id="jtd-nav-activation">
  
    .site-nav ul li a {
      background-image: none;
    }

  </style>

  

  
    <script src="/trustweave/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/trustweave/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Parametric Insurance for Travel Disruptions | TrustWeave Developer Documentation</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Parametric Insurance for Travel Disruptions" />
<meta name="author" content="GeoKnoesis" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin" />
<meta property="og:description" content="Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin" />
<link rel="canonical" href="http://0.0.0.0:4000/trustweave/scenarios/parametric-insurance-travel-scenario/" />
<meta property="og:url" content="http://0.0.0.0:4000/trustweave/scenarios/parametric-insurance-travel-scenario/" />
<meta property="og:site_name" content="TrustWeave Developer Documentation" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Parametric Insurance for Travel Disruptions" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"GeoKnoesis"},"description":"Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin","headline":"Parametric Insurance for Travel Disruptions","url":"http://0.0.0.0:4000/trustweave/scenarios/parametric-insurance-travel-scenario/"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Main Navigation Styles - Consistent across all pages -->
<style>
  :root {
    --primary: #2563eb;
    --primary-dark: #1e40af;
    --secondary: #7c3aed;
    --accent: #10b981;
    --text: #1f2937;
    --text-light: #6b7280;
    --bg: #ffffff;
    --bg-light: #f9fafb;
    --border: #e5e7eb;
    --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }

  .main-nav {
    position: fixed;
    top: 0;
    width: 100%;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border);
    z-index: 1000;
    padding: 0.5rem 0;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  }

  .main-nav .nav-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .main-nav .logo {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    text-decoration: none;
    transition: opacity 0.3s;
  }

  .main-nav .logo-img {
    height: 120px;
    width: auto;
    transition: opacity 0.3s;
    display: block;
  }

  .main-nav .logo-img:not([src]),
  .main-nav .logo-img[src=""],
  .main-nav .logo-img[src*="undefined"] {
    display: none;
  }


  .main-nav .logo:hover {
    opacity: 0.8;
  }

  .main-nav .logo:hover .logo-img {
    opacity: 0.8;
  }

  .main-nav .nav-links {
    display: flex;
    gap: 1.5rem;
    align-items: center;
  }

  .main-nav .nav-links .nav-link {
    text-decoration: none;
    color: var(--text);
    font-weight: 500;
    font-size: 0.95rem;
    padding: 0.5rem 0;
    transition: color 0.3s;
    position: relative;
    white-space: nowrap;
  }

  .main-nav .nav-links .nav-link:hover {
    color: var(--primary);
  }

  .main-nav .nav-links .nav-link::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 2px;
    background: var(--primary);
    transition: width 0.3s ease;
  }

  .main-nav .nav-links .nav-link:hover::after,
  .main-nav .nav-links .nav-link.active::after {
    width: 100%;
  }

  .main-nav .nav-links .nav-link.active {
    color: var(--primary);
    font-weight: 600;
  }

  /* GitHub icon button */
  .main-nav .nav-links .github-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    border-radius: 0.5rem;
    transition: all 0.3s;
    padding: 0.5rem;
    color: var(--text);
    text-decoration: none;
    margin-left: 0.5rem;
  }

  .main-nav .nav-links .github-icon:hover {
    background: var(--bg-light);
    transform: translateY(-2px);
    color: var(--primary);
  }

  .main-nav .nav-links .github-icon svg {
    width: 32px;
    height: 32px;
  }

  /* Mobile menu toggle */
  .menu-toggle {
    display: none;
    flex-direction: column;
    cursor: pointer;
    gap: 5px;
    padding: 0.5rem;
    z-index: 1001;
  }

  .menu-toggle span {
    width: 25px;
    height: 3px;
    background: var(--text);
    transition: all 0.3s;
    border-radius: 2px;
  }

  .menu-toggle.active span:nth-child(1) {
    transform: rotate(45deg) translate(8px, 8px);
  }

  .menu-toggle.active span:nth-child(2) {
    opacity: 0;
  }

  .menu-toggle.active span:nth-child(3) {
    transform: rotate(-45deg) translate(7px, -7px);
  }

  /* Footer styles */
  .site-footer {
    background: var(--text);
    color: white;
    padding: 3rem 2rem;
    text-align: center;
    margin-top: 4rem;
  }

  .site-footer .footer-content {
    max-width: 1200px;
    margin: 0 auto;
  }

  .site-footer .footer-links {
    display: flex;
    justify-content: center;
    gap: 2rem;
    margin-bottom: 2rem;
    flex-wrap: wrap;
  }

  .site-footer .footer-links a {
    color: rgba(255, 255, 255, 0.8);
    text-decoration: none;
    transition: color 0.3s;
  }

  .site-footer .footer-links a:hover {
    color: white;
  }

  .site-footer .footer-text {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.875rem;
  }

  /* Adjust content for fixed nav */
  body {
    padding-top: 160px;
  }

  /* Just the Docs theme adjustments */
  .site-header {
    margin-top: 0 !important;
  }

  /* Mobile responsive */
  @media (max-width: 968px) {
    .menu-toggle {
      display: flex;
    }

    .main-nav .nav-links {
      position: fixed;
      top: 160px;
      left: 0;
      right: 0;
      background: white;
      flex-direction: column;
      padding: 2rem;
      border-bottom: 1px solid var(--border);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transform: translateY(-100%);
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      gap: 1.5rem;
      align-items: flex-start;
      max-height: calc(100vh - 160px);
      overflow-y: auto;
    }

    .main-nav .nav-links.active {
      transform: translateY(0);
      opacity: 1;
      visibility: visible;
    }

    .main-nav .nav-links .nav-link {
      width: 100%;
      padding: 0.75rem 0;
      border-bottom: 1px solid var(--border);
    }

    .main-nav .nav-links .nav-link::after {
      display: none;
    }

    .main-nav .nav-links .github-icon {
      width: 100%;
      justify-content: flex-start;
      margin-left: 0;
      padding: 0.75rem 0;
      border-bottom: 1px solid var(--border);
    }

    .main-nav .logo-img {
      height: 120px;
    }

    .site-footer .footer-links {
      flex-direction: column;
      gap: 1rem;
    }
  }

  /* Tablet adjustments */
  @media (max-width: 968px) and (min-width: 769px) {
    .main-nav .nav-links {
      gap: 1rem;
    }

    .main-nav .nav-links .nav-link {
      font-size: 0.9rem;
    }
  }
</style>

<style>
  body { padding-top: 160px !important; }
  .main-nav { z-index: 1000; position: fixed; top: 0; width: 100%; }
  #header-template { display: none; }

  /* Ensure footer spans full width and breaks out of containers */
  .site-footer {
    position: relative !important;
    width: 100vw !important;
    max-width: 100vw !important;
    margin-left: calc(-50vw + 50%) !important;
    margin-right: calc(-50vw + 50%) !important;
    left: 0 !important;
    right: 0 !important;
    clear: both !important;
    z-index: 100 !important;
    box-sizing: border-box !important;
  }
</style>
<!-- Hidden template for header injection -->
<div id="header-template" style="display: none;">
  <!-- Site Header - Consistent across all pages -->
<nav class="main-nav">
    <div class="nav-container">
        <a href="/trustweave/" class="logo">
            <img src="http://0.0.0.0:4000/trustweave/assets/images/trustweave-logo.jpg" alt="TrustWeave Logo" class="logo-img">
        </a>
        <div class="menu-toggle" id="menuToggle" aria-label="Toggle menu">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="nav-links" id="navLinks">
            <a href="/trustweave/" class="nav-link">Home</a>
            <a href="/trustweave/#features" class="nav-link">Features</a>
            <a href="/trustweave/use-scenarios/" class="nav-link">Use Scenarios</a>
            <a href="/trustweave/getting-started/README/" class="nav-link">Docs</a>
            <a href="/trustweave/partnership/" class="nav-link">Partners</a>
            <a href="/trustweave/about/" class="nav-link">About</a>
            <a href="https://github.com/geoknoesis/TrustWeave" target="_blank" rel="noopener noreferrer" class="github-icon" title="View on GitHub" aria-label="GitHub Repository">
                <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
            </a>
        </div>
    </div>
</nav>
<script>
    // Mobile menu toggle and active page highlighting
    (function() {
        const menuToggle = document.getElementById('menuToggle');
        const navLinks = document.getElementById('navLinks');

        // Mobile menu toggle
        if (menuToggle && navLinks) {
            menuToggle.addEventListener('click', () => {
                navLinks.classList.toggle('active');
                menuToggle.classList.toggle('active');
            });

            // Close menu when clicking on a link
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.addEventListener('click', () => {
                    navLinks.classList.remove('active');
                    menuToggle.classList.remove('active');
                });
            });

            // Close menu when clicking outside
            document.addEventListener('click', (e) => {
                if (!menuToggle.contains(e.target) && !navLinks.contains(e.target)) {
                    navLinks.classList.remove('active');
                    menuToggle.classList.remove('active');
                }
            });
        }

        // Highlight active page
        const currentPath = window.location.pathname;
        const navLinksList = document.querySelectorAll('.nav-links .nav-link');

        navLinksList.forEach(link => {
            try {
                const linkUrl = new URL(link.href, window.location.origin);
                const linkPath = linkUrl.pathname;
                const baseUrl = '/trustweave' || '';

                // Normalize paths
                let cleanCurrentPath = currentPath.replace(baseUrl, '').replace(/\/$/, '') || '/';
                let cleanLinkPath = linkPath.replace(baseUrl, '').replace(/\/$/, '') || '/';

                // Handle index pages
                if (cleanCurrentPath === '' || cleanCurrentPath === '/index.html') cleanCurrentPath = '/';
                if (cleanLinkPath === '' || cleanLinkPath === '/index.html') cleanLinkPath = '/';

                // Check if current path matches link path
                if (cleanCurrentPath === cleanLinkPath) {
                    link.classList.add('active');
                } else if (cleanLinkPath !== '/' && cleanCurrentPath.startsWith(cleanLinkPath + '/')) {
                    // Handle sub-pages (e.g., /introduction/ matches /introduction/README/)
                    link.classList.add('active');
                }
            } catch (e) {
                // Fallback for relative URLs or errors
                const href = link.getAttribute('href');
                if (href && (currentPath.includes(href) || (href === '/' && currentPath.endsWith('index.html')))) {
                    link.classList.add('active');
                }
            }
        });
    })();
</script>


</div>
<script>
  // Move header from template to body top
  document.addEventListener('DOMContentLoaded', function() {
    const template = document.getElementById('header-template');
    if (template) {
      const header = template.querySelector('.main-nav');
      if (header) {
        document.body.insertBefore(header, document.body.firstChild);
        template.remove();
      }
    }
  });
</script>


</head>

<body>
  <a class="skip-to-main" href="#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  
    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>

  
  
    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>

  
</svg>

  
    <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="/trustweave/" class="site-title lh-tight">
  TrustWeave Developer Documentation

</a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </button>
  </div>

  <nav aria-label="Main" id="site-nav" class="site-nav">
  
  
    <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Introduction category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/introduction/README/" class="nav-list-link">Introduction</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/introduction/what-is-trustweave/" class="nav-list-link">What is TrustWeave?</a></li><li class="nav-list-item"><a href="/trustweave/introduction/executive-overview/" class="nav-list-link">Executive Overview: TrustWeave</a></li><li class="nav-list-item"><a href="/trustweave/introduction/key-features/" class="nav-list-link">Key Features</a></li><li class="nav-list-item"><a href="/trustweave/introduction/use-cases/" class="nav-list-link">Use Cases</a></li><li class="nav-list-item"><a href="/trustweave/introduction/architecture-overview/" class="nav-list-link">Architecture Overview</a></li><li class="nav-list-item"><a href="/trustweave/introduction/mental-model/" class="nav-list-link">TrustWeave Mental Model</a></li><li class="nav-list-item"><a href="/trustweave/introduction/web-of-trust/" class="nav-list-link">The Web of Trust: Foundation for Decentralized Trust</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Getting Started category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/getting-started/README/" class="nav-list-link">Getting Started</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/getting-started/installation/" class="nav-list-link">Installation</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/quick-start/" class="nav-list-link">Quick Start</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/your-first-application/" class="nav-list-link">Your First Application</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/project-setup/" class="nav-list-link">Project Setup</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/ide-setup/" class="nav-list-link">IDE Setup Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/common-patterns/" class="nav-list-link">Common Patterns</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/api-patterns/" class="nav-list-link">API Patterns and Best Practices</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/workflows/" class="nav-list-link">Common Workflows</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/dsl-guide/" class="nav-list-link">TrustWeave DSL Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/troubleshooting/" class="nav-list-link">Troubleshooting Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/production-deployment/" class="nav-list-link">Production Deployment Guide</a></li></ul></li><li class="nav-list-item"><a href="/trustweave/tutorials/README/" class="nav-list-link">Tutorials</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in How-To Guides category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/how-to/README/" class="nav-list-link">How-To Guides</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/how-to/use-trustweave-facade/" class="nav-list-link">Use TrustWeave Facade for Quick Setup</a></li><li class="nav-list-item"><a href="/trustweave/how-to/configure-trustlayer/" class="nav-list-link">Configure TrustWeave</a></li><li class="nav-list-item"><a href="/trustweave/how-to/create-dids/" class="nav-list-link">Create and Manage DIDs</a></li><li class="nav-list-item"><a href="/trustweave/how-to/issue-credentials/" class="nav-list-link">Issue Credentials</a></li><li class="nav-list-item"><a href="/trustweave/how-to/verify-credentials/" class="nav-list-link">Verify Credentials</a></li><li class="nav-list-item"><a href="/trustweave/how-to/manage-wallets/" class="nav-list-link">Manage Wallets</a></li><li class="nav-list-item"><a href="/trustweave/how-to/blockchain-anchoring/" class="nav-list-link">Anchor to Blockchain</a></li><li class="nav-list-item"><a href="/trustweave/how-to/multi-chain-anchoring/" class="nav-list-link">Multi-Chain Anchoring Patterns</a></li><li class="nav-list-item"><a href="/trustweave/how-to/exchange-credentials/" class="nav-list-link">Exchange Credentials with Multiple Protocols</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Core Concepts category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/core-concepts/README/" class="nav-list-link">Core Concepts</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/core-concepts/dids/" class="nav-list-link">Decentralized Identifiers (DIDs)</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/verifiable-credentials/" class="nav-list-link">Verifiable Credentials (VCs)</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/wallets/" class="nav-list-link">Wallets</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/blockchain-anchoring/" class="nav-list-link">Blockchain Anchoring</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/smart-contracts/" class="nav-list-link">Smart Contracts</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/key-management/" class="nav-list-link">Key Management</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in API Reference category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/api-reference/README/" class="nav-list-link">API Reference</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/api-reference/quick-reference/" class="nav-list-link">Quick Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/error-types/" class="nav-list-link">Error Types</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/data-types/" class="nav-list-link">Data Types</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/core-api/" class="nav-list-link">Core API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/wallet-api/" class="nav-list-link">Wallet API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/credential-service-api/" class="nav-list-link">Credential Service API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/smart-contract-api/" class="nav-list-link">Smart Contract API Reference</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Reference category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/reference/README/" class="nav-list-link">Reference</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/modules/core-modules/" class="nav-list-link">Core Modules</a></li><li class="nav-list-item"><a href="/trustweave/faq/" class="nav-list-link">Frequently Asked Questions</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Advanced Topics category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/advanced/README/" class="nav-list-link">Advanced Topics</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/advanced/error-handling/" class="nav-list-link">Error Handling</a></li></ul></li><li class="nav-list-item"><a href="/trustweave/integrations/README/" class="nav-list-link">Integration Modules</a></li><li class="nav-list-item"><a href="/trustweave/contributing/README/" class="nav-list-link">Contributing to TrustWeave</a></li></ul>
  
</nav>




  
  
    <footer class="site-footer">
      This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.
    </footer>
  
</div>

  
  <div class="main" id="top">
    <div id="main-header" class="main-header">
  
    

<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search TrustWeave Developer Documentation" aria-label="Search TrustWeave Developer Documentation" autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>

  
  
  
</div>

    <div class="main-content-wrap">
      
      <div id="main-content" class="main-content">
        <main>
          
            <h1 id="parametric-insurance-for-travel-disruptions">
  
  
    <a href="#parametric-insurance-for-travel-disruptions" class="anchor-heading" aria-labelledby="parametric-insurance-for-travel-disruptions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Parametric Insurance for Travel Disruptions
  
  
</h1>
    

<p>This guide demonstrates how to build a parametric travel insurance system using TrustWeave, similar to Chubb Travel Pro. You’ll learn how to create verifiable credentials for travel disruption data (flight delays, weather events, baggage tracking) that trigger automatic insurance payouts, solving the “Oracle Problem” by enabling standardized, multi-provider data ecosystems for travel insurance.</p>
<h2 id="what-youll-build">
  
  
    <a href="#what-youll-build" class="anchor-heading" aria-labelledby="what-youll-build"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What You’ll Build
  
  
</h2>
    

<p>By the end of this tutorial, you’ll have:</p>

<ul>
  <li>✅ Created DIDs for travel insurance companies, airlines, weather services, and baggage tracking providers</li>
  <li>✅ Issued verifiable credentials for travel disruption data (flight delays, weather events, baggage status)</li>
  <li>✅ Built a standardized data oracle system using VCs that accepts data from multiple providers</li>
  <li>✅ Implemented parametric trigger verification for automatic payouts</li>
  <li>✅ Created multi-provider data acceptance workflows</li>
  <li>✅ Anchored travel data credentials to blockchain for tamper-proof triggers</li>
</ul>
<h2 id="big-picture--significance">
  
  
    <a href="#big-picture--significance" class="anchor-heading" aria-labelledby="big-picture--significance"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Big Picture &amp; Significance
  
  
</h2>
    
<h3 id="the-travel-insurance-oracle-problem">
  
  
    <a href="#the-travel-insurance-oracle-problem" class="anchor-heading" aria-labelledby="the-travel-insurance-oracle-problem"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The Travel Insurance Oracle Problem
  
  
</h3>
    

<p>Parametric travel insurance pays out automatically when specific conditions are met (e.g., flight delay &gt; 3 hours, weather event at destination, lost baggage &gt; 24 hours). Currently, insurers rely on proprietary, siloed data sources to trigger payouts, creating vendor lock-in and limiting data source options.</p>

<p><strong>Industry Context:</strong></p>
<ul>
  <li><strong>Market Size</strong>: Travel insurance market projected to reach $50+ billion by 2030</li>
  <li><strong>Active Players</strong>: Chubb Travel Pro, Allianz Travel, AXA Travel Insurance</li>
  <li><strong>Current Challenge</strong>: Each insurer builds custom API integrations for each data provider (airlines, weather services, baggage systems)</li>
  <li><strong>The Gap</strong>: No standardized way to accept travel disruption data from multiple certified providers (airlines, weather services, IATA)</li>
  <li><strong>Trust Issue</strong>: Need cryptographic proof that data used for automatic payout is authentic and hasn’t been tampered with</li>
</ul>

<p><strong>Why This Matters:</strong></p>
<ol>
  <li><strong>Standardization</strong>: Accept travel data from any certified provider without custom integrations</li>
  <li><strong>Trust</strong>: Cryptographic proof prevents fraud and data manipulation</li>
  <li><strong>Multi-Provider</strong>: Enable competition and redundancy in data sources</li>
  <li><strong>Automation</strong>: Enable automatic payouts based on verifiable travel data</li>
  <li><strong>Cost Reduction</strong>: Eliminate custom API integrations for each provider</li>
  <li><strong>Transparency</strong>: Verifiable data lineage for regulatory compliance</li>
</ol>
<h3 id="real-world-examples">
  
  
    <a href="#real-world-examples" class="anchor-heading" aria-labelledby="real-world-examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Real-World Examples
  
  
</h3>
    

<p><strong>Chubb Travel Pro</strong> - Digital travel protection:</p>
<ul>
  <li>Provides automatic payouts for flight delays, weather disruptions, and baggage issues</li>
  <li>Currently relies on proprietary data integrations</li>
  <li><strong>Solution</strong>: Adopting VC pattern allows accepting data from any certified provider (airlines, IATA, weather services) without custom API integrations</li>
</ul>

<p><strong>Allianz Travel Insurance</strong> - Global travel insurance:</p>
<ul>
  <li>Uses flight delay data and weather data for automatic claims</li>
  <li>Claims processing relies on trusted data sources</li>
  <li><strong>Solution</strong>: Wrapping travel disruption data in VCs ensures data used for automatic payout is authentic and prevents fraud</li>
</ul>
<h2 id="value-proposition">
  
  
    <a href="#value-proposition" class="anchor-heading" aria-labelledby="value-proposition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Value Proposition
  
  
</h2>
    
<h3 id="problems-solved">
  
  
    <a href="#problems-solved" class="anchor-heading" aria-labelledby="problems-solved"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Problems Solved
  
  
</h3>
    

<ol>
  <li><strong>Oracle Standardization</strong>: Standard format for travel disruption data from any provider</li>
  <li><strong>Multi-Provider Support</strong>: Accept data from airlines, IATA, weather services, baggage systems without custom integrations</li>
  <li><strong>Data Integrity</strong>: Cryptographic proof prevents tampering and fraud</li>
  <li><strong>Automated Triggers</strong>: Enable automatic insurance payouts based on verifiable travel data</li>
  <li><strong>Regulatory Compliance</strong>: Verifiable data lineage for audit trails</li>
  <li><strong>Cost Reduction</strong>: Eliminate custom API integrations</li>
  <li><strong>Trust</strong>: Build trust in travel insurance through verifiable data</li>
</ol>
<h3 id="business-benefits">
  
  
    <a href="#business-benefits" class="anchor-heading" aria-labelledby="business-benefits"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Business Benefits
  
  
</h3>
    

<p><strong>For Insurance Companies:</strong></p>
<ul>
  <li><strong>Cost Reduction</strong>: No custom integrations needed for each data provider</li>
  <li><strong>Flexibility</strong>: Switch between data providers easily</li>
  <li><strong>Trust</strong>: Cryptographic proof of data integrity</li>
  <li><strong>Compliance</strong>: Automated audit trails</li>
  <li><strong>Competition</strong>: Enable multiple data providers to compete</li>
</ul>

<p><strong>For Travel Data Providers (Airlines, Weather Services, IATA):</strong></p>
<ul>
  <li><strong>Standardization</strong>: One format works for all insurers</li>
  <li><strong>Market Access</strong>: Reach all insurance companies with standard format</li>
  <li><strong>Trust</strong>: Build trust through verifiable credentials</li>
  <li><strong>Differentiation</strong>: Stand out with verifiable data quality</li>
</ul>

<p><strong>For Travelers:</strong></p>
<ul>
  <li><strong>Transparency</strong>: Verify data used for payouts</li>
  <li><strong>Fairness</strong>: Standardized data prevents manipulation</li>
  <li><strong>Speed</strong>: Faster payouts with automated triggers</li>
  <li><strong>Trust</strong>: Cryptographic proof of data integrity</li>
  <li><strong>Convenience</strong>: Automatic claims without paperwork</li>
</ul>
<h2 id="understanding-the-problem">
  
  
    <a href="#understanding-the-problem" class="anchor-heading" aria-labelledby="understanding-the-problem"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Understanding the Problem
  
  
</h2>
    

<p>Travel parametric insurance needs:</p>

<ol>
  <li><strong>Standardized Data Format</strong>: Accept travel disruption data from any provider</li>
  <li><strong>Data Integrity</strong>: Verify data hasn’t been tampered with</li>
  <li><strong>Multi-Provider Support</strong>: Work with airlines, IATA, weather services, baggage systems</li>
  <li><strong>Automated Triggers</strong>: Enable automatic payouts</li>
  <li><strong>Audit Trails</strong>: Complete data lineage for compliance</li>
  <li><strong>Trust</strong>: Cryptographic proof of data authenticity</li>
</ol>
<h2 id="prerequisites">
  
  
    <a href="#prerequisites" class="anchor-heading" aria-labelledby="prerequisites"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prerequisites
  
  
</h2>
    

<ul>
  <li>Java 21+</li>
  <li>Kotlin 2.2.0+</li>
  <li>Gradle 8.5+</li>
  <li>Basic understanding of Kotlin and coroutines</li>
  <li>Understanding of parametric insurance concepts</li>
</ul>
<h2 id="step-1-add-dependencies">
  
  
    <a href="#step-1-add-dependencies" class="anchor-heading" aria-labelledby="step-1-add-dependencies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 1: Add Dependencies
  
  
</h2>
    

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="nf">dependencies</span> <span class="p">{</span>
    <span class="c1">// Core TrustWeave modules</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"org.trustweave:trustweave-all:1.0.0-SNAPSHOT"</span><span class="p">)</span>

    <span class="c1">// Test kit for in-memory implementations</span>
    <span class="nf">testImplementation</span><span class="p">(</span><span class="s">"org.trustweave:trustweave-testkit:1.0.0-SNAPSHOT"</span><span class="p">)</span>

    <span class="c1">// Optional: Algorand adapter for real blockchain anchoring</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"org.trustweave.chains:algorand:1.0.0-SNAPSHOT"</span><span class="p">)</span>

    <span class="c1">// Kotlinx Serialization</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"org.jetbrains.kotlinx:kotlinx-serialization-json:1.6.0"</span><span class="p">)</span>

    <span class="c1">// Coroutines</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3"</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-2-complete-runnable-example">
  
  
    <a href="#step-2-complete-runnable-example" class="anchor-heading" aria-labelledby="step-2-complete-runnable-example"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 2: Complete Runnable Example
  
  
</h2>
    

<p>Here’s a complete travel parametric insurance workflow covering flight delays, weather guarantees, and baggage tracking:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
</pre></td><td class="rouge-code"><pre><span class="k">package</span> <span class="nn">com.example.travel.insurance</span>

<span class="k">import</span> <span class="nn">org.trustweave.TrustWeave</span>
<span class="k">import</span> <span class="nn">org.trustweave.core.*</span>
<span class="k">import</span> <span class="nn">org.trustweave.json.DigestUtils</span>
<span class="k">import</span> <span class="nn">kotlinx.coroutines.runBlocking</span>
<span class="k">import</span> <span class="nn">kotlinx.serialization.json.buildJsonObject</span>
<span class="k">import</span> <span class="nn">kotlinx.serialization.json.put</span>
<span class="k">import</span> <span class="nn">java.time.Instant</span>
<span class="k">import</span> <span class="nn">java.time.Duration</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">=</span> <span class="nf">runBlocking</span> <span class="p">{</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"="</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Parametric Travel Insurance - Complete Example"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"="</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>

    <span class="c1">// Step 1: Create TrustWeave instance</span>
    <span class="kd">val</span> <span class="py">trustWeave</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">build</span> <span class="p">{</span>
        <span class="nf">factories</span><span class="p">(</span>
            <span class="n">kmsFactory</span> <span class="p">=</span> <span class="nc">TestkitKmsFactory</span><span class="p">(),</span>
            <span class="n">didMethodFactory</span> <span class="p">=</span> <span class="nc">TestkitDidMethodFactory</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="nf">keys</span> <span class="p">{</span> <span class="nf">provider</span><span class="p">(</span><span class="s">"inMemory"</span><span class="p">);</span> <span class="nf">algorithm</span><span class="p">(</span><span class="s">"Ed25519"</span><span class="p">)</span> <span class="p">}</span>
        <span class="nf">did</span> <span class="p">{</span> <span class="nf">method</span><span class="p">(</span><span class="s">"key"</span><span class="p">)</span> <span class="p">{</span> <span class="nf">algorithm</span><span class="p">(</span><span class="s">"Ed25519"</span><span class="p">)</span> <span class="p">}</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n✅ TrustWeave initialized"</span><span class="p">)</span>

    <span class="c1">// Step 2: Create DIDs for insurance company, airline, weather service, and baggage system</span>
    <span class="k">import</span> <span class="nn">org.trustweave.trust.types.DidCreationResult</span>
    <span class="k">import</span> <span class="nn">org.trustweave.trust.types.DidResolutionResult</span>
    <span class="k">import</span> <span class="nn">org.trustweave.trust.types.IssuanceResult</span>
    <span class="k">import</span> <span class="nn">org.trustweave.trust.types.VerificationResult</span>
    
    <span class="kd">val</span> <span class="py">insuranceDidResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">createDid</span> <span class="p">{</span> <span class="nf">method</span><span class="p">(</span><span class="s">"key"</span><span class="p">)</span> <span class="p">}</span>
    <span class="kd">val</span> <span class="py">insuranceDid</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">insuranceDidResult</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">DidCreationResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">insuranceDidResult</span><span class="p">.</span><span class="n">did</span>
        <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to create insurance DID"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">val</span> <span class="py">airlineDidResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">createDid</span> <span class="p">{</span> <span class="nf">method</span><span class="p">(</span><span class="s">"key"</span><span class="p">)</span> <span class="p">}</span>
    <span class="kd">val</span> <span class="py">airlineDid</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">airlineDidResult</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">DidCreationResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">airlineDidResult</span><span class="p">.</span><span class="n">did</span>
        <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to create airline DID"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">val</span> <span class="py">weatherServiceDidResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">createDid</span> <span class="p">{</span> <span class="nf">method</span><span class="p">(</span><span class="s">"key"</span><span class="p">)</span> <span class="p">}</span>
    <span class="kd">val</span> <span class="py">weatherServiceDid</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">weatherServiceDidResult</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">DidCreationResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">weatherServiceDidResult</span><span class="p">.</span><span class="n">did</span>
        <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to create weather service DID"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">val</span> <span class="py">baggageSystemDidResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">createDid</span> <span class="p">{</span> <span class="nf">method</span><span class="p">(</span><span class="s">"key"</span><span class="p">)</span> <span class="p">}</span>
    <span class="kd">val</span> <span class="py">baggageSystemDid</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">baggageSystemDidResult</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">DidCreationResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">baggageSystemDidResult</span><span class="p">.</span><span class="n">did</span>
        <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to create baggage system DID"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Insurance Company DID: ${insuranceDid.value}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Airline DID: ${airlineDid.value}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Weather Service DID: ${weatherServiceDid.value}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Baggage System DID: ${baggageSystemDid.value}"</span><span class="p">)</span>

    <span class="c1">// ============================================</span>
    <span class="c1">// Scenario 1: Flight Delay Automatic Payout</span>
    <span class="c1">// ============================================</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n"</span> <span class="p">+</span> <span class="s">"-"</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Scenario 1: Flight Delay Automatic Payout"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"-"</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>

    <span class="kd">val</span> <span class="py">airlineResolution</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">resolveDid</span><span class="p">(</span><span class="n">airlineDid</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">airlineDoc</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">airlineResolution</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">DidResolutionResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">airlineResolution</span><span class="p">.</span><span class="n">document</span>
        <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to resolve airline DID"</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="kd">val</span> <span class="py">airlineKeyId</span> <span class="p">=</span> <span class="n">airlineDoc</span><span class="p">.</span><span class="n">verificationMethod</span><span class="p">.</span><span class="nf">firstOrNull</span><span class="p">()</span><span class="o">?.</span><span class="n">id</span><span class="o">?.</span><span class="nf">substringAfter</span><span class="p">(</span><span class="s">"#"</span><span class="p">)</span>
        <span class="o">?:</span> <span class="nf">error</span><span class="p">(</span><span class="s">"No verification method found"</span><span class="p">)</span>

    <span class="c1">// Create flight delay data (issued by airline)</span>
    <span class="kd">val</span> <span class="py">flightDelayData</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
        <span class="s">"id"</span> <span class="n">to</span> <span class="s">"flight-delay-AA1234-2024-10-08"</span>
        <span class="s">"type"</span> <span class="n">to</span> <span class="s">"FlightDelay"</span>
        <span class="s">"flight"</span> <span class="p">{</span>
            <span class="s">"flightNumber"</span> <span class="n">to</span> <span class="s">"AA1234"</span>
            <span class="s">"departure"</span> <span class="p">{</span>
                <span class="s">"airport"</span> <span class="n">to</span> <span class="s">"JFK"</span>
                <span class="s">"scheduled"</span> <span class="n">to</span> <span class="s">"2024-10-08T14:00:00Z"</span>
                <span class="s">"actual"</span> <span class="n">to</span> <span class="s">"2024-10-08T17:30:00Z"</span>
            <span class="p">}</span>
            <span class="s">"arrival"</span> <span class="p">{</span>
                <span class="s">"airport"</span> <span class="n">to</span> <span class="s">"LHR"</span>
                <span class="s">"scheduled"</span> <span class="n">to</span> <span class="s">"2024-10-08T23:00:00Z"</span>
            <span class="p">}</span>
            <span class="s">"aircraft"</span> <span class="n">to</span> <span class="s">"Boeing 777-300ER"</span>
        <span class="p">}</span>
        <span class="s">"delay"</span> <span class="p">{</span>
            <span class="s">"durationMinutes"</span> <span class="n">to</span> <span class="mi">210</span>  <span class="c1">// 3.5 hours delay</span>
            <span class="s">"reason"</span> <span class="n">to</span> <span class="s">"Weather"</span>
            <span class="s">"timestamp"</span> <span class="n">to</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">val</span> <span class="py">delayDigest</span> <span class="p">=</span> <span class="nc">DigestUtils</span><span class="p">.</span><span class="nf">sha256DigestMultibase</span><span class="p">(</span><span class="n">flightDelayData</span><span class="p">)</span>

    <span class="c1">// Airline issues verifiable credential for flight delay</span>
    <span class="kd">val</span> <span class="py">flightDelayIssuanceResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">issue</span> <span class="p">{</span>
        <span class="nf">credential</span> <span class="p">{</span>
            <span class="nf">id</span><span class="p">(</span><span class="s">"flight-delay-AA1234-2024-10-08"</span><span class="p">)</span>
            <span class="nf">type</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"FlightDelayCredential"</span><span class="p">,</span> <span class="s">"TravelOracleCredential"</span><span class="p">)</span>
            <span class="nf">issuer</span><span class="p">(</span><span class="n">airlineDid</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
            <span class="nf">subject</span> <span class="p">{</span>
                <span class="nf">id</span><span class="p">(</span><span class="s">"flight-delay-AA1234-2024-10-08"</span><span class="p">)</span>
                <span class="s">"dataType"</span> <span class="n">to</span> <span class="s">"FlightDelay"</span>
                <span class="s">"data"</span> <span class="n">to</span> <span class="n">flightDelayData</span>
                <span class="s">"dataDigest"</span> <span class="n">to</span> <span class="n">delayDigest</span>
                <span class="s">"provider"</span> <span class="n">to</span> <span class="n">airlineDid</span><span class="p">.</span><span class="n">value</span>
                <span class="s">"timestamp"</span> <span class="n">to</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">by</span><span class="p">(</span><span class="n">issuerDid</span> <span class="p">=</span> <span class="n">airlineDid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">keyId</span> <span class="p">=</span> <span class="n">airlineKeyId</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">val</span> <span class="py">flightDelayCredential</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">flightDelayIssuanceResult</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">IssuanceResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">flightDelayIssuanceResult</span><span class="p">.</span><span class="n">credential</span>
        <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to issue flight delay credential"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Flight Delay Credential issued: ${flightDelayCredential.id}"</span><span class="p">)</span>

    <span class="c1">// Verify credential</span>
    <span class="kd">val</span> <span class="py">delayVerificationResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">verify</span> <span class="p">{</span>
        <span class="nf">credential</span><span class="p">(</span><span class="n">flightDelayCredential</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="k">when</span> <span class="p">(</span><span class="n">delayVerificationResult</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">VerificationResult</span><span class="p">.</span><span class="nc">Valid</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Flight Delay Credential verified"</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="nc">VerificationResult</span><span class="p">.</span><span class="nc">Invalid</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Flight delay credential invalid"</span><span class="p">)</span>
            <span class="k">return</span><span class="nd">@runBlocking</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Check parametric trigger (policy: payout if delay &gt; 3 hours)</span>
    <span class="kd">val</span> <span class="py">delayMinutes</span> <span class="p">=</span> <span class="n">flightDelayData</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">[</span><span class="s">"delay"</span><span class="p">]</span>
        <span class="o">?.</span><span class="n">jsonObject</span><span class="o">?.</span><span class="k">get</span><span class="p">(</span><span class="s">"durationMinutes"</span><span class="p">)</span>
        <span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span><span class="o">?.</span><span class="nf">toInt</span><span class="p">()</span> <span class="o">?:</span> <span class="mi">0</span>

    <span class="kd">val</span> <span class="py">delayThresholdMinutes</span> <span class="p">=</span> <span class="mi">180</span>  <span class="c1">// 3 hours</span>
    <span class="kd">val</span> <span class="py">shouldPayoutDelay</span> <span class="p">=</span> <span class="n">delayMinutes</span> <span class="p">&gt;</span> <span class="n">delayThresholdMinutes</span>

    <span class="nf">println</span><span class="p">(</span><span class="s">"\n📊 Flight Delay Trigger Check:"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Delay: $delayMinutes minutes (${delayMinutes / 60.0} hours)"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Threshold: $delayThresholdMinutes minutes"</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">shouldPayoutDelay</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   ✅ TRIGGER MET: Delay exceeds threshold"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   💰 Automatic payout should be triggered"</span><span class="p">)</span>

        <span class="kd">val</span> <span class="py">insuranceResolution</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">resolveDid</span><span class="p">(</span><span class="n">insuranceDid</span><span class="p">)</span>
        <span class="kd">val</span> <span class="py">insuranceDoc</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">insuranceResolution</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">is</span> <span class="nc">DidResolutionResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">insuranceResolution</span><span class="p">.</span><span class="n">document</span>
            <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to resolve insurance DID"</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="kd">val</span> <span class="py">insuranceKeyId</span> <span class="p">=</span> <span class="n">insuranceDoc</span><span class="p">.</span><span class="n">verificationMethod</span><span class="p">.</span><span class="nf">firstOrNull</span><span class="p">()</span><span class="o">?.</span><span class="n">id</span><span class="o">?.</span><span class="nf">substringAfter</span><span class="p">(</span><span class="s">"#"</span><span class="p">)</span>
            <span class="o">?:</span> <span class="nf">error</span><span class="p">(</span><span class="s">"No verification method found"</span><span class="p">)</span>

        <span class="kd">val</span> <span class="py">delayPayoutIssuanceResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">issue</span> <span class="p">{</span>
            <span class="nf">credential</span> <span class="p">{</span>
                <span class="nf">id</span><span class="p">(</span><span class="s">"payout-delay-AA1234-2024-10-08"</span><span class="p">)</span>
                <span class="nf">type</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"TravelInsurancePayoutCredential"</span><span class="p">)</span>
                <span class="nf">issuer</span><span class="p">(</span><span class="n">insuranceDid</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
                <span class="nf">subject</span> <span class="p">{</span>
                    <span class="nf">id</span><span class="p">(</span><span class="s">"payout-delay-AA1234-2024-10-08"</span><span class="p">)</span>
                    <span class="s">"policyId"</span> <span class="n">to</span> <span class="s">"TRAVEL-POL-12345"</span>
                    <span class="s">"triggerType"</span> <span class="n">to</span> <span class="s">"FlightDelay"</span>
                    <span class="s">"delayMinutes"</span> <span class="n">to</span> <span class="n">delayMinutes</span>
                    <span class="s">"thresholdMinutes"</span> <span class="n">to</span> <span class="n">delayThresholdMinutes</span>
                    <span class="s">"dataCredentialId"</span> <span class="n">to</span> <span class="n">flightDelayCredential</span><span class="p">.</span><span class="n">id</span>
                    <span class="s">"payoutAmount"</span> <span class="n">to</span> <span class="mf">250.0</span>
                    <span class="s">"currency"</span> <span class="n">to</span> <span class="s">"USD"</span>
                    <span class="s">"payoutMethod"</span> <span class="n">to</span> <span class="s">"virtual-card"</span>
                    <span class="s">"timestamp"</span> <span class="n">to</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">by</span><span class="p">(</span><span class="n">issuerDid</span> <span class="p">=</span> <span class="n">insuranceDid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">keyId</span> <span class="p">=</span> <span class="n">insuranceKeyId</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="kd">val</span> <span class="py">delayPayoutCredential</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">delayPayoutIssuanceResult</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">is</span> <span class="nc">IssuanceResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">delayPayoutIssuanceResult</span><span class="p">.</span><span class="n">credential</span>
            <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to issue delay payout credential"</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Delay Payout Credential issued: ${delayPayoutCredential.id}"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Payout amount: $250 USD via virtual card"</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   ❌ TRIGGER NOT MET: Delay below threshold"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// ============================================</span>
    <span class="c1">// Scenario 2: Weather Guarantee Automatic Payout</span>
    <span class="c1">// ============================================</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n"</span> <span class="p">+</span> <span class="s">"-"</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Scenario 2: Weather Guarantee Automatic Payout"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"-"</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>

    <span class="kd">val</span> <span class="py">weatherResolution</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">resolveDid</span><span class="p">(</span><span class="n">weatherServiceDid</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">weatherDoc</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">weatherResolution</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">DidResolutionResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">weatherResolution</span><span class="p">.</span><span class="n">document</span>
        <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to resolve weather service DID"</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="kd">val</span> <span class="py">weatherKeyId</span> <span class="p">=</span> <span class="n">weatherDoc</span><span class="p">.</span><span class="n">verificationMethod</span><span class="p">.</span><span class="nf">firstOrNull</span><span class="p">()</span><span class="o">?.</span><span class="n">id</span><span class="o">?.</span><span class="nf">substringAfter</span><span class="p">(</span><span class="s">"#"</span><span class="p">)</span>
        <span class="o">?:</span> <span class="nf">error</span><span class="p">(</span><span class="s">"No verification method found"</span><span class="p">)</span>

    <span class="c1">// Create weather event data (issued by weather service)</span>
    <span class="kd">val</span> <span class="py">weatherData</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="s">"weather-event-LHR-2024-10-08"</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"type"</span><span class="p">,</span> <span class="s">"WeatherEvent"</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"location"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"airport"</span><span class="p">,</span> <span class="s">"LHR"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"city"</span><span class="p">,</span> <span class="s">"London"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"country"</span><span class="p">,</span> <span class="s">"UK"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"coordinates"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"latitude"</span><span class="p">,</span> <span class="mf">51.4700</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"longitude"</span><span class="p">,</span> <span class="p">-</span><span class="mf">0.4543</span><span class="p">)</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"event"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"type"</span><span class="p">,</span> <span class="s">"Severe Storm"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"severity"</span><span class="p">,</span> <span class="s">"High"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"description"</span><span class="p">,</span> <span class="s">"Thunderstorms with heavy rain and strong winds"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"startTime"</span><span class="p">,</span> <span class="s">"2024-10-08T12:00:00Z"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"endTime"</span><span class="p">,</span> <span class="s">"2024-10-08T18:00:00Z"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"windSpeed"</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>  <span class="c1">// mph</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"visibility"</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>  <span class="c1">// miles</span>
        <span class="p">})</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"impact"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"travelDisruption"</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"flightsCancelled"</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"flightsDelayed"</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"timestamp"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
        <span class="p">})</span>
    <span class="p">}</span>

    <span class="kd">val</span> <span class="py">weatherDigest</span> <span class="p">=</span> <span class="nc">DigestUtils</span><span class="p">.</span><span class="nf">sha256DigestMultibase</span><span class="p">(</span><span class="n">weatherData</span><span class="p">)</span>

    <span class="c1">// Weather service issues verifiable credential</span>
    <span class="kd">val</span> <span class="py">weatherIssuanceResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">issue</span> <span class="p">{</span>
        <span class="nf">credential</span> <span class="p">{</span>
            <span class="nf">id</span><span class="p">(</span><span class="s">"weather-event-LHR-2024-10-08"</span><span class="p">)</span>
            <span class="nf">type</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"WeatherEventCredential"</span><span class="p">,</span> <span class="s">"TravelOracleCredential"</span><span class="p">)</span>
            <span class="nf">issuer</span><span class="p">(</span><span class="n">weatherServiceDid</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
            <span class="nf">subject</span> <span class="p">{</span>
                <span class="nf">id</span><span class="p">(</span><span class="s">"weather-event-LHR-2024-10-08"</span><span class="p">)</span>
                <span class="s">"dataType"</span> <span class="n">to</span> <span class="s">"WeatherEvent"</span>
                <span class="s">"data"</span> <span class="n">to</span> <span class="n">weatherData</span>
                <span class="s">"dataDigest"</span> <span class="n">to</span> <span class="n">weatherDigest</span>
                <span class="s">"provider"</span> <span class="n">to</span> <span class="n">weatherServiceDid</span><span class="p">.</span><span class="n">value</span>
                <span class="s">"timestamp"</span> <span class="n">to</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">by</span><span class="p">(</span><span class="n">issuerDid</span> <span class="p">=</span> <span class="n">weatherServiceDid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">keyId</span> <span class="p">=</span> <span class="n">weatherKeyId</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">val</span> <span class="py">weatherCredential</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">weatherIssuanceResult</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">IssuanceResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">weatherIssuanceResult</span><span class="p">.</span><span class="n">credential</span>
        <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to issue weather credential"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Weather Event Credential issued: ${weatherCredential.id}"</span><span class="p">)</span>

    <span class="c1">// Verify credential</span>
    <span class="kd">val</span> <span class="py">weatherVerificationResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">verify</span> <span class="p">{</span>
        <span class="nf">credential</span><span class="p">(</span><span class="n">weatherCredential</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="k">when</span> <span class="p">(</span><span class="n">weatherVerificationResult</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">VerificationResult</span><span class="p">.</span><span class="nc">Valid</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Weather Event Credential verified"</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="nc">VerificationResult</span><span class="p">.</span><span class="nc">Invalid</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Weather credential invalid"</span><span class="p">)</span>
            <span class="k">return</span><span class="nd">@runBlocking</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Check parametric trigger (policy: payout for severe weather at destination)</span>
    <span class="kd">val</span> <span class="py">isSevereWeather</span> <span class="p">=</span> <span class="n">weatherData</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">[</span><span class="s">"event"</span><span class="p">]</span>
        <span class="o">?.</span><span class="n">jsonObject</span><span class="o">?.</span><span class="k">get</span><span class="p">(</span><span class="s">"severity"</span><span class="p">)</span>
        <span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span> <span class="p">==</span> <span class="s">"High"</span>

    <span class="kd">val</span> <span class="py">causesTravelDisruption</span> <span class="p">=</span> <span class="n">weatherData</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">[</span><span class="s">"impact"</span><span class="p">]</span>
        <span class="o">?.</span><span class="n">jsonObject</span><span class="o">?.</span><span class="k">get</span><span class="p">(</span><span class="s">"travelDisruption"</span><span class="p">)</span>
        <span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span><span class="o">?.</span><span class="nf">toBoolean</span><span class="p">()</span> <span class="p">==</span> <span class="k">true</span>

    <span class="kd">val</span> <span class="py">shouldPayoutWeather</span> <span class="p">=</span> <span class="n">isSevereWeather</span> <span class="p">&amp;&amp;</span> <span class="n">causesTravelDisruption</span>

    <span class="nf">println</span><span class="p">(</span><span class="s">"\n📊 Weather Guarantee Trigger Check:"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Severity: High"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Travel Disruption: $causesTravelDisruption"</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">shouldPayoutWeather</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   ✅ TRIGGER MET: Severe weather causes travel disruption"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   💰 Automatic payout should be triggered"</span><span class="p">)</span>

        <span class="kd">val</span> <span class="py">weatherPayoutIssuanceResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">issue</span> <span class="p">{</span>
            <span class="nf">credential</span> <span class="p">{</span>
                <span class="nf">id</span><span class="p">(</span><span class="s">"payout-weather-LHR-2024-10-08"</span><span class="p">)</span>
                <span class="nf">type</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"TravelInsurancePayoutCredential"</span><span class="p">)</span>
                <span class="nf">issuer</span><span class="p">(</span><span class="n">insuranceDid</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
                <span class="nf">subject</span> <span class="p">{</span>
                    <span class="nf">id</span><span class="p">(</span><span class="s">"payout-weather-LHR-2024-10-08"</span><span class="p">)</span>
                    <span class="s">"policyId"</span> <span class="n">to</span> <span class="s">"TRAVEL-POL-12345"</span>
                    <span class="s">"triggerType"</span> <span class="n">to</span> <span class="s">"WeatherGuarantee"</span>
                    <span class="s">"location"</span> <span class="n">to</span> <span class="s">"LHR"</span>
                    <span class="s">"severity"</span> <span class="n">to</span> <span class="s">"High"</span>
                    <span class="s">"dataCredentialId"</span> <span class="n">to</span> <span class="n">weatherCredential</span><span class="p">.</span><span class="n">id</span>
                    <span class="s">"payoutAmount"</span> <span class="n">to</span> <span class="mf">500.0</span>
                    <span class="s">"currency"</span> <span class="n">to</span> <span class="s">"USD"</span>
                    <span class="s">"payoutMethod"</span> <span class="n">to</span> <span class="s">"airline-miles"</span>
                    <span class="s">"timestamp"</span> <span class="n">to</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">by</span><span class="p">(</span><span class="n">issuerDid</span> <span class="p">=</span> <span class="n">insuranceDid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">keyId</span> <span class="p">=</span> <span class="n">insuranceKeyId</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="kd">val</span> <span class="py">weatherPayoutCredential</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">weatherPayoutIssuanceResult</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">is</span> <span class="nc">IssuanceResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">weatherPayoutIssuanceResult</span><span class="p">.</span><span class="n">credential</span>
            <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to issue weather payout credential"</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Weather Payout Credential issued: ${weatherPayoutCredential.id}"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Payout amount: $500 USD in airline miles"</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   ❌ TRIGGER NOT MET: Weather conditions don't meet criteria"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// ============================================</span>
    <span class="c1">// Scenario 3: Baggage Delay Automatic Payout</span>
    <span class="c1">// ============================================</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n"</span> <span class="p">+</span> <span class="s">"-"</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Scenario 3: Baggage Delay Automatic Payout"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"-"</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>

    <span class="kd">val</span> <span class="py">baggageResolution</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">resolveDid</span><span class="p">(</span><span class="n">baggageSystemDid</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">baggageDoc</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">baggageResolution</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">DidResolutionResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">baggageResolution</span><span class="p">.</span><span class="n">document</span>
        <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to resolve baggage system DID"</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="kd">val</span> <span class="py">baggageKeyId</span> <span class="p">=</span> <span class="n">baggageDoc</span><span class="p">.</span><span class="n">verificationMethod</span><span class="p">.</span><span class="nf">firstOrNull</span><span class="p">()</span><span class="o">?.</span><span class="n">id</span><span class="o">?.</span><span class="nf">substringAfter</span><span class="p">(</span><span class="s">"#"</span><span class="p">)</span>
        <span class="o">?:</span> <span class="nf">error</span><span class="p">(</span><span class="s">"No verification method found"</span><span class="p">)</span>

    <span class="c1">// Create baggage delay data (issued by baggage tracking system)</span>
    <span class="kd">val</span> <span class="py">baggageData</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="s">"baggage-delay-ABC123-2024-10-08"</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"type"</span><span class="p">,</span> <span class="s">"BaggageDelay"</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"baggage"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"tagNumber"</span><span class="p">,</span> <span class="s">"ABC123"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"flightNumber"</span><span class="p">,</span> <span class="s">"AA1234"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"destination"</span><span class="p">,</span> <span class="s">"LHR"</span><span class="p">)</span>
        <span class="p">})</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span> <span class="s">"Delayed"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"location"</span><span class="p">,</span> <span class="s">"JFK"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"lastSeen"</span><span class="p">,</span> <span class="s">"2024-10-08T14:00:00Z"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"currentTime"</span><span class="p">,</span> <span class="s">"2024-10-09T15:00:00Z"</span><span class="p">)</span>  <span class="c1">// 25 hours later</span>
        <span class="p">})</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"delay"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"durationHours"</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"estimatedArrival"</span><span class="p">,</span> <span class="s">"2024-10-09T20:00:00Z"</span><span class="p">)</span>
        <span class="p">})</span>
    <span class="p">}</span>

    <span class="kd">val</span> <span class="py">baggageDigest</span> <span class="p">=</span> <span class="nc">DigestUtils</span><span class="p">.</span><span class="nf">sha256DigestMultibase</span><span class="p">(</span><span class="n">baggageData</span><span class="p">)</span>

    <span class="c1">// Baggage system issues verifiable credential</span>
    <span class="kd">val</span> <span class="py">baggageIssuanceResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">issue</span> <span class="p">{</span>
        <span class="nf">credential</span> <span class="p">{</span>
            <span class="nf">id</span><span class="p">(</span><span class="s">"baggage-delay-ABC123-2024-10-08"</span><span class="p">)</span>
            <span class="nf">type</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"BaggageDelayCredential"</span><span class="p">,</span> <span class="s">"TravelOracleCredential"</span><span class="p">)</span>
            <span class="nf">issuer</span><span class="p">(</span><span class="n">baggageSystemDid</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
            <span class="nf">subject</span> <span class="p">{</span>
                <span class="nf">id</span><span class="p">(</span><span class="s">"baggage-delay-ABC123-2024-10-08"</span><span class="p">)</span>
                <span class="s">"dataType"</span> <span class="n">to</span> <span class="s">"BaggageDelay"</span>
                <span class="s">"data"</span> <span class="n">to</span> <span class="n">baggageData</span>
                <span class="s">"dataDigest"</span> <span class="n">to</span> <span class="n">baggageDigest</span>
                <span class="s">"provider"</span> <span class="n">to</span> <span class="n">baggageSystemDid</span><span class="p">.</span><span class="n">value</span>
                <span class="s">"timestamp"</span> <span class="n">to</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">by</span><span class="p">(</span><span class="n">issuerDid</span> <span class="p">=</span> <span class="n">baggageSystemDid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">keyId</span> <span class="p">=</span> <span class="n">baggageKeyId</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">val</span> <span class="py">baggageCredential</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">baggageIssuanceResult</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">IssuanceResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">baggageIssuanceResult</span><span class="p">.</span><span class="n">credential</span>
        <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to issue baggage credential"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Baggage Delay Credential issued: ${baggageCredential.id}"</span><span class="p">)</span>

    <span class="c1">// Verify credential</span>
    <span class="kd">val</span> <span class="py">baggageVerificationResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">verify</span> <span class="p">{</span>
        <span class="nf">credential</span><span class="p">(</span><span class="n">baggageCredential</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="k">when</span> <span class="p">(</span><span class="n">baggageVerificationResult</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">VerificationResult</span><span class="p">.</span><span class="nc">Valid</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Baggage Delay Credential verified"</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="nc">VerificationResult</span><span class="p">.</span><span class="nc">Invalid</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Baggage credential invalid"</span><span class="p">)</span>
            <span class="k">return</span><span class="nd">@runBlocking</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Check parametric trigger (policy: payout if baggage delayed &gt; 24 hours)</span>
    <span class="kd">val</span> <span class="py">delayHours</span> <span class="p">=</span> <span class="n">baggageData</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">[</span><span class="s">"delay"</span><span class="p">]</span>
        <span class="o">?.</span><span class="n">jsonObject</span><span class="o">?.</span><span class="k">get</span><span class="p">(</span><span class="s">"durationHours"</span><span class="p">)</span>
        <span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span><span class="o">?.</span><span class="nf">toInt</span><span class="p">()</span> <span class="o">?:</span> <span class="mi">0</span>

    <span class="kd">val</span> <span class="py">baggageThresholdHours</span> <span class="p">=</span> <span class="mi">24</span>
    <span class="kd">val</span> <span class="py">shouldPayoutBaggage</span> <span class="p">=</span> <span class="n">delayHours</span> <span class="p">&gt;</span> <span class="n">baggageThresholdHours</span>

    <span class="nf">println</span><span class="p">(</span><span class="s">"\n📊 Baggage Delay Trigger Check:"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Delay: $delayHours hours"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Threshold: $baggageThresholdHours hours"</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">shouldPayoutBaggage</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   ✅ TRIGGER MET: Baggage delay exceeds threshold"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   💰 Automatic payout should be triggered"</span><span class="p">)</span>

        <span class="kd">val</span> <span class="py">baggagePayoutIssuanceResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">issue</span> <span class="p">{</span>
            <span class="nf">credential</span> <span class="p">{</span>
                <span class="nf">id</span><span class="p">(</span><span class="s">"payout-baggage-ABC123-2024-10-08"</span><span class="p">)</span>
                <span class="nf">type</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"TravelInsurancePayoutCredential"</span><span class="p">)</span>
                <span class="nf">issuer</span><span class="p">(</span><span class="n">insuranceDid</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
                <span class="nf">subject</span> <span class="p">{</span>
                    <span class="nf">id</span><span class="p">(</span><span class="s">"payout-baggage-ABC123-2024-10-08"</span><span class="p">)</span>
                    <span class="s">"policyId"</span> <span class="n">to</span> <span class="s">"TRAVEL-POL-12345"</span>
                    <span class="s">"triggerType"</span> <span class="n">to</span> <span class="s">"BaggageDelay"</span>
                    <span class="s">"delayHours"</span> <span class="n">to</span> <span class="n">delayHours</span>
                    <span class="s">"thresholdHours"</span> <span class="n">to</span> <span class="n">baggageThresholdHours</span>
                    <span class="s">"dataCredentialId"</span> <span class="n">to</span> <span class="n">baggageCredential</span><span class="p">.</span><span class="n">id</span>
                    <span class="s">"payoutAmount"</span> <span class="n">to</span> <span class="mf">200.0</span>
                    <span class="s">"currency"</span> <span class="n">to</span> <span class="s">"USD"</span>
                    <span class="s">"payoutMethod"</span> <span class="n">to</span> <span class="s">"e-voucher"</span>
                    <span class="s">"timestamp"</span> <span class="n">to</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">by</span><span class="p">(</span><span class="n">issuerDid</span> <span class="p">=</span> <span class="n">insuranceDid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">keyId</span> <span class="p">=</span> <span class="n">insuranceKeyId</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="kd">val</span> <span class="py">baggagePayoutCredential</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">baggagePayoutIssuanceResult</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">is</span> <span class="nc">IssuanceResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">baggagePayoutIssuanceResult</span><span class="p">.</span><span class="n">credential</span>
            <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to issue baggage payout credential"</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Baggage Payout Credential issued: ${baggagePayoutCredential.id}"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Payout amount: $200 USD via e-voucher"</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   ❌ TRIGGER NOT MET: Baggage delay below threshold"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// ============================================</span>
    <span class="c1">// Data Integrity Verification</span>
    <span class="c1">// ============================================</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n"</span> <span class="p">+</span> <span class="s">"-"</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Data Integrity Verification"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"-"</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>

    <span class="c1">// Verify flight delay data integrity</span>
    <span class="kd">val</span> <span class="py">currentDelayDigest</span> <span class="p">=</span> <span class="nc">DigestUtils</span><span class="p">.</span><span class="nf">sha256DigestMultibase</span><span class="p">(</span><span class="n">flightDelayData</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">credentialDelayDigest</span> <span class="p">=</span> <span class="n">flightDelayCredential</span><span class="p">.</span><span class="n">credentialSubject</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">[</span><span class="s">"dataDigest"</span><span class="p">]</span>
        <span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span> <span class="o">?:</span> <span class="s">""</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">currentDelayDigest</span> <span class="p">==</span> <span class="n">credentialDelayDigest</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Flight Delay Data Integrity Verified"</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Flight Delay Data Integrity FAILED"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Verify weather data integrity</span>
    <span class="kd">val</span> <span class="py">currentWeatherDigest</span> <span class="p">=</span> <span class="nc">DigestUtils</span><span class="p">.</span><span class="nf">sha256DigestMultibase</span><span class="p">(</span><span class="n">weatherData</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">credentialWeatherDigest</span> <span class="p">=</span> <span class="n">weatherCredential</span><span class="p">.</span><span class="n">credentialSubject</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">[</span><span class="s">"dataDigest"</span><span class="p">]</span>
        <span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span> <span class="o">?:</span> <span class="s">""</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">currentWeatherDigest</span> <span class="p">==</span> <span class="n">credentialWeatherDigest</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Weather Data Integrity Verified"</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Weather Data Integrity FAILED"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Verify baggage data integrity</span>
    <span class="kd">val</span> <span class="py">currentBaggageDigest</span> <span class="p">=</span> <span class="nc">DigestUtils</span><span class="p">.</span><span class="nf">sha256DigestMultibase</span><span class="p">(</span><span class="n">baggageData</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">credentialBaggageDigest</span> <span class="p">=</span> <span class="n">baggageCredential</span><span class="p">.</span><span class="n">credentialSubject</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">[</span><span class="s">"dataDigest"</span><span class="p">]</span>
        <span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span> <span class="o">?:</span> <span class="s">""</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">currentBaggageDigest</span> <span class="p">==</span> <span class="n">credentialBaggageDigest</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Baggage Data Integrity Verified"</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Baggage Data Integrity FAILED"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nf">println</span><span class="p">(</span><span class="s">"\n"</span> <span class="p">+</span> <span class="s">"="</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Parametric Travel Insurance Scenario Complete!"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"="</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p><strong>Expected Output:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre></td><td class="rouge-code"><pre>======================================================================
Parametric Travel Insurance - Complete Example
======================================================================

✅ TrustWeave initialized
✅ Insurance Company DID: did:key:z6Mk...
✅ Airline DID: did:key:z6Mk...
✅ Weather Service DID: did:key:z6Mk...
✅ Baggage System DID: did:key:z6Mk...

----------------------------------------------------------------------
Scenario 1: Flight Delay Automatic Payout
----------------------------------------------------------------------
✅ Flight Delay Credential issued: urn:uuid:...
✅ Flight Delay Credential verified

📊 Flight Delay Trigger Check:
   Delay: 210 minutes (3.5 hours)
   Threshold: 180 minutes
   ✅ TRIGGER MET: Delay exceeds threshold
   💰 Automatic payout should be triggered
✅ Delay Payout Credential issued: urn:uuid:...
   Payout amount: $250 USD via virtual card

----------------------------------------------------------------------
Scenario 2: Weather Guarantee Automatic Payout
----------------------------------------------------------------------
✅ Weather Event Credential issued: urn:uuid:...
✅ Weather Event Credential verified

📊 Weather Guarantee Trigger Check:
   Severity: High
   Travel Disruption: true
   ✅ TRIGGER MET: Severe weather causes travel disruption
   💰 Automatic payout should be triggered
✅ Weather Payout Credential issued: urn:uuid:...
   Payout amount: $500 USD in airline miles

----------------------------------------------------------------------
Scenario 3: Baggage Delay Automatic Payout
----------------------------------------------------------------------
✅ Baggage Delay Credential issued: urn:uuid:...
✅ Baggage Delay Credential verified

📊 Baggage Delay Trigger Check:
   Delay: 25 hours
   Threshold: 24 hours
   ✅ TRIGGER MET: Baggage delay exceeds threshold
   💰 Automatic payout should be triggered
✅ Baggage Payout Credential issued: urn:uuid:...
   Payout amount: $200 USD via e-voucher

----------------------------------------------------------------------
Data Integrity Verification
----------------------------------------------------------------------
✅ Flight Delay Data Integrity Verified
✅ Weather Data Integrity Verified
✅ Baggage Data Integrity Verified

======================================================================
✅ Parametric Travel Insurance Scenario Complete!
======================================================================
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-3-multi-provider-support">
  
  
    <a href="#step-3-multi-provider-support" class="anchor-heading" aria-labelledby="step-3-multi-provider-support"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 3: Multi-Provider Support
  
  
</h2>
    

<p>The key advantage of using VCs is accepting data from multiple providers:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre><span class="c1">// Accept data from any certified provider</span>
<span class="kd">val</span> <span class="py">providers</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"IATA"</span><span class="p">,</span> <span class="s">"FlightStats"</span><span class="p">,</span> <span class="s">"OpenWeather"</span><span class="p">,</span> <span class="s">"Weather.com"</span><span class="p">,</span> <span class="s">"SITA"</span><span class="p">)</span>

<span class="k">suspend</span> <span class="k">fun</span> <span class="nf">acceptTravelDataFromAnyProvider</span><span class="p">(</span>
    <span class="n">trustWeave</span><span class="p">:</span> <span class="nc">TrustWeave</span><span class="p">,</span>
    <span class="n">providerDid</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">dataCredential</span><span class="p">:</span> <span class="nc">VerifiableCredential</span>
<span class="p">):</span> <span class="nc">Boolean</span> <span class="p">{</span>
    <span class="c1">// Verify credential</span>
    <span class="kd">val</span> <span class="py">verificationResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">verify</span> <span class="p">{</span>
        <span class="nf">credential</span><span class="p">(</span><span class="n">dataCredential</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="k">when</span> <span class="p">(</span><span class="n">verificationResult</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">VerificationResult</span><span class="p">.</span><span class="nc">Valid</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="c1">// Credential is valid, continue</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="nc">VerificationResult</span><span class="p">.</span><span class="nc">Invalid</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">false</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Check if provider is certified</span>
    <span class="kd">val</span> <span class="py">isCertified</span> <span class="p">=</span> <span class="nf">checkProviderCertification</span><span class="p">(</span><span class="n">providerDid</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(!</span><span class="n">isCertified</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span>

    <span class="c1">// Extract and use data</span>
    <span class="kd">val</span> <span class="py">data</span> <span class="p">=</span> <span class="nf">extractDataFromCredential</span><span class="p">(</span><span class="n">dataCredential</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">processDataForInsurance</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-4-medical-emergency-example">
  
  
    <a href="#step-4-medical-emergency-example" class="anchor-heading" aria-labelledby="step-4-medical-emergency-example"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 4: Medical Emergency Example
  
  
</h2>
    

<p>For medical emergency coverage with quick payouts:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre></td><td class="rouge-code"><pre><span class="c1">// Medical service provider issues emergency credential</span>
<span class="kd">val</span> <span class="py">medicalData</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
    <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="s">"medical-emergency-2024-10-08"</span><span class="p">)</span>
    <span class="nf">put</span><span class="p">(</span><span class="s">"type"</span><span class="p">,</span> <span class="s">"MedicalEmergency"</span><span class="p">)</span>
    <span class="nf">put</span><span class="p">(</span><span class="s">"patient"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"policyNumber"</span><span class="p">,</span> <span class="s">"TRAVEL-POL-12345"</span><span class="p">)</span>
        <span class="c1">// No PII - privacy preserving</span>
    <span class="p">})</span>
    <span class="nf">put</span><span class="p">(</span><span class="s">"emergency"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"type"</span><span class="p">,</span> <span class="s">"Medical Treatment"</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"location"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"country"</span><span class="p">,</span> <span class="s">"UK"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"city"</span><span class="p">,</span> <span class="s">"London"</span><span class="p">)</span>
        <span class="p">})</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"timestamp"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"amount"</span><span class="p">,</span> <span class="mf">1500.0</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"currency"</span><span class="p">,</span> <span class="s">"USD"</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">}</span>

<span class="kd">val</span> <span class="py">medicalDigest</span> <span class="p">=</span> <span class="nc">DigestUtils</span><span class="p">.</span><span class="nf">sha256DigestMultibase</span><span class="p">(</span><span class="n">medicalData</span><span class="p">)</span>

<span class="kd">val</span> <span class="py">medicalIssuanceResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">issue</span> <span class="p">{</span>
    <span class="nf">credential</span> <span class="p">{</span>
        <span class="nf">id</span><span class="p">(</span><span class="s">"medical-emergency-2024-10-08"</span><span class="p">)</span>
        <span class="nf">type</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"MedicalEmergencyCredential"</span><span class="p">,</span> <span class="s">"TravelOracleCredential"</span><span class="p">)</span>
        <span class="nf">issuer</span><span class="p">(</span><span class="n">medicalProviderDid</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
        <span class="nf">subject</span> <span class="p">{</span>
            <span class="nf">id</span><span class="p">(</span><span class="s">"medical-emergency-2024-10-08"</span><span class="p">)</span>
            <span class="s">"dataType"</span> <span class="n">to</span> <span class="s">"MedicalEmergency"</span>
            <span class="s">"data"</span> <span class="n">to</span> <span class="n">medicalData</span>
            <span class="s">"dataDigest"</span> <span class="n">to</span> <span class="n">medicalDigest</span>
            <span class="s">"provider"</span> <span class="n">to</span> <span class="n">medicalProviderDid</span><span class="p">.</span><span class="n">value</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">by</span><span class="p">(</span><span class="n">issuerDid</span> <span class="p">=</span> <span class="n">medicalProviderDid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">keyId</span> <span class="p">=</span> <span class="n">medicalKeyId</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">val</span> <span class="py">medicalCredential</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">medicalIssuanceResult</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="nc">IssuanceResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">medicalIssuanceResult</span><span class="p">.</span><span class="n">credential</span>
    <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to issue medical credential"</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Automatic payout for medical emergencies</span>
<span class="kd">val</span> <span class="py">medicalPayoutIssuanceResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">issue</span> <span class="p">{</span>
    <span class="nf">credential</span> <span class="p">{</span>
        <span class="nf">id</span><span class="p">(</span><span class="s">"payout-medical-2024-10-08"</span><span class="p">)</span>
        <span class="nf">type</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"TravelInsurancePayoutCredential"</span><span class="p">)</span>
        <span class="nf">issuer</span><span class="p">(</span><span class="n">insuranceDid</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
        <span class="nf">subject</span> <span class="p">{</span>
            <span class="nf">id</span><span class="p">(</span><span class="s">"payout-medical-2024-10-08"</span><span class="p">)</span>
            <span class="s">"policyId"</span> <span class="n">to</span> <span class="s">"TRAVEL-POL-12345"</span>
            <span class="s">"triggerType"</span> <span class="n">to</span> <span class="s">"MedicalEmergency"</span>
            <span class="s">"dataCredentialId"</span> <span class="n">to</span> <span class="n">medicalCredential</span><span class="p">.</span><span class="n">id</span>
            <span class="s">"payoutAmount"</span> <span class="n">to</span> <span class="mf">1500.0</span>
            <span class="s">"currency"</span> <span class="n">to</span> <span class="s">"USD"</span>
            <span class="s">"payoutMethod"</span> <span class="n">to</span> <span class="s">"direct-debit"</span>
            <span class="s">"quickPayout"</span> <span class="n">to</span> <span class="k">true</span>  <span class="c1">// Fast-track for medical</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">by</span><span class="p">(</span><span class="n">issuerDid</span> <span class="p">=</span> <span class="n">insuranceDid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">keyId</span> <span class="p">=</span> <span class="n">insuranceKeyId</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">val</span> <span class="py">medicalPayoutCredential</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">medicalPayoutIssuanceResult</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="nc">IssuanceResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">medicalPayoutIssuanceResult</span><span class="p">.</span><span class="n">credential</span>
    <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to issue medical payout credential"</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-5-embedding-in-travel-booking-process">
  
  
    <a href="#step-5-embedding-in-travel-booking-process" class="anchor-heading" aria-labelledby="step-5-embedding-in-travel-booking-process"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 5: Embedding in Travel Booking Process
  
  
</h2>
    

<p>Integrate TrustWeave Pro into travel booking platforms:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre></td><td class="rouge-code"><pre><span class="c1">// Embedded in airline booking system</span>
<span class="k">suspend</span> <span class="k">fun</span> <span class="nf">bookFlightWithInsurance</span><span class="p">(</span>
    <span class="n">flightDetails</span><span class="p">:</span> <span class="nc">FlightDetails</span><span class="p">,</span>
    <span class="n">insurancePolicy</span><span class="p">:</span> <span class="nc">InsurancePolicy</span>
<span class="p">):</span> <span class="nc">BookingResult</span> <span class="p">{</span>
    <span class="c1">// Book flight</span>
    <span class="kd">val</span> <span class="py">booking</span> <span class="p">=</span> <span class="n">airline</span><span class="p">.</span><span class="nf">bookFlight</span><span class="p">(</span><span class="n">flightDetails</span><span class="p">)</span>

    <span class="c1">// Create insurance policy credential</span>
    <span class="kd">val</span> <span class="py">policyIssuanceResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="nf">issue</span> <span class="p">{</span>
        <span class="nf">credential</span> <span class="p">{</span>
            <span class="nf">id</span><span class="p">(</span><span class="n">booking</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
            <span class="nf">type</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"TravelInsurancePolicyCredential"</span><span class="p">)</span>
            <span class="nf">issuer</span><span class="p">(</span><span class="n">insuranceDid</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
            <span class="nf">subject</span> <span class="p">{</span>
                <span class="nf">id</span><span class="p">(</span><span class="n">booking</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
                <span class="s">"policyId"</span> <span class="n">to</span> <span class="n">insurancePolicy</span><span class="p">.</span><span class="n">id</span>
                <span class="s">"coverage"</span> <span class="p">{</span>
                    <span class="s">"flightDelay"</span> <span class="n">to</span> <span class="k">true</span>
                    <span class="s">"weatherGuarantee"</span> <span class="n">to</span> <span class="k">true</span>
                    <span class="s">"baggageDelay"</span> <span class="n">to</span> <span class="k">true</span>
                    <span class="s">"medicalEmergency"</span> <span class="n">to</span> <span class="k">true</span>
                <span class="p">}</span>
                <span class="s">"activeFrom"</span> <span class="n">to</span> <span class="n">booking</span><span class="p">.</span><span class="n">departureTime</span>
                <span class="s">"activeUntil"</span> <span class="n">to</span> <span class="n">booking</span><span class="p">.</span><span class="n">returnTime</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">by</span><span class="p">(</span><span class="n">issuerDid</span> <span class="p">=</span> <span class="n">insuranceDid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">keyId</span> <span class="p">=</span> <span class="n">insuranceKeyId</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">val</span> <span class="py">policyCredential</span> <span class="p">=</span> <span class="k">when</span> <span class="p">(</span><span class="n">policyIssuanceResult</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">IssuanceResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="n">policyIssuanceResult</span><span class="p">.</span><span class="n">credential</span>
        <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Failed to issue policy credential"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Store policy credential with booking</span>
    <span class="n">booking</span><span class="p">.</span><span class="nf">storeCredential</span><span class="p">(</span><span class="n">policyCredential</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">booking</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-6-blockchain-anchoring-for-audit-trail">
  
  
    <a href="#step-6-blockchain-anchoring-for-audit-trail" class="anchor-heading" aria-labelledby="step-6-blockchain-anchoring-for-audit-trail"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 6: Blockchain Anchoring for Audit Trail
  
  
</h2>
    

<p>Anchor travel credentials to blockchain for immutable audit trail:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="c1">// Anchor flight delay credential</span>
<span class="kd">val</span> <span class="py">anchorResult</span> <span class="p">=</span> <span class="n">trustWeave</span><span class="p">.</span><span class="n">blockchains</span><span class="p">.</span><span class="nf">anchor</span><span class="p">(</span>
    <span class="n">data</span> <span class="p">=</span> <span class="n">flightDelayCredential</span><span class="p">,</span>
    <span class="n">serializer</span> <span class="p">=</span> <span class="nc">VerifiableCredential</span><span class="p">.</span><span class="nf">serializer</span><span class="p">(),</span>
    <span class="n">chainId</span> <span class="p">=</span> <span class="s">"algorand:testnet"</span>
<span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
    <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">anchor</span> <span class="p">-&gt;</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Credential anchored: ${anchor.ref.txHash}"</span><span class="p">)</span>
        <span class="n">anchor</span>
    <span class="p">},</span>
    <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Anchoring failed: ${error.message}"</span><span class="p">)</span>
        <span class="k">null</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1">// Store anchor reference for audit trail</span>
<span class="k">if</span> <span class="p">(</span><span class="n">anchorResult</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">saveAuditRecord</span><span class="p">(</span>
        <span class="n">dataCredentialId</span> <span class="p">=</span> <span class="n">flightDelayCredential</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">anchorRef</span> <span class="p">=</span> <span class="n">anchorResult</span><span class="p">.</span><span class="n">ref</span><span class="p">,</span>
        <span class="n">timestamp</span> <span class="p">=</span> <span class="n">anchorResult</span><span class="p">.</span><span class="n">timestamp</span>
    <span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="key-benefits">
  
  
    <a href="#key-benefits" class="anchor-heading" aria-labelledby="key-benefits"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Key Benefits
  
  
</h2>
    

<ol>
  <li><strong>Standardization</strong>: One format works for all travel data providers</li>
  <li><strong>Multi-Provider</strong>: Accept data from airlines, IATA, weather services, baggage systems without custom integrations</li>
  <li><strong>Data Integrity</strong>: Cryptographic proof prevents tampering and fraud</li>
  <li><strong>Automation</strong>: Enable automatic insurance payouts</li>
  <li><strong>Audit Trail</strong>: Complete data lineage for compliance</li>
  <li><strong>Trust</strong>: Build trust through verifiable credentials</li>
  <li><strong>Speed</strong>: Quick payouts without manual claims processing</li>
</ol>
<h2 id="real-world-integration">
  
  
    <a href="#real-world-integration" class="anchor-heading" aria-labelledby="real-world-integration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Real-World Integration
  
  
</h2>
    

<p><strong>Chubb Travel Pro Integration:</strong></p>
<ul>
  <li>Replace custom API integrations with VC-based data acceptance</li>
  <li>Accept data from any certified provider (airlines, IATA, weather services)</li>
  <li>Reduce integration costs by 80%</li>
  <li>Enable automatic payouts for flight delays, weather disruptions, and baggage issues</li>
</ul>

<p><strong>Travel Booking Platform Integration:</strong></p>
<ul>
  <li>Embed TrustWeave Pro into booking process</li>
  <li>Issue insurance policy credentials at time of booking</li>
  <li>Enable automatic claims processing</li>
  <li>Provide transparency and trust to travelers</li>
</ul>
<h2 id="next-steps">
  
  
    <a href="#next-steps" class="anchor-heading" aria-labelledby="next-steps"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Next Steps
  
  
</h2>
    

<ul>
  <li>Explore <a href="/trustweave/scenarios/parametric-insurance-eo-scenario/">Parametric Insurance with Earth Observation</a> for EO data use cases</li>
  <li>Learn about <a href="/trustweave/core-concepts/blockchain-anchoring/">Blockchain Anchoring</a></li>
  <li>Review <a href="/trustweave/advanced/error-handling/">Error Handling</a> for production patterns</li>
</ul>
<h2 id="related-documentation">
  
  
    <a href="#related-documentation" class="anchor-heading" aria-labelledby="related-documentation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Related Documentation
  
  
</h2>
    

<ul>
  <li><a href="/trustweave/scenarios/parametric-insurance-eo-scenario/">Parametric Insurance with Earth Observation</a> - EO data insurance</li>
  <li><a href="/trustweave/core-concepts/blockchain-anchoring/">Blockchain Anchoring</a> - Anchoring concepts</li>
  <li><a href="/trustweave/api-reference/core-api/">API Reference</a> - Complete API documentation</li>
</ul>

          

          
            
          
        </main>
        

  <hr>
  <footer>
    

    <!-- Hidden template for footer injection -->
<div id="footer-template" style="display: none;">
  <!-- Site Footer - Consistent across all pages -->
<footer class="site-footer">
    <div class="footer-content">
        <div class="footer-links">
            <a href="/trustweave/">Home</a>
            <a href="/trustweave/getting-started/README/">Documentation</a>
            <a href="https://github.com/geoknoesis/TrustWeave" target="_blank">GitHub</a>
            <a href="/trustweave/partnership/">Partners</a>
            <a href="https://github.com/geoknoesis/TrustWeave/blob/main/docs/README.md" target="_blank">Docs</a>
            <a href="https://github.com/geoknoesis/TrustWeave/blob/main/LICENSE" target="_blank">License</a>
            <a href="https://www.geoknoesis.com" target="_blank">Geoknoesis LLC</a>
        </div>
        <p class="footer-text">Made with ❤️ by Geoknoesis LLC</p>
    </div>
</footer>


</div>
<script>
  // Move footer from template to body bottom and make it full width
  document.addEventListener('DOMContentLoaded', function() {
    const template = document.getElementById('footer-template');
    if (template) {
      const footer = template.querySelector('.site-footer');
      if (footer) {
        // Move footer to body level (outside of any containers)
        document.body.appendChild(footer);
        template.remove();

        // Ensure footer spans full width by removing any parent constraints
        footer.style.position = 'relative';
        footer.style.width = '100vw';
        footer.style.marginLeft = 'calc(-50vw + 50%)';
        footer.style.marginRight = 'calc(-50vw + 50%)';
        footer.style.marginTop = 'auto'; // Push to bottom in flexbox layout
        footer.style.zIndex = '0'; // Below search overlay
      }
    }

    // Function to update footer visibility based on search state
    function updateFooterVisibility() {
      const footer = document.querySelector('.site-footer');
      const htmlElement = document.documentElement;

      if (footer && htmlElement) {
        const isSearchActive = htmlElement.classList.contains('search-active');
        if (isSearchActive) {
          // Hide footer when search is active - use multiple methods to ensure it's hidden
          footer.style.display = 'none';
          footer.style.visibility = 'hidden';
          footer.style.opacity = '0';
          footer.style.zIndex = '-999';
          footer.style.pointerEvents = 'none';
        } else {
          // Show footer when search is not active
          footer.style.display = 'block';
          footer.style.visibility = 'visible';
          footer.style.opacity = '1';
          footer.style.marginTop = 'auto';
          footer.style.position = 'relative';
          footer.style.zIndex = '-1';
          footer.style.pointerEvents = 'auto';
        }
      }
    }

    // Monitor search state and hide/show footer appropriately
    const observer = new MutationObserver(function(mutations) {
      updateFooterVisibility();
    });

    // Also listen for input events on search input as a backup
    // This ensures footer is hidden immediately when user starts typing
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
      // Use requestAnimationFrame for better performance
      const handleSearchChange = function() {
        requestAnimationFrame(updateFooterVisibility);
      };

      searchInput.addEventListener('input', handleSearchChange);
      searchInput.addEventListener('focus', handleSearchChange);
      searchInput.addEventListener('keydown', handleSearchChange);
    }

    // Observe documentElement (html) for class changes (like search-active)
    // The search script adds 'search-active' to documentElement, not body
    if (document.documentElement) {
      observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['class']
      });

      // Initial check
      updateFooterVisibility();
    }
  });
</script>


    
  </footer>


      </div>
    </div>
    
      

<div class="search-overlay"></div>

    
  </div>

  
    





<script type="module">
  
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.esm.min.mjs';
  

  var config = {}
;
  mermaid.initialize(config);
  mermaid.run({
    querySelector: '.language-mermaid',
  });
</script>



  
</body>
</html>

