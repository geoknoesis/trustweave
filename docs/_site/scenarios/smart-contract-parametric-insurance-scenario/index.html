

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/trustweave/assets/css/just-the-docs-default.css">

  <link rel="stylesheet" href="/trustweave/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet">

  <style id="jtd-nav-activation">
  
    .site-nav ul li a {
      background-image: none;
    }

  </style>

  

  
    <script src="/trustweave/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/trustweave/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Smart Contract: Parametric Insurance Scenario | TrustWeave Developer Documentation</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Smart Contract: Parametric Insurance Scenario" />
<meta name="author" content="GeoKnoesis" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin" />
<meta property="og:description" content="Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin" />
<link rel="canonical" href="http://localhost:4000/trustweave/scenarios/smart-contract-parametric-insurance-scenario/" />
<meta property="og:url" content="http://localhost:4000/trustweave/scenarios/smart-contract-parametric-insurance-scenario/" />
<meta property="og:site_name" content="TrustWeave Developer Documentation" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Smart Contract: Parametric Insurance Scenario" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"GeoKnoesis"},"description":"Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin","headline":"Smart Contract: Parametric Insurance Scenario","url":"http://localhost:4000/trustweave/scenarios/smart-contract-parametric-insurance-scenario/"}</script>
<!-- End Jekyll SEO tag -->


  

</head>

<body>
  <a class="skip-to-main" href="#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  
    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>

  
  
    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>

  
</svg>

  
    <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="/trustweave/" class="site-title lh-tight">
  TrustWeave Developer Documentation

</a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </button>
  </div>

  <nav aria-label="Main" id="site-nav" class="site-nav">
  
  
    <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Introduction category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/introduction/README/" class="nav-list-link">Introduction</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/introduction/what-is-trustweave/" class="nav-list-link">What is TrustWeave?</a></li><li class="nav-list-item"><a href="/trustweave/introduction/executive-overview/" class="nav-list-link">Executive Overview: TrustWeave</a></li><li class="nav-list-item"><a href="/trustweave/introduction/key-features/" class="nav-list-link">Key Features</a></li><li class="nav-list-item"><a href="/trustweave/introduction/use-cases/" class="nav-list-link">Use Cases</a></li><li class="nav-list-item"><a href="/trustweave/introduction/architecture-overview/" class="nav-list-link">Architecture Overview</a></li><li class="nav-list-item"><a href="/trustweave/introduction/mental-model/" class="nav-list-link">TrustWeave Mental Model</a></li><li class="nav-list-item"><a href="/trustweave/introduction/web-of-trust/" class="nav-list-link">The Web of Trust: Foundation for Decentralized Trust</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Getting Started category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/getting-started/README/" class="nav-list-link">Getting Started</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/getting-started/installation/" class="nav-list-link">Installation</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/quick-start/" class="nav-list-link">Quick Start</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/your-first-application/" class="nav-list-link">Your First Application</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/project-setup/" class="nav-list-link">Project Setup</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/ide-setup/" class="nav-list-link">IDE Setup Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/common-patterns/" class="nav-list-link">Common Patterns</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/api-patterns/" class="nav-list-link">API Patterns and Best Practices</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/workflows/" class="nav-list-link">Common Workflows</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/dsl-guide/" class="nav-list-link">TrustWeave DSL Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/troubleshooting/" class="nav-list-link">Troubleshooting Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/production-deployment/" class="nav-list-link">Production Deployment Guide</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Core Concepts category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/core-concepts/README/" class="nav-list-link">Core Concepts</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/core-concepts/dids/" class="nav-list-link">Decentralized Identifiers (DIDs)</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/verifiable-credentials/" class="nav-list-link">Verifiable Credentials (VCs)</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/wallets/" class="nav-list-link">Wallets</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/blockchain-anchoring/" class="nav-list-link">Blockchain Anchoring</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/smart-contracts/" class="nav-list-link">Smart Contracts</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/key-management/" class="nav-list-link">Key Management</a></li></ul></li><li class="nav-list-item"><a href="/trustweave/tutorials/README/" class="nav-list-link">Tutorials</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in API Reference category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/api-reference/README/" class="nav-list-link">API Reference</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/api-reference/core-api/" class="nav-list-link">Core API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/wallet-api/" class="nav-list-link">Wallet API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/credential-service-api/" class="nav-list-link">Credential Service API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/smart-contract-api/" class="nav-list-link">Smart Contract API Reference</a></li></ul></li><li class="nav-list-item"><a href="/trustweave/integrations/README/" class="nav-list-link">Integration Modules</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Advanced Topics category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/advanced/README/" class="nav-list-link">Advanced Topics</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/advanced/error-handling/" class="nav-list-link">Error Handling</a></li></ul></li><li class="nav-list-item"><a href="/trustweave/modules/core-modules/" class="nav-list-link">Core Modules</a></li><li class="nav-list-item"><a href="/trustweave/contributing/README/" class="nav-list-link">Contributing to TrustWeave</a></li><li class="nav-list-item"><a href="/trustweave/faq/" class="nav-list-link">Frequently Asked Questions</a></li><li class="nav-list-item"><a href="/trustweave/tutorials/beginner-tutorial-series/" class="nav-list-link">Beginner Tutorial Series</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/blockchain-anchored-revocation/" class="nav-list-link">Blockchain-Anchored Revocation</a></li><li class="nav-list-item"><a href="/trustweave/contributing/code-style/" class="nav-list-link">Code Style</a></li><li class="nav-list-item"><a href="/trustweave/comparison/README/" class="nav-list-link">Comparison Documentation</a></li><li class="nav-list-item"><a href="/trustweave/configuration/README/" class="nav-list-link">Configuration Reference</a></li><li class="nav-list-item"><a href="/trustweave/advanced/custom-adapters/" class="nav-list-link">Creating Custom Adapters</a></li><li class="nav-list-item"><a href="/trustweave/contributing/creating-plugins/" class="nav-list-link">Creating TrustWeave Plugins</a></li><li class="nav-list-item"><a href="/trustweave/features/credential-exchange-protocols/README/" class="nav-list-link">Credential Exchange Protocols</a></li><li class="nav-list-item"><a href="/trustweave/tutorials/credential-issuance-tutorial/" class="nav-list-link">Credential Issuance Tutorial</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/algorithm-compatibility-table/" class="nav-list-link">Cryptographic Algorithm Compatibility: DIDs, VCs, AWS KMS, and Azure Key Vault</a></li><li class="nav-list-item"><a href="/trustweave/tutorials/did-operations-tutorial/" class="nav-list-link">DID Operations Tutorial</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/delegation/" class="nav-list-link">Delegation</a></li><li class="nav-list-item"><a href="/trustweave/contributing/development-setup/" class="nav-list-link">Development Setup</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/evaluation-engines/" class="nav-list-link">Evaluation Engines</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/json-canonicalization/" class="nav-list-link">JSON Canonicalization</a></li><li class="nav-list-item"><a href="/trustweave/advanced/key-rotation/" class="nav-list-link">Key Rotation Strategies</a></li><li class="nav-list-item"><a href="/trustweave/licensing/README/" class="nav-list-link">Licensing Overview</a></li><li class="nav-list-item"><a href="/trustweave/migration/README/" class="nav-list-link">Migration Guides</a></li><li class="nav-list-item"><a href="/trustweave/advanced/performance/" class="nav-list-link">Performance Considerations</a></li><li class="nav-list-item"><a href="/trustweave/advanced/plugin-lifecycle/" class="nav-list-link">Plugin Lifecycle Management</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/proof-purpose-validation/" class="nav-list-link">Proof Purpose Validation</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/credential-exchange-protocols/" class="nav-list-link">Protocol Abstraction Layer</a></li><li class="nav-list-item"><a href="/trustweave/contributing/pull-request-process/" class="nav-list-link">Pull Request Process</a></li><li class="nav-list-item"><a href="/trustweave/security/README/" class="nav-list-link">Security Best Practices</a></li><li class="nav-list-item"><a href="/trustweave/advanced/spi/" class="nav-list-link">Service Provider Interface (SPI)</a></li><li class="nav-list-item"><a href="/trustweave/plugins/" class="nav-list-link">Supported Plugins</a></li><li class="nav-list-item"><a href="/trustweave/contributing/testing-guidelines/" class="nav-list-link">Testing Guidelines</a></li><li class="nav-list-item"><a href="/trustweave/advanced/testing-strategies/" class="nav-list-link">Testing Strategies</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/trust-registry/" class="nav-list-link">Trust Registry</a></li><li class="nav-list-item"><a href="/trustweave/GLOSSARY/" class="nav-list-link">TrustWeave Glossary</a></li><li class="nav-list-item"><a href="/trustweave/TRUSTWEAVE_WHITEPAPER/" class="nav-list-link">TrustWeave SDK: Decentralized Trust Infrastructure</a></li><li class="nav-list-item"><a href="/trustweave/scenarios/README/" class="nav-list-link">Use Case Scenarios</a></li><li class="nav-list-item"><a href="/trustweave/advanced/verification-policies/" class="nav-list-link">Verification Policies</a></li><li class="nav-list-item"><a href="/trustweave/tutorials/wallet-api-tutorial/" class="nav-list-link">Wallet API Tutorial</a></li></ul>
  
</nav>




  
  
    <footer class="site-footer">
      This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.
    </footer>
  
</div>

  
  <div class="main" id="top">
    <div id="main-header" class="main-header">
  
    

<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search TrustWeave Developer Documentation" aria-label="Search TrustWeave Developer Documentation" autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>

  
  
  
</div>

    <div class="main-content-wrap">
      
      <div id="main-content" class="main-content">
        <main>
          
            <h1 id="smart-contract-parametric-insurance-scenario">
  
  
    <a href="#smart-contract-parametric-insurance-scenario" class="anchor-heading" aria-labelledby="smart-contract-parametric-insurance-scenario"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Smart Contract: Parametric Insurance Scenario
  
  
</h1>
    

<blockquote>
  <p><strong>Building Parametric Insurance with TrustWeave Smart Contracts</strong></p>
</blockquote>

<p>This guide demonstrates how to build a parametric insurance system using TrustWeave’s Smart Contract abstraction. You’ll learn how to create contracts that automatically execute based on Earth Observation (EO) data triggers, with verifiable credentials and blockchain anchoring for trust and auditability.</p>
<h2 id="what-youll-build">
  
  
    <a href="#what-youll-build" class="anchor-heading" aria-labelledby="what-youll-build"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What You’ll Build
  
  
</h2>
    

<p>By the end of this tutorial, you’ll have:</p>

<ul>
  <li>✅ Created a parametric insurance contract using SmartContract</li>
  <li>✅ Bound the contract with verifiable credentials</li>
  <li>✅ Anchored the contract to blockchain</li>
  <li>✅ Executed the contract based on EO data triggers</li>
  <li>✅ Generated automatic payouts when conditions are met</li>
</ul>
<h2 id="architecture-overview">
  
  
    <a href="#architecture-overview" class="anchor-heading" aria-labelledby="architecture-overview"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Architecture Overview
  
  
</h2>
    

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>┌─────────────────────────────────────────────────────────────┐
│              Parametric Insurance Contract                  │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │ EO Provider │  │  Insurance   │  │  Blockchain  │       │
│  │   (DID)     │  │   (DID)     │  │   Anchor     │       │
│  └──────┬───────┘  └──────┬──────┘  └──────┬───────┘       │
│         │                 │                 │                │
│         │ Issues VC       │ Issues VC       │ Anchors        │
│         │                 │                 │                │
│  ┌──────▼─────────────────▼─────────────────▼──────┐       │
│  │         TrustWeave Smart Contract Service          │       │
│  │  ┌──────────────────────────────────────────┐   │       │
│  │  │  Contract Lifecycle Management            │   │       │
│  │  │  - Create Draft                           │   │       │
│  │  │  - Bind (Issue VC + Anchor)               │   │       │
│  │  │  - Activate                               │   │       │
│  │  │  - Execute (Evaluate Conditions)          │   │       │
│  │  └──────────────────────────────────────────┘   │       │
│  │  ┌──────────────────────────────────────────┐   │       │
│  │  │  Condition Evaluation                     │   │       │
│  │  │  - Parametric Triggers                    │   │       │
│  │  │  - Threshold Checks                       │   │       │
│  │  │  - Payout Calculation                    │   │       │
│  │  └──────────────────────────────────────────┘   │       │
│  └──────────────────────────────────────────────────┘       │
│                                                               │
└─────────────────────────────────────────────────────────────┘
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-1-setup-trustweave">
  
  
    <a href="#step-1-setup-trustweave" class="anchor-heading" aria-labelledby="step-1-setup-trustweave"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 1: Setup TrustWeave
  
  
</h2>
    

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="nn">com.trustweave.TrustWeave</span>
<span class="k">import</span> <span class="nn">com.trustweave.contract.models.*</span>
<span class="k">import</span> <span class="nn">kotlinx.serialization.json.buildJsonObject</span>
<span class="k">import</span> <span class="nn">kotlinx.serialization.json.put</span>
<span class="k">import</span> <span class="nn">java.time.Instant</span>

<span class="c1">// Initialize TrustWeave with blockchain anchoring</span>
<span class="kd">val</span> <span class="py">TrustWeave</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">create</span> <span class="p">{</span>
    <span class="nf">blockchains</span> <span class="p">{</span>
        <span class="s">"algorand:mainnet"</span> <span class="n">to</span> <span class="n">algorandClient</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Create DIDs for parties</span>
<span class="kd">val</span> <span class="py">insurerDid</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">method</span> <span class="p">=</span> <span class="s">"key"</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">insuredDid</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">method</span> <span class="p">=</span> <span class="s">"key"</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">eoProviderDid</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">method</span> <span class="p">=</span> <span class="s">"key"</span><span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-2-create-contract-draft">
  
  
    <a href="#step-2-create-contract-draft" class="anchor-heading" aria-labelledby="step-2-create-contract-draft"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 2: Create Contract Draft
  
  
</h2>
    

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
</pre></td><td class="rouge-code"><pre><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">createFloodInsuranceContract</span><span class="p">(</span>
    <span class="nc">TrustWeave</span><span class="p">:</span> <span class="nc">TrustWeave</span><span class="p">,</span>
    <span class="n">insurerDid</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">insuredDid</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">coverageAmount</span><span class="p">:</span> <span class="nc">Double</span><span class="p">,</span>
    <span class="n">location</span><span class="p">:</span> <span class="nc">Location</span>
<span class="p">):</span> <span class="nc">SmartContract</span> <span class="p">{</span>
    
    <span class="kd">val</span> <span class="py">contract</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">contracts</span><span class="p">.</span><span class="nf">draft</span><span class="p">(</span>
        <span class="n">request</span> <span class="p">=</span> <span class="nc">ContractDraftRequest</span><span class="p">(</span>
            <span class="n">contractType</span> <span class="p">=</span> <span class="nc">ContractType</span><span class="p">.</span><span class="nc">Insurance</span><span class="p">,</span>
            <span class="n">executionModel</span> <span class="p">=</span> <span class="nc">ExecutionModel</span><span class="p">.</span><span class="nc">Parametric</span><span class="p">(</span>
                <span class="n">triggerType</span> <span class="p">=</span> <span class="nc">TriggerType</span><span class="p">.</span><span class="nc">EarthObservation</span><span class="p">,</span>
                <span class="n">evaluationEngine</span> <span class="p">=</span> <span class="s">"parametric-insurance"</span>
            <span class="p">),</span>
            <span class="n">parties</span> <span class="p">=</span> <span class="nc">ContractParties</span><span class="p">(</span>
                <span class="n">primaryPartyDid</span> <span class="p">=</span> <span class="n">insurerDid</span><span class="p">,</span>
                <span class="n">counterpartyDid</span> <span class="p">=</span> <span class="n">insuredDid</span>
            <span class="p">),</span>
            <span class="n">terms</span> <span class="p">=</span> <span class="nc">ContractTerms</span><span class="p">(</span>
                <span class="n">obligations</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span>
                    <span class="nc">Obligation</span><span class="p">(</span>
                        <span class="n">id</span> <span class="p">=</span> <span class="s">"payout-obligation"</span><span class="p">,</span>
                        <span class="n">partyDid</span> <span class="p">=</span> <span class="n">insurerDid</span><span class="p">,</span>
                        <span class="n">description</span> <span class="p">=</span> <span class="s">"Pay out based on flood depth tier"</span><span class="p">,</span>
                        <span class="n">obligationType</span> <span class="p">=</span> <span class="nc">ObligationType</span><span class="p">.</span><span class="nc">PAYMENT</span>
                    <span class="p">)</span>
                <span class="p">),</span>
                <span class="n">conditions</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span>
                    <span class="nc">ContractCondition</span><span class="p">(</span>
                        <span class="n">id</span> <span class="p">=</span> <span class="s">"flood-threshold-20cm"</span><span class="p">,</span>
                        <span class="n">description</span> <span class="p">=</span> <span class="s">"Flood depth &gt;= 20cm (Tier 1)"</span><span class="p">,</span>
                        <span class="n">conditionType</span> <span class="p">=</span> <span class="nc">ConditionType</span><span class="p">.</span><span class="nc">THRESHOLD</span><span class="p">,</span>
                        <span class="n">expression</span> <span class="p">=</span> <span class="s">"$.floodDepthCm &gt;= 20"</span>
                    <span class="p">),</span>
                    <span class="nc">ContractCondition</span><span class="p">(</span>
                        <span class="n">id</span> <span class="p">=</span> <span class="s">"flood-threshold-50cm"</span><span class="p">,</span>
                        <span class="n">description</span> <span class="p">=</span> <span class="s">"Flood depth &gt;= 50cm (Tier 2)"</span><span class="p">,</span>
                        <span class="n">conditionType</span> <span class="p">=</span> <span class="nc">ConditionType</span><span class="p">.</span><span class="nc">THRESHOLD</span><span class="p">,</span>
                        <span class="n">expression</span> <span class="p">=</span> <span class="s">"$.floodDepthCm &gt;= 50"</span>
                    <span class="p">),</span>
                    <span class="nc">ContractCondition</span><span class="p">(</span>
                        <span class="n">id</span> <span class="p">=</span> <span class="s">"flood-threshold-100cm"</span><span class="p">,</span>
                        <span class="n">description</span> <span class="p">=</span> <span class="s">"Flood depth &gt;= 100cm (Tier 3)"</span><span class="p">,</span>
                        <span class="n">conditionType</span> <span class="p">=</span> <span class="nc">ConditionType</span><span class="p">.</span><span class="nc">THRESHOLD</span><span class="p">,</span>
                        <span class="n">expression</span> <span class="p">=</span> <span class="s">"$.floodDepthCm &gt;= 100"</span>
                    <span class="p">)</span>
                <span class="p">),</span>
                <span class="n">penalties</span> <span class="p">=</span> <span class="k">null</span><span class="p">,</span>
                <span class="n">rewards</span> <span class="p">=</span> <span class="k">null</span><span class="p">,</span>
                <span class="n">jurisdiction</span> <span class="p">=</span> <span class="s">"US"</span><span class="p">,</span>
                <span class="n">governingLaw</span> <span class="p">=</span> <span class="s">"State of North Carolina"</span>
            <span class="p">),</span>
            <span class="n">effectiveDate</span> <span class="p">=</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">(),</span>
            <span class="n">expirationDate</span> <span class="p">=</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">plusSeconds</span><span class="p">(</span><span class="mi">365</span> <span class="p">*</span> <span class="mi">24</span> <span class="p">*</span> <span class="mi">60</span> <span class="p">*</span> <span class="mi">60</span><span class="p">).</span><span class="nf">toString</span><span class="p">(),</span>
            <span class="n">contractData</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"productType"</span><span class="p">,</span> <span class="s">"SarFlood"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"coverageAmount"</span><span class="p">,</span> <span class="n">coverageAmount</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"location"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"latitude"</span><span class="p">,</span> <span class="n">location</span><span class="p">.</span><span class="n">latitude</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"longitude"</span><span class="p">,</span> <span class="n">location</span><span class="p">.</span><span class="n">longitude</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"address"</span><span class="p">,</span> <span class="n">location</span><span class="p">.</span><span class="n">address</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"region"</span><span class="p">,</span> <span class="n">location</span><span class="p">.</span><span class="n">region</span><span class="p">)</span>
                <span class="p">})</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"thresholds"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"tier1Cm"</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"tier2Cm"</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"tier3Cm"</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span>
                <span class="p">})</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"payoutTiers"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"tier1"</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>  <span class="c1">// 25% of coverage</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"tier2"</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">)</span>  <span class="c1">// 50% of coverage</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"tier3"</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>   <span class="c1">// 100% of coverage</span>
                <span class="p">})</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Contract draft created: ${contract.id}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Contract Number: ${contract.contractNumber}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Status: ${contract.status}"</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">contract</span>
<span class="p">}</span>

<span class="kd">data class</span> <span class="nc">Location</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">latitude</span><span class="p">:</span> <span class="nc">Double</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">longitude</span><span class="p">:</span> <span class="nc">Double</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">address</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">region</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-3-bind-contract">
  
  
    <a href="#step-3-bind-contract" class="anchor-heading" aria-labelledby="step-3-bind-contract"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 3: Bind Contract
  
  
</h2>
    

<p>Binding issues a verifiable credential and anchors to blockchain:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">bindInsuranceContract</span><span class="p">(</span>
    <span class="nc">TrustWeave</span><span class="p">:</span> <span class="nc">TrustWeave</span><span class="p">,</span>
    <span class="n">contract</span><span class="p">:</span> <span class="nc">SmartContract</span><span class="p">,</span>
    <span class="n">insurerDid</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">insurerKeyId</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">):</span> <span class="nc">BoundContract</span> <span class="p">{</span>
    
    <span class="kd">val</span> <span class="py">bound</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">contracts</span><span class="p">.</span><span class="nf">bindContract</span><span class="p">(</span>
        <span class="n">contractId</span> <span class="p">=</span> <span class="n">contract</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">insurerDid</span><span class="p">,</span>
        <span class="n">issuerKeyId</span> <span class="p">=</span> <span class="n">insurerKeyId</span><span class="p">,</span>
        <span class="n">chainId</span> <span class="p">=</span> <span class="s">"algorand:mainnet"</span>
    <span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Contract bound:"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Credential ID: ${bound.credentialId}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Anchor TX: ${bound.anchorRef.txHash}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Chain: ${bound.anchorRef.chainId}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Status: ${bound.contract.status}"</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">bound</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-4-activate-contract">
  
  
    <a href="#step-4-activate-contract" class="anchor-heading" aria-labelledby="step-4-activate-contract"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 4: Activate Contract
  
  
</h2>
    

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">activateContract</span><span class="p">(</span>
    <span class="nc">TrustWeave</span><span class="p">:</span> <span class="nc">TrustWeave</span><span class="p">,</span>
    <span class="n">contractId</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">):</span> <span class="nc">SmartContract</span> <span class="p">{</span>
    
    <span class="kd">val</span> <span class="py">active</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">contracts</span><span class="p">.</span><span class="nf">activateContract</span><span class="p">(</span><span class="n">contractId</span><span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Contract activated: ${active.id}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Status: ${active.status}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Effective: ${active.effectiveDate}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Expires: ${active.expirationDate}"</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">active</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-5-process-eo-data-and-execute-contract">
  
  
    <a href="#step-5-process-eo-data-and-execute-contract" class="anchor-heading" aria-labelledby="step-5-process-eo-data-and-execute-contract"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 5: Process EO Data and Execute Contract
  
  
</h2>
    

<p>When EO data arrives (e.g., SAR flood data), process it and execute the contract:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre></td><td class="rouge-code"><pre><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">processFloodDataAndExecute</span><span class="p">(</span>
    <span class="nc">TrustWeave</span><span class="p">:</span> <span class="nc">TrustWeave</span><span class="p">,</span>
    <span class="n">contract</span><span class="p">:</span> <span class="nc">SmartContract</span><span class="p">,</span>
    <span class="n">floodDepthCm</span><span class="p">:</span> <span class="nc">Double</span><span class="p">,</span>
    <span class="n">eoDataCredential</span><span class="p">:</span> <span class="nc">VerifiableCredential</span>
<span class="p">):</span> <span class="nc">ExecutionResult</span> <span class="p">{</span>
    
    <span class="c1">// Create execution context with trigger data</span>
    <span class="kd">val</span> <span class="py">executionContext</span> <span class="p">=</span> <span class="nc">ExecutionContext</span><span class="p">(</span>
        <span class="n">triggerData</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"floodDepthCm"</span><span class="p">,</span> <span class="n">floodDepthCm</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"credentialId"</span><span class="p">,</span> <span class="n">eoDataCredential</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"timestamp"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="c1">// Execute contract</span>
    <span class="kd">val</span> <span class="py">result</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">contracts</span><span class="p">.</span><span class="nf">executeContract</span><span class="p">(</span>
        <span class="n">contract</span> <span class="p">=</span> <span class="n">contract</span><span class="p">,</span>
        <span class="n">executionContext</span> <span class="p">=</span> <span class="n">executionContext</span>
    <span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">executed</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Contract executed!"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Execution Type: ${result.executionType}"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Outcomes: ${result.outcomes.size}"</span><span class="p">)</span>
        
        <span class="n">result</span><span class="p">.</span><span class="n">outcomes</span><span class="p">.</span><span class="nf">forEach</span> <span class="p">{</span> <span class="n">outcome</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"   - ${outcome.description}"</span><span class="p">)</span>
            <span class="n">outcome</span><span class="p">.</span><span class="n">monetaryImpact</span><span class="o">?.</span><span class="nf">let</span> <span class="p">{</span>
                <span class="nf">println</span><span class="p">(</span><span class="s">"     Amount: ${it.amount} ${it.currency}"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"⚠️  Contract conditions not met"</span><span class="p">)</span>
        <span class="n">result</span><span class="p">.</span><span class="n">outcomes</span><span class="p">.</span><span class="nf">forEach</span> <span class="p">{</span> <span class="n">outcome</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"   - ${outcome.description}"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">result</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-6-complete-workflow">
  
  
    <a href="#step-6-complete-workflow" class="anchor-heading" aria-labelledby="step-6-complete-workflow"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 6: Complete Workflow
  
  
</h2>
    

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
</pre></td><td class="rouge-code"><pre><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">completeParametricInsuranceWorkflow</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">TrustWeave</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">create</span> <span class="p">{</span>
        <span class="nf">blockchains</span> <span class="p">{</span>
            <span class="s">"algorand:mainnet"</span> <span class="n">to</span> <span class="n">algorandClient</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">// Step 1: Create DIDs</span>
    <span class="kd">val</span> <span class="py">insurerDid</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">method</span> <span class="p">=</span> <span class="s">"key"</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">insuredDid</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">method</span> <span class="p">=</span> <span class="s">"key"</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">insurerKeyId</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">resolve</span><span class="p">(</span><span class="n">insurerDid</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
        <span class="p">.</span><span class="n">verificationMethod</span><span class="p">.</span><span class="nf">firstOrNull</span><span class="p">()</span><span class="o">?.</span><span class="n">id</span> <span class="o">?:</span> <span class="nf">error</span><span class="p">(</span><span class="s">"No key found"</span><span class="p">)</span>
    
    <span class="c1">// Step 2: Create contract draft</span>
    <span class="kd">val</span> <span class="py">contract</span> <span class="p">=</span> <span class="nf">createFloodInsuranceContract</span><span class="p">(</span>
        <span class="nc">TrustWeave</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">,</span>
        <span class="n">insurerDid</span> <span class="p">=</span> <span class="n">insurerDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">insuredDid</span> <span class="p">=</span> <span class="n">insuredDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">coverageAmount</span> <span class="p">=</span> <span class="mf">1_000_000.0</span><span class="p">,</span>
        <span class="n">location</span> <span class="p">=</span> <span class="nc">Location</span><span class="p">(</span>
            <span class="n">latitude</span> <span class="p">=</span> <span class="mf">35.2271</span><span class="p">,</span>
            <span class="n">longitude</span> <span class="p">=</span> <span class="p">-</span><span class="mf">80.8431</span><span class="p">,</span>
            <span class="n">address</span> <span class="p">=</span> <span class="s">"Charlotte, NC"</span><span class="p">,</span>
            <span class="n">region</span> <span class="p">=</span> <span class="s">"North Carolina"</span>
        <span class="p">)</span>
    <span class="p">)</span>
    
    <span class="c1">// Step 3: Bind contract</span>
    <span class="kd">val</span> <span class="py">bound</span> <span class="p">=</span> <span class="nf">bindInsuranceContract</span><span class="p">(</span>
        <span class="nc">TrustWeave</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">,</span>
        <span class="n">contract</span> <span class="p">=</span> <span class="n">contract</span><span class="p">,</span>
        <span class="n">insurerDid</span> <span class="p">=</span> <span class="n">insurerDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">insurerKeyId</span> <span class="p">=</span> <span class="n">insurerKeyId</span>
    <span class="p">)</span>
    
    <span class="c1">// Step 4: Activate contract</span>
    <span class="kd">val</span> <span class="py">active</span> <span class="p">=</span> <span class="nf">activateContract</span><span class="p">(</span><span class="nc">TrustWeave</span><span class="p">,</span> <span class="n">bound</span><span class="p">.</span><span class="n">contract</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
    
    <span class="c1">// Step 5: Simulate flood event</span>
    <span class="c1">// In production, this would come from EO data provider</span>
    <span class="kd">val</span> <span class="py">floodDepth</span> <span class="p">=</span> <span class="mf">75.0</span> <span class="c1">// cm</span>
    
    <span class="c1">// Issue EO data credential (simplified - in production, EO provider issues this)</span>
    <span class="kd">val</span> <span class="py">eoDataCredential</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">credentials</span><span class="p">.</span><span class="nf">issue</span><span class="p">(</span>
        <span class="n">issuer</span> <span class="p">=</span> <span class="n">eoProviderDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">subject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"floodDepthCm"</span><span class="p">,</span> <span class="n">floodDepth</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"timestamp"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
        <span class="p">},</span>
        <span class="n">config</span> <span class="p">=</span> <span class="nc">IssuanceConfig</span><span class="p">(</span>
            <span class="n">proofType</span> <span class="p">=</span> <span class="nc">ProofType</span><span class="p">.</span><span class="nc">Ed25519Signature2020</span><span class="p">,</span>
            <span class="n">keyId</span> <span class="p">=</span> <span class="n">eoProviderKeyId</span>
        <span class="p">),</span>
        <span class="n">types</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"EarthObservationCredential"</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="c1">// Step 6: Execute contract</span>
    <span class="kd">val</span> <span class="py">executionResult</span> <span class="p">=</span> <span class="nf">processFloodDataAndExecute</span><span class="p">(</span>
        <span class="nc">TrustWeave</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">,</span>
        <span class="n">contract</span> <span class="p">=</span> <span class="n">active</span><span class="p">,</span>
        <span class="n">floodDepthCm</span> <span class="p">=</span> <span class="n">floodDepth</span><span class="p">,</span>
        <span class="n">eoDataCredential</span> <span class="p">=</span> <span class="n">eoDataCredential</span>
    <span class="p">)</span>
    
    <span class="c1">// Step 7: Process payout (application-specific)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">executionResult</span><span class="p">.</span><span class="n">executed</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">processPayout</span><span class="p">(</span><span class="n">executionResult</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="advanced-custom-condition-evaluation">
  
  
    <a href="#advanced-custom-condition-evaluation" class="anchor-heading" aria-labelledby="advanced-custom-condition-evaluation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Advanced: Custom Condition Evaluation
  
  
</h2>
    

<p>For production use, implement custom condition evaluators:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">FloodConditionEvaluator</span> <span class="p">:</span> <span class="nc">ConditionEvaluator</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">evaluate</span><span class="p">(</span>
        <span class="n">condition</span><span class="p">:</span> <span class="nc">ContractCondition</span><span class="p">,</span>
        <span class="n">inputData</span><span class="p">:</span> <span class="nc">JsonElement</span><span class="p">,</span>
        <span class="n">contract</span><span class="p">:</span> <span class="nc">SmartContract</span>
    <span class="p">):</span> <span class="nc">Boolean</span> <span class="p">{</span>
        <span class="k">when</span> <span class="p">(</span><span class="n">condition</span><span class="p">.</span><span class="n">conditionType</span><span class="p">)</span> <span class="p">{</span>
            <span class="nc">ConditionType</span><span class="p">.</span><span class="nc">THRESHOLD</span> <span class="p">-&gt;</span> <span class="p">{</span>
                <span class="kd">val</span> <span class="py">threshold</span> <span class="p">=</span> <span class="nf">extractThreshold</span><span class="p">(</span><span class="n">condition</span><span class="p">.</span><span class="n">expression</span><span class="p">)</span>
                <span class="kd">val</span> <span class="py">value</span> <span class="p">=</span> <span class="nf">extractValue</span><span class="p">(</span><span class="n">inputData</span><span class="p">,</span> <span class="s">"floodDepthCm"</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">value</span> <span class="p">&gt;=</span> <span class="n">threshold</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="nc">UnsupportedOperationException</span><span class="p">(</span>
                <span class="s">"Condition type ${condition.conditionType} not supported"</span>
            <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">private</span> <span class="k">fun</span> <span class="nf">extractThreshold</span><span class="p">(</span><span class="n">expression</span><span class="p">:</span> <span class="nc">String</span><span class="p">):</span> <span class="nc">Double</span> <span class="p">{</span>
        <span class="c1">// Parse expression like "$.floodDepthCm &gt;= 50"</span>
        <span class="kd">val</span> <span class="py">match</span> <span class="p">=</span> <span class="nc">Regex</span><span class="p">(</span><span class="s">"&gt;= (\\d+\\.?\\d*)"</span><span class="p">).</span><span class="nf">find</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">match</span><span class="o">?.</span><span class="n">groupValues</span><span class="o">?.</span><span class="k">get</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">?.</span><span class="nf">toDouble</span><span class="p">()</span> <span class="o">?:</span> <span class="mf">0.0</span>
    <span class="p">}</span>
    
    <span class="k">private</span> <span class="k">fun</span> <span class="nf">extractValue</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nc">JsonElement</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nc">String</span><span class="p">):</span> <span class="nc">Double</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span><span class="o">?.</span><span class="nf">toDouble</span><span class="p">()</span> <span class="o">?:</span> <span class="mf">0.0</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="benefits-of-using-smart-contracts">
  
  
    <a href="#benefits-of-using-smart-contracts" class="anchor-heading" aria-labelledby="benefits-of-using-smart-contracts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Benefits of Using Smart Contracts
  
  
</h2>
    

<ol>
  <li><strong>Standardization</strong>: W3C-compliant format works across all contract types</li>
  <li><strong>Trust</strong>: Cryptographic proof of contract terms prevents disputes</li>
  <li><strong>Automation</strong>: Parametric execution enables instant payouts</li>
  <li><strong>Auditability</strong>: Blockchain anchoring provides immutable audit trails</li>
  <li><strong>Multi-Party</strong>: DIDs enable complex multi-party contracts</li>
  <li><strong>Extensibility</strong>: Pluggable execution models for different use cases</li>
</ol>
<h2 id="next-steps">
  
  
    <a href="#next-steps" class="anchor-heading" aria-labelledby="next-steps"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Next Steps
  
  
</h2>
    

<ul>
  <li>Review <a href="/trustweave/core-concepts/smart-contracts/">Smart Contracts Core Concepts</a> for detailed API documentation</li>
  <li>Explore <a href="/trustweave/scenarios/parametric-insurance-mga-implementation-guide/">Parametric Insurance MGA Guide</a> for complete MGA implementation</li>
  <li>See <a href="/trustweave/core-concepts/blockchain-anchoring/">Blockchain Anchoring</a> for anchoring details</li>
  <li>Check <a href="/trustweave/api-reference/core-api/">API Reference</a> for complete API documentation</li>
</ul>

          

          
            
          
        </main>
        


      </div>
    </div>
    
      

<div class="search-overlay"></div>

    
  </div>

  
    





<script type="module">
  
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.esm.min.mjs';
  

  var config = {}
;
  mermaid.initialize(config);
  mermaid.run({
    querySelector: '.language-mermaid',
  });
</script>



  
</body>
</html>

