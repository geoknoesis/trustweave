

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/trustweave/assets/css/just-the-docs-default.css">

  <link rel="stylesheet" href="/trustweave/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet">

  <style id="jtd-nav-activation">
  
    .site-nav ul li a {
      background-image: none;
    }

  </style>

  

  
    <script src="/trustweave/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/trustweave/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>SOC2 Compliance with TrustWeave | TrustWeave Developer Documentation</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="SOC2 Compliance with TrustWeave" />
<meta name="author" content="GeoKnoesis" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin" />
<meta property="og:description" content="Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin" />
<link rel="canonical" href="http://localhost:4000/trustweave/scenarios/soc2-compliance-scenario/" />
<meta property="og:url" content="http://localhost:4000/trustweave/scenarios/soc2-compliance-scenario/" />
<meta property="og:site_name" content="TrustWeave Developer Documentation" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="SOC2 Compliance with TrustWeave" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"GeoKnoesis"},"description":"Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin","headline":"SOC2 Compliance with TrustWeave","url":"http://localhost:4000/trustweave/scenarios/soc2-compliance-scenario/"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Main Navigation Styles - Consistent across all pages -->
<style>
  :root {
    --primary: #2563eb;
    --primary-dark: #1e40af;
    --secondary: #7c3aed;
    --accent: #10b981;
    --text: #1f2937;
    --text-light: #6b7280;
    --bg: #ffffff;
    --bg-light: #f9fafb;
    --border: #e5e7eb;
    --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }

  .main-nav {
    position: fixed;
    top: 0;
    width: 100%;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border);
    z-index: 1000;
    padding: 0.5rem 0;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  }
  
  .main-nav .nav-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .main-nav .logo {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    text-decoration: none;
    transition: opacity 0.3s;
  }

  .main-nav .logo-img {
    height: 120px;
    width: auto;
    transition: opacity 0.3s;
    display: block;
  }

  .main-nav .logo-img:not([src]),
  .main-nav .logo-img[src=""],
  .main-nav .logo-img[src*="undefined"] {
    display: none;
  }


  .main-nav .logo:hover {
    opacity: 0.8;
  }

  .main-nav .logo:hover .logo-img {
    opacity: 0.8;
  }
  
  .main-nav .nav-links {
    display: flex;
    gap: 1.5rem;
    align-items: center;
  }
  
  .main-nav .nav-links .nav-link {
    text-decoration: none;
    color: var(--text);
    font-weight: 500;
    font-size: 0.95rem;
    padding: 0.5rem 0;
    transition: color 0.3s;
    position: relative;
    white-space: nowrap;
  }
  
  .main-nav .nav-links .nav-link:hover {
    color: var(--primary);
  }

  .main-nav .nav-links .nav-link::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 2px;
    background: var(--primary);
    transition: width 0.3s ease;
  }

  .main-nav .nav-links .nav-link:hover::after,
  .main-nav .nav-links .nav-link.active::after {
    width: 100%;
  }

  .main-nav .nav-links .nav-link.active {
    color: var(--primary);
    font-weight: 600;
  }

  /* GitHub icon button */
  .main-nav .nav-links .github-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    border-radius: 0.5rem;
    transition: all 0.3s;
    padding: 0.5rem;
    color: var(--text);
    text-decoration: none;
    margin-left: 0.5rem;
  }

  .main-nav .nav-links .github-icon:hover {
    background: var(--bg-light);
    transform: translateY(-2px);
    color: var(--primary);
  }

  .main-nav .nav-links .github-icon svg {
    width: 32px;
    height: 32px;
  }

  /* Mobile menu toggle */
  .menu-toggle {
    display: none;
    flex-direction: column;
    cursor: pointer;
    gap: 5px;
    padding: 0.5rem;
    z-index: 1001;
  }

  .menu-toggle span {
    width: 25px;
    height: 3px;
    background: var(--text);
    transition: all 0.3s;
    border-radius: 2px;
  }

  .menu-toggle.active span:nth-child(1) {
    transform: rotate(45deg) translate(8px, 8px);
  }

  .menu-toggle.active span:nth-child(2) {
    opacity: 0;
  }

  .menu-toggle.active span:nth-child(3) {
    transform: rotate(-45deg) translate(7px, -7px);
  }

  /* Footer styles */
  .site-footer {
    background: var(--text);
    color: white;
    padding: 3rem 2rem;
    text-align: center;
    margin-top: 4rem;
  }

  .site-footer .footer-content {
    max-width: 1200px;
    margin: 0 auto;
  }

  .site-footer .footer-links {
    display: flex;
    justify-content: center;
    gap: 2rem;
    margin-bottom: 2rem;
    flex-wrap: wrap;
  }

  .site-footer .footer-links a {
    color: rgba(255, 255, 255, 0.8);
    text-decoration: none;
    transition: color 0.3s;
  }

  .site-footer .footer-links a:hover {
    color: white;
  }

  .site-footer .footer-text {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.875rem;
  }

  /* Adjust content for fixed nav */
  body {
    padding-top: 160px;
  }

  /* Just the Docs theme adjustments */
  .site-header {
    margin-top: 0 !important;
  }

  /* Mobile responsive */
  @media (max-width: 968px) {
    .menu-toggle {
      display: flex;
    }

    .main-nav .nav-links {
      position: fixed;
      top: 160px;
      left: 0;
      right: 0;
      background: white;
      flex-direction: column;
      padding: 2rem;
      border-bottom: 1px solid var(--border);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transform: translateY(-100%);
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      gap: 1.5rem;
      align-items: flex-start;
      max-height: calc(100vh - 160px);
      overflow-y: auto;
    }

    .main-nav .nav-links.active {
      transform: translateY(0);
      opacity: 1;
      visibility: visible;
    }

    .main-nav .nav-links .nav-link {
      width: 100%;
      padding: 0.75rem 0;
      border-bottom: 1px solid var(--border);
    }

    .main-nav .nav-links .nav-link::after {
      display: none;
    }

    .main-nav .nav-links .github-icon {
      width: 100%;
      justify-content: flex-start;
      margin-left: 0;
      padding: 0.75rem 0;
      border-bottom: 1px solid var(--border);
    }

    .main-nav .logo-img {
      height: 120px;
    }

    .site-footer .footer-links {
      flex-direction: column;
      gap: 1rem;
    }
  }

  /* Tablet adjustments */
  @media (max-width: 968px) and (min-width: 769px) {
    .main-nav .nav-links {
      gap: 1rem;
    }

    .main-nav .nav-links .nav-link {
      font-size: 0.9rem;
    }
  }
</style>

<style>
  body { padding-top: 160px !important; }
  .main-nav { z-index: 1000; position: fixed; top: 0; width: 100%; }
  #header-template { display: none; }
  
  /* Ensure footer spans full width and breaks out of containers */
  .site-footer {
    position: relative !important;
    width: 100vw !important;
    max-width: 100vw !important;
    margin-left: calc(-50vw + 50%) !important;
    margin-right: calc(-50vw + 50%) !important;
    left: 0 !important;
    right: 0 !important;
    clear: both !important;
    z-index: 100 !important;
    box-sizing: border-box !important;
  }
</style>
<!-- Hidden template for header injection -->
<div id="header-template" style="display: none;">
  <!-- Site Header - Consistent across all pages -->
<nav class="main-nav">
    <div class="nav-container">
        <a href="/trustweave/" class="logo">
            <img src="/trustweave/assets/images/trustweave-logo.jpg" alt="TrustWeave Logo" class="logo-img">
        </a>
        <div class="menu-toggle" id="menuToggle" aria-label="Toggle menu">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="nav-links" id="navLinks">
            <a href="/trustweave/" class="nav-link">Home</a>
            <a href="/trustweave/#features" class="nav-link">Features</a>
            <a href="/trustweave/use-scenarios/" class="nav-link">Use Scenarios</a>
            <a href="/trustweave/getting-started/README/" class="nav-link">Docs</a>
            <a href="/trustweave/partnership/" class="nav-link">Partners</a>
            <a href="/trustweave/about/" class="nav-link">About</a>
            <a href="https://github.com/geoknoesis/TrustWeave" target="_blank" rel="noopener noreferrer" class="github-icon" title="View on GitHub" aria-label="GitHub Repository">
                <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
            </a>
        </div>
    </div>
</nav>
<script>
    // Mobile menu toggle and active page highlighting
    (function() {
        const menuToggle = document.getElementById('menuToggle');
        const navLinks = document.getElementById('navLinks');
        
        // Mobile menu toggle
        if (menuToggle && navLinks) {
            menuToggle.addEventListener('click', () => {
                navLinks.classList.toggle('active');
                menuToggle.classList.toggle('active');
            });
            
            // Close menu when clicking on a link
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.addEventListener('click', () => {
                    navLinks.classList.remove('active');
                    menuToggle.classList.remove('active');
                });
            });
            
            // Close menu when clicking outside
            document.addEventListener('click', (e) => {
                if (!menuToggle.contains(e.target) && !navLinks.contains(e.target)) {
                    navLinks.classList.remove('active');
                    menuToggle.classList.remove('active');
                }
            });
        }

        // Highlight active page
        const currentPath = window.location.pathname;
        const navLinksList = document.querySelectorAll('.nav-links .nav-link');
        
        navLinksList.forEach(link => {
            try {
                const linkUrl = new URL(link.href, window.location.origin);
                const linkPath = linkUrl.pathname;
                const baseUrl = '/trustweave' || '';
                
                // Normalize paths
                let cleanCurrentPath = currentPath.replace(baseUrl, '').replace(/\/$/, '') || '/';
                let cleanLinkPath = linkPath.replace(baseUrl, '').replace(/\/$/, '') || '/';
                
                // Handle index pages
                if (cleanCurrentPath === '' || cleanCurrentPath === '/index.html') cleanCurrentPath = '/';
                if (cleanLinkPath === '' || cleanLinkPath === '/index.html') cleanLinkPath = '/';
                
                // Check if current path matches link path
                if (cleanCurrentPath === cleanLinkPath) {
                    link.classList.add('active');
                } else if (cleanLinkPath !== '/' && cleanCurrentPath.startsWith(cleanLinkPath + '/')) {
                    // Handle sub-pages (e.g., /introduction/ matches /introduction/README/)
                    link.classList.add('active');
                }
            } catch (e) {
                // Fallback for relative URLs or errors
                const href = link.getAttribute('href');
                if (href && (currentPath.includes(href) || (href === '/' && currentPath.endsWith('index.html')))) {
                    link.classList.add('active');
                }
            }
        });
    })();
</script>


</div>
<script>
  // Move header from template to body top
  document.addEventListener('DOMContentLoaded', function() {
    const template = document.getElementById('header-template');
    if (template) {
      const header = template.querySelector('.main-nav');
      if (header) {
        document.body.insertBefore(header, document.body.firstChild);
        template.remove();
      }
    }
  });
</script>


</head>

<body>
  <a class="skip-to-main" href="#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  
    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>

  
  
    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>

  
</svg>

  
    <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="/trustweave/" class="site-title lh-tight">
  TrustWeave Developer Documentation

</a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </button>
  </div>

  <nav aria-label="Main" id="site-nav" class="site-nav">
  
  
    <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Introduction category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/introduction/README/" class="nav-list-link">Introduction</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/introduction/what-is-trustweave/" class="nav-list-link">What is TrustWeave?</a></li><li class="nav-list-item"><a href="/trustweave/introduction/executive-overview/" class="nav-list-link">Executive Overview: TrustWeave</a></li><li class="nav-list-item"><a href="/trustweave/introduction/key-features/" class="nav-list-link">Key Features</a></li><li class="nav-list-item"><a href="/trustweave/introduction/use-cases/" class="nav-list-link">Use Cases</a></li><li class="nav-list-item"><a href="/trustweave/introduction/architecture-overview/" class="nav-list-link">Architecture Overview</a></li><li class="nav-list-item"><a href="/trustweave/introduction/mental-model/" class="nav-list-link">TrustWeave Mental Model</a></li><li class="nav-list-item"><a href="/trustweave/introduction/web-of-trust/" class="nav-list-link">The Web of Trust: Foundation for Decentralized Trust</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Getting Started category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/getting-started/README/" class="nav-list-link">Getting Started</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/getting-started/installation/" class="nav-list-link">Installation</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/quick-start/" class="nav-list-link">Quick Start</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/your-first-application/" class="nav-list-link">Your First Application</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/project-setup/" class="nav-list-link">Project Setup</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/ide-setup/" class="nav-list-link">IDE Setup Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/common-patterns/" class="nav-list-link">Common Patterns</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/api-patterns/" class="nav-list-link">API Patterns and Best Practices</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/workflows/" class="nav-list-link">Common Workflows</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/dsl-guide/" class="nav-list-link">TrustWeave DSL Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/troubleshooting/" class="nav-list-link">Troubleshooting Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/production-deployment/" class="nav-list-link">Production Deployment Guide</a></li></ul></li><li class="nav-list-item"><a href="/trustweave/tutorials/README/" class="nav-list-link">Tutorials</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in How-To Guides category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/how-to/README/" class="nav-list-link">How-To Guides</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/how-to/create-dids/" class="nav-list-link">Create and Manage DIDs</a></li><li class="nav-list-item"><a href="/trustweave/how-to/issue-credentials/" class="nav-list-link">Issue Credentials</a></li><li class="nav-list-item"><a href="/trustweave/how-to/verify-credentials/" class="nav-list-link">Verify Credentials</a></li><li class="nav-list-item"><a href="/trustweave/how-to/manage-wallets/" class="nav-list-link">Manage Wallets</a></li><li class="nav-list-item"><a href="/trustweave/how-to/blockchain-anchoring/" class="nav-list-link">Anchor to Blockchain</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Core Concepts category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/core-concepts/README/" class="nav-list-link">Core Concepts</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/core-concepts/dids/" class="nav-list-link">Decentralized Identifiers (DIDs)</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/verifiable-credentials/" class="nav-list-link">Verifiable Credentials (VCs)</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/wallets/" class="nav-list-link">Wallets</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/blockchain-anchoring/" class="nav-list-link">Blockchain Anchoring</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/smart-contracts/" class="nav-list-link">Smart Contracts</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/key-management/" class="nav-list-link">Key Management</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in API Reference category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/api-reference/README/" class="nav-list-link">API Reference</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/api-reference/quick-reference/" class="nav-list-link">Quick Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/error-types/" class="nav-list-link">Error Types</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/data-types/" class="nav-list-link">Data Types</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/core-api/" class="nav-list-link">Core API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/wallet-api/" class="nav-list-link">Wallet API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/credential-service-api/" class="nav-list-link">Credential Service API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/smart-contract-api/" class="nav-list-link">Smart Contract API Reference</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Reference category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/reference/README/" class="nav-list-link">Reference</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/modules/core-modules/" class="nav-list-link">Core Modules</a></li><li class="nav-list-item"><a href="/trustweave/faq/" class="nav-list-link">Frequently Asked Questions</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Advanced Topics category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/advanced/README/" class="nav-list-link">Advanced Topics</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/advanced/error-handling/" class="nav-list-link">Error Handling</a></li></ul></li><li class="nav-list-item"><a href="/trustweave/integrations/README/" class="nav-list-link">Integration Modules</a></li><li class="nav-list-item"><a href="/trustweave/contributing/README/" class="nav-list-link">Contributing to TrustWeave</a></li></ul>
  
</nav>




  
  
    <footer class="site-footer">
      This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.
    </footer>
  
</div>

  
  <div class="main" id="top">
    <div id="main-header" class="main-header">
  
    

<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search TrustWeave Developer Documentation" aria-label="Search TrustWeave Developer Documentation" autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>

  
  
  
</div>

    <div class="main-content-wrap">
      
      <div id="main-content" class="main-content">
        <main>
          
            <h1 id="soc2-compliance-with-trustweave">
  
  
    <a href="#soc2-compliance-with-trustweave" class="anchor-heading" aria-labelledby="soc2-compliance-with-trustweave"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SOC2 Compliance with TrustWeave
  
  
</h1>
    

<p>This guide demonstrates how to build a SOC2 Type II compliant system using TrustWeave. You’ll learn how to create immutable audit trails, implement access control with verifiable credentials, manage keys securely, and automate compliance reporting.</p>
<h2 id="what-youll-build">
  
  
    <a href="#what-youll-build" class="anchor-heading" aria-labelledby="what-youll-build"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What You’ll Build
  
  
</h2>
    

<p>By the end of this tutorial, you’ll have:</p>

<ul>
  <li>✅ Created DIDs for employees, administrators, and auditors</li>
  <li>✅ Issued verifiable credentials for access control (roles, permissions)</li>
  <li>✅ Built immutable audit trails using blockchain anchoring</li>
  <li>✅ Implemented key rotation with credential history preservation</li>
  <li>✅ Created change management credentials for system modifications</li>
  <li>✅ Built automated compliance reporting</li>
  <li>✅ Demonstrated incident response with verifiable evidence</li>
</ul>
<h2 id="big-picture--significance">
  
  
    <a href="#big-picture--significance" class="anchor-heading" aria-labelledby="big-picture--significance"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Big Picture &amp; Significance
  
  
</h2>
    
<h3 id="the-soc2-compliance-challenge">
  
  
    <a href="#the-soc2-compliance-challenge" class="anchor-heading" aria-labelledby="the-soc2-compliance-challenge"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The SOC2 Compliance Challenge
  
  
</h3>
    

<p>SOC2 (System and Organization Controls 2) is a framework ensuring service organizations securely manage data. Achieving SOC2 Type II certification requires comprehensive controls for security, availability, processing integrity, confidentiality, and privacy.</p>

<p><strong>Industry Context:</strong></p>
<ul>
  <li><strong>Market Requirement</strong>: SOC2 Type II required by enterprise customers</li>
  <li><strong>Audit Costs</strong>: SOC2 audits cost $50,000-$200,000+ annually</li>
  <li><strong>Compliance Burden</strong>: Manual compliance processes are time-consuming</li>
  <li><strong>Trust Gap</strong>: Customers need proof of security controls</li>
  <li><strong>Regulatory Pressure</strong>: Increasing requirements for data protection</li>
</ul>

<p><strong>Why This Matters:</strong></p>
<ol>
  <li><strong>Customer Trust</strong>: SOC2 certification builds customer confidence</li>
  <li><strong>Market Access</strong>: Required for enterprise sales</li>
  <li><strong>Risk Reduction</strong>: Reduces security and compliance risks</li>
  <li><strong>Automation</strong>: Automated compliance reduces audit costs</li>
  <li><strong>Audit Trails</strong>: Immutable audit logs satisfy auditor requirements</li>
  <li><strong>Transparency</strong>: Verifiable proof of security controls</li>
</ol>
<h3 id="the-soc2-compliance-problem">
  
  
    <a href="#the-soc2-compliance-problem" class="anchor-heading" aria-labelledby="the-soc2-compliance-problem"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The SOC2 Compliance Problem
  
  
</h3>
    

<p>Traditional SOC2 compliance faces critical issues:</p>
<ul>
  <li><strong>Manual Processes</strong>: Time-consuming manual compliance checks</li>
  <li><strong>Audit Trail Gaps</strong>: Incomplete or tamperable audit logs</li>
  <li><strong>Key Management</strong>: Complex key rotation and history tracking</li>
  <li><strong>Access Control</strong>: Difficult to prove access control enforcement</li>
  <li><strong>Change Management</strong>: Hard to track and verify system changes</li>
  <li><strong>Compliance Reporting</strong>: Manual report generation is error-prone</li>
</ul>
<h2 id="value-proposition">
  
  
    <a href="#value-proposition" class="anchor-heading" aria-labelledby="value-proposition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Value Proposition
  
  
</h2>
    
<h3 id="problems-solved">
  
  
    <a href="#problems-solved" class="anchor-heading" aria-labelledby="problems-solved"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Problems Solved
  
  
</h3>
    

<ol>
  <li><strong>Immutable Audit Trails</strong>: Blockchain-anchored audit logs cannot be tampered with</li>
  <li><strong>Automated Compliance</strong>: Automated compliance checks and reporting</li>
  <li><strong>Access Control Proof</strong>: Verifiable credentials prove access control enforcement</li>
  <li><strong>Key Management</strong>: Secure key rotation with credential history preservation</li>
  <li><strong>Change Tracking</strong>: Verifiable credentials for all system changes</li>
  <li><strong>Incident Response</strong>: Cryptographic proof of incident handling</li>
  <li><strong>Auditor Confidence</strong>: Verifiable proof satisfies auditor requirements</li>
</ol>
<h3 id="business-benefits">
  
  
    <a href="#business-benefits" class="anchor-heading" aria-labelledby="business-benefits"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Business Benefits
  
  
</h3>
    

<p><strong>For Service Organizations:</strong></p>
<ul>
  <li><strong>Cost Reduction</strong>: 60-80% reduction in compliance costs</li>
  <li><strong>Faster Audits</strong>: Automated evidence collection speeds up audits</li>
  <li><strong>Risk Reduction</strong>: Immutable audit trails reduce compliance risk</li>
  <li><strong>Market Access</strong>: SOC2 certification enables enterprise sales</li>
  <li><strong>Trust</strong>: Build customer trust through verifiable security</li>
</ul>

<p><strong>For Auditors:</strong></p>
<ul>
  <li><strong>Evidence Quality</strong>: High-quality, verifiable evidence</li>
  <li><strong>Efficiency</strong>: Automated evidence collection</li>
  <li><strong>Confidence</strong>: Cryptographic proof of controls</li>
  <li><strong>Transparency</strong>: Complete audit trail visibility</li>
</ul>

<p><strong>For Customers:</strong></p>
<ul>
  <li><strong>Trust</strong>: Verifiable proof of security controls</li>
  <li><strong>Transparency</strong>: Clear visibility into security practices</li>
  <li><strong>Confidence</strong>: Cryptographic assurance of data protection</li>
</ul>
<h3 id="roi-considerations">
  
  
    <a href="#roi-considerations" class="anchor-heading" aria-labelledby="roi-considerations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ROI Considerations
  
  
</h3>
    

<ul>
  <li><strong>Audit Cost Reduction</strong>: 60-80% reduction in audit preparation costs</li>
  <li><strong>Compliance Automation</strong>: 70% reduction in manual compliance work</li>
  <li><strong>Risk Mitigation</strong>: Reduced risk of compliance failures</li>
  <li><strong>Market Access</strong>: SOC2 certification enables enterprise sales</li>
  <li><strong>Customer Trust</strong>: Increased customer confidence and retention</li>
</ul>
<h2 id="understanding-the-problem">
  
  
    <a href="#understanding-the-problem" class="anchor-heading" aria-labelledby="understanding-the-problem"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Understanding the Problem
  
  
</h2>
    

<p>SOC2 Type II requires:</p>

<ol>
  <li><strong>Security (CC)</strong>: Protection against unauthorized access</li>
  <li><strong>Availability (A1)</strong>: System availability for operation</li>
  <li><strong>Processing Integrity (PI)</strong>: Complete, valid, accurate processing</li>
  <li><strong>Confidentiality (C1)</strong>: Protection of confidential information</li>
  <li><strong>Privacy (P1-P9)</strong>: Proper handling of personal information</li>
</ol>

<p><strong>Key Controls:</strong></p>
<ul>
  <li><strong>CC6</strong>: Logical and physical access controls</li>
  <li><strong>CC7</strong>: System operations and monitoring</li>
  <li><strong>A1</strong>: Availability controls</li>
  <li><strong>PI</strong>: Processing integrity controls</li>
  <li><strong>C1</strong>: Confidentiality controls</li>
</ul>
<h2 id="how-it-works-the-soc2-compliance-flow">
  
  
    <a href="#how-it-works-the-soc2-compliance-flow" class="anchor-heading" aria-labelledby="how-it-works-the-soc2-compliance-flow"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How It Works: The SOC2 Compliance Flow
  
  
</h2>
    

<pre><code class="language-mermaid">flowchart TD
    A["Employee&lt;br/&gt;Receives Access Credential&lt;br/&gt;Role: Admin, User, Auditor"] --&gt;|stores| B["Employee Wallet&lt;br/&gt;Stores access credentials&lt;br/&gt;Maintains privacy&lt;br/&gt;Controls disclosure"]
    C["System Operation&lt;br/&gt;Credential Issuance&lt;br/&gt;Access Control&lt;br/&gt;Key Rotation"] --&gt;|logged| D["Audit Log&lt;br/&gt;Immutable record&lt;br/&gt;Blockchain anchored&lt;br/&gt;Tamper-proof"]
    B --&gt;|presents| E["System Access&lt;br/&gt;Verifies credential&lt;br/&gt;Enforces permissions&lt;br/&gt;Logs access"]
    E --&gt;|triggers| D
    D --&gt;|anchored| F["Blockchain&lt;br/&gt;Immutable proof&lt;br/&gt;Auditor verification&lt;br/&gt;Compliance evidence"]
    
    style A fill:#1976d2,stroke:#0d47a1,stroke-width:2px,color:#fff
    style B fill:#388e3c,stroke:#1b5e20,stroke-width:2px,color:#fff
    style C fill:#f57c00,stroke:#e65100,stroke-width:2px,color:#fff
    style D fill:#c2185b,stroke:#880e4f,stroke-width:2px,color:#fff
    style E fill:#7b1fa2,stroke:#4a148c,stroke-width:2px,color:#fff
    style F fill:#00796b,stroke:#004d40,stroke-width:2px,color:#fff
</code></pre>
<h2 id="prerequisites">
  
  
    <a href="#prerequisites" class="anchor-heading" aria-labelledby="prerequisites"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prerequisites
  
  
</h2>
    

<ul>
  <li>Java 21+</li>
  <li>Kotlin 2.2.0+</li>
  <li>Gradle 8.5+</li>
  <li>Basic understanding of Kotlin and coroutines</li>
  <li>Understanding of SOC2 requirements</li>
</ul>
<h2 id="step-1-add-dependencies">
  
  
    <a href="#step-1-add-dependencies" class="anchor-heading" aria-labelledby="step-1-add-dependencies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 1: Add Dependencies
  
  
</h2>
    

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="nf">dependencies</span> <span class="p">{</span>
    <span class="c1">// Core TrustWeave modules</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"com.trustweave:trustweave-all:1.0.0-SNAPSHOT"</span><span class="p">)</span>
    
    <span class="c1">// Test kit for in-memory implementations</span>
    <span class="nf">testImplementation</span><span class="p">(</span><span class="s">"com.trustweave:trustweave-testkit:1.0.0-SNAPSHOT"</span><span class="p">)</span>
    
    <span class="c1">// Optional: Algorand adapter for real blockchain anchoring</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"com.trustweave.chains:algorand:1.0.0-SNAPSHOT"</span><span class="p">)</span>
    
    <span class="c1">// Kotlinx Serialization</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"org.jetbrains.kotlinx:kotlinx-serialization-json:1.6.0"</span><span class="p">)</span>
    
    <span class="c1">// Coroutines</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3"</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-2-complete-runnable-example">
  
  
    <a href="#step-2-complete-runnable-example" class="anchor-heading" aria-labelledby="step-2-complete-runnable-example"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 2: Complete Runnable Example
  
  
</h2>
    

<p>Here’s a complete SOC2 compliance workflow:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
</pre></td><td class="rouge-code"><pre><span class="k">package</span> <span class="nn">com.example.soc2.compliance</span>

<span class="k">import</span> <span class="nn">com.trustweave.TrustWeave</span>
<span class="k">import</span> <span class="nn">com.trustweave.core.*</span>
<span class="k">import</span> <span class="nn">com.trustweave.json.DigestUtils</span>
<span class="k">import</span> <span class="nn">kotlinx.coroutines.runBlocking</span>
<span class="k">import</span> <span class="nn">kotlinx.serialization.json.*</span>
<span class="k">import</span> <span class="nn">java.time.Instant</span>
<span class="k">import</span> <span class="nn">java.time.temporal.ChronoUnit</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">=</span> <span class="nf">runBlocking</span> <span class="p">{</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"="</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"SOC2 Compliance Scenario - Complete Example"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"="</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
    
    <span class="c1">// Step 1: Create TrustWeave instance</span>
    <span class="kd">val</span> <span class="py">TrustWeave</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n✅ TrustWeave initialized"</span><span class="p">)</span>
    
    <span class="c1">// Step 2: Create DIDs for organization, employees, and auditors</span>
    <span class="kd">val</span> <span class="py">organizationDid</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">result</span> <span class="p">=</span> <span class="nc">Result</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">organizationDid</span><span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">it</span> <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Failed to create organization DID: ${error.message}"</span><span class="p">)</span>
            <span class="k">return</span><span class="nd">@runBlocking</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="kd">val</span> <span class="py">adminDid</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>
    <span class="nc">Result</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">adminDid</span><span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">it</span> <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Failed to create admin DID: ${error.message}"</span><span class="p">)</span>
            <span class="k">return</span><span class="nd">@runBlocking</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="kd">val</span> <span class="py">employeeDid</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>
    <span class="nc">Result</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">employeeDid</span><span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">it</span> <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Failed to create employee DID: ${error.message}"</span><span class="p">)</span>
            <span class="k">return</span><span class="nd">@runBlocking</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="kd">val</span> <span class="py">auditorDid</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>
    <span class="nc">Result</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">auditorDid</span><span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">it</span> <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Failed to create auditor DID: ${error.message}"</span><span class="p">)</span>
            <span class="k">return</span><span class="nd">@runBlocking</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Organization DID: ${organizationDid.id}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Admin DID: ${adminDid.id}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Employee DID: ${employeeDid.id}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Auditor DID: ${auditorDid.id}"</span><span class="p">)</span>
    
    <span class="c1">// Step 3: Issue access control credentials (CC6.1, CC6.2, CC6.3)</span>
    <span class="kd">val</span> <span class="py">orgKeyId</span> <span class="p">=</span> <span class="n">organizationDid</span><span class="p">.</span><span class="n">verificationMethod</span><span class="p">.</span><span class="nf">firstOrNull</span><span class="p">()</span><span class="o">?.</span><span class="n">id</span>
        <span class="o">?:</span> <span class="nf">error</span><span class="p">(</span><span class="s">"No verification method found"</span><span class="p">)</span>
    
    <span class="c1">// Admin access credential</span>
    <span class="kd">val</span> <span class="py">adminAccessCredential</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">issueCredential</span><span class="p">(</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">organizationDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">issuerKeyId</span> <span class="p">=</span> <span class="n">orgKeyId</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">adminDid</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"role"</span><span class="p">,</span> <span class="s">"Administrator"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"permissions"</span><span class="p">,</span> <span class="nf">buildJsonArray</span> <span class="p">{</span>
                <span class="nf">add</span><span class="p">(</span><span class="s">"credential:issue"</span><span class="p">)</span>
                <span class="nf">add</span><span class="p">(</span><span class="s">"credential:revoke"</span><span class="p">)</span>
                <span class="nf">add</span><span class="p">(</span><span class="s">"did:create"</span><span class="p">)</span>
                <span class="nf">add</span><span class="p">(</span><span class="s">"key:rotate"</span><span class="p">)</span>
                <span class="nf">add</span><span class="p">(</span><span class="s">"audit:read"</span><span class="p">)</span>
                <span class="nf">add</span><span class="p">(</span><span class="s">"audit:export"</span><span class="p">)</span>
            <span class="p">})</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"issuedDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"expirationDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">plus</span><span class="p">(</span><span class="mi">365</span><span class="p">,</span> <span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">DAYS</span><span class="p">).</span><span class="nf">toString</span><span class="p">())</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span> <span class="s">"active"</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="n">types</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"AccessControlCredential"</span><span class="p">,</span> <span class="s">"SOC2AccessCredential"</span><span class="p">)</span>
    <span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">it</span> <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Failed to issue admin access credential: ${error.message}"</span><span class="p">)</span>
            <span class="k">return</span><span class="nd">@runBlocking</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Admin Access Credential issued: ${adminAccessCredential.id}"</span><span class="p">)</span>
    
    <span class="c1">// Employee access credential</span>
    <span class="kd">val</span> <span class="py">employeeAccessCredential</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">issueCredential</span><span class="p">(</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">organizationDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">issuerKeyId</span> <span class="p">=</span> <span class="n">orgKeyId</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">employeeDid</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"role"</span><span class="p">,</span> <span class="s">"User"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"permissions"</span><span class="p">,</span> <span class="nf">buildJsonArray</span> <span class="p">{</span>
                <span class="nf">add</span><span class="p">(</span><span class="s">"credential:verify"</span><span class="p">)</span>
                <span class="nf">add</span><span class="p">(</span><span class="s">"credential:query"</span><span class="p">)</span>
            <span class="p">})</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"issuedDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"expirationDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">plus</span><span class="p">(</span><span class="mi">365</span><span class="p">,</span> <span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">DAYS</span><span class="p">).</span><span class="nf">toString</span><span class="p">())</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span> <span class="s">"active"</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="n">types</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"AccessControlCredential"</span><span class="p">,</span> <span class="s">"SOC2AccessCredential"</span><span class="p">)</span>
    <span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">it</span> <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Failed to issue employee access credential: ${error.message}"</span><span class="p">)</span>
            <span class="k">return</span><span class="nd">@runBlocking</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Employee Access Credential issued: ${employeeAccessCredential.id}"</span><span class="p">)</span>
    
    <span class="c1">// Step 4: Create audit log entry (CC7.1, CC7.2)</span>
    <span class="kd">val</span> <span class="py">auditLogEntry</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="s">"audit-log-${Instant.now().toEpochMilli()}"</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"timestamp"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"userId"</span><span class="p">,</span> <span class="n">adminDid</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"action"</span><span class="p">,</span> <span class="s">"credential:issue"</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"resourceType"</span><span class="p">,</span> <span class="s">"credential"</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"resourceId"</span><span class="p">,</span> <span class="n">adminAccessCredential</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"result"</span><span class="p">,</span> <span class="s">"success"</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"ipAddress"</span><span class="p">,</span> <span class="s">"192.168.1.100"</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"userAgent"</span><span class="p">,</span> <span class="s">"TrustWeave-Client/1.0"</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"details"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"credentialType"</span><span class="p">,</span> <span class="s">"AccessControlCredential"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"role"</span><span class="p">,</span> <span class="s">"Administrator"</span><span class="p">)</span>
        <span class="p">})</span>
    <span class="p">}</span>
    
    <span class="c1">// Anchor audit log to blockchain for immutability</span>
    <span class="kd">val</span> <span class="py">auditAnchorResult</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">blockchains</span><span class="p">.</span><span class="nf">anchor</span><span class="p">(</span>
        <span class="n">data</span> <span class="p">=</span> <span class="n">auditLogEntry</span><span class="p">,</span>
        <span class="n">serializer</span> <span class="p">=</span> <span class="nc">JsonObject</span><span class="p">.</span><span class="nf">serializer</span><span class="p">(),</span>
        <span class="n">chainId</span> <span class="p">=</span> <span class="s">"algorand:testnet"</span>
    <span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">anchor</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Audit log anchored: ${anchor.ref.txHash}"</span><span class="p">)</span>
            <span class="n">anchor</span>
        <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"⚠️ Audit log anchoring failed: ${error.message}"</span><span class="p">)</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"   (Continuing without anchor - in production, this should alert)"</span><span class="p">)</span>
            <span class="k">null</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Audit log entry created and anchored"</span><span class="p">)</span>
    
    <span class="c1">// Step 5: Verify access control (CC6.3)</span>
    <span class="kd">val</span> <span class="py">adminVerification</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">verifyCredential</span><span class="p">(</span><span class="n">adminAccessCredential</span><span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">it</span> <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Admin credential verification failed: ${error.message}"</span><span class="p">)</span>
            <span class="k">return</span><span class="nd">@runBlocking</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="p">(!</span><span class="n">adminVerification</span><span class="p">.</span><span class="n">valid</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Admin credential invalid: ${adminVerification.errors}"</span><span class="p">)</span>
        <span class="k">return</span><span class="nd">@runBlocking</span>
    <span class="p">}</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Admin access credential verified"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Proof valid: ${adminVerification.proofValid}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Issuer valid: ${adminVerification.issuerValid}"</span><span class="p">)</span>
    
    <span class="c1">// Step 6: Key rotation with history preservation (CC7.3)</span>
    <span class="kd">val</span> <span class="py">newAdminDid</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>
    <span class="nc">Result</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">newAdminDid</span><span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">it</span> <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Failed to create new admin DID: ${error.message}"</span><span class="p">)</span>
            <span class="k">return</span><span class="nd">@runBlocking</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="c1">// Issue key rotation credential</span>
    <span class="kd">val</span> <span class="py">keyRotationCredential</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">issueCredential</span><span class="p">(</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">organizationDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">issuerKeyId</span> <span class="p">=</span> <span class="n">orgKeyId</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="s">"key-rotation-${Instant.now().toEpochMilli()}"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"type"</span><span class="p">,</span> <span class="s">"KeyRotation"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"oldKeyId"</span><span class="p">,</span> <span class="n">adminDid</span><span class="p">.</span><span class="n">verificationMethod</span><span class="p">.</span><span class="nf">firstOrNull</span><span class="p">()</span><span class="o">?.</span><span class="n">id</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"newKeyId"</span><span class="p">,</span> <span class="n">newAdminDid</span><span class="p">.</span><span class="n">verificationMethod</span><span class="p">.</span><span class="nf">firstOrNull</span><span class="p">()</span><span class="o">?.</span><span class="n">id</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"rotationDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"reason"</span><span class="p">,</span> <span class="s">"Scheduled rotation"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"rotationPolicy"</span><span class="p">,</span> <span class="s">"90-day rotation"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"oldKeyDeactivationDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">plus</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">DAYS</span><span class="p">).</span><span class="nf">toString</span><span class="p">())</span>
        <span class="p">},</span>
        <span class="n">types</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"KeyRotationCredential"</span><span class="p">,</span> <span class="s">"SOC2KeyManagementCredential"</span><span class="p">)</span>
    <span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">it</span> <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Failed to issue key rotation credential: ${error.message}"</span><span class="p">)</span>
            <span class="k">return</span><span class="nd">@runBlocking</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Key rotation credential issued: ${keyRotationCredential.id}"</span><span class="p">)</span>
    
    <span class="c1">// Anchor key rotation to blockchain</span>
    <span class="kd">val</span> <span class="py">keyRotationAnchor</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">blockchains</span><span class="p">.</span><span class="nf">anchor</span><span class="p">(</span>
        <span class="n">data</span> <span class="p">=</span> <span class="n">keyRotationCredential</span><span class="p">,</span>
        <span class="n">serializer</span> <span class="p">=</span> <span class="nc">VerifiableCredential</span><span class="p">.</span><span class="nf">serializer</span><span class="p">(),</span>
        <span class="n">chainId</span> <span class="p">=</span> <span class="s">"algorand:testnet"</span>
    <span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">anchor</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Key rotation anchored: ${anchor.ref.txHash}"</span><span class="p">)</span>
            <span class="n">anchor</span>
        <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"⚠️ Key rotation anchoring failed: ${error.message}"</span><span class="p">)</span>
            <span class="k">null</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="c1">// Step 7: Change management credential (CC7.4)</span>
    <span class="kd">val</span> <span class="py">changeManagementCredential</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">issueCredential</span><span class="p">(</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">organizationDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">issuerKeyId</span> <span class="p">=</span> <span class="n">orgKeyId</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="s">"change-${Instant.now().toEpochMilli()}"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"type"</span><span class="p">,</span> <span class="s">"SystemChange"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"changeType"</span><span class="p">,</span> <span class="s">"Configuration"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"description"</span><span class="p">,</span> <span class="s">"Updated KMS configuration"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"changeDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"approvedBy"</span><span class="p">,</span> <span class="n">adminDid</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"changeId"</span><span class="p">,</span> <span class="s">"CHG-2024-001"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"impact"</span><span class="p">,</span> <span class="s">"Low"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span> <span class="s">"Completed"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"rollbackPlan"</span><span class="p">,</span> <span class="s">"Revert to previous configuration"</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="n">types</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"ChangeManagementCredential"</span><span class="p">,</span> <span class="s">"SOC2ChangeCredential"</span><span class="p">)</span>
    <span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">it</span> <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Failed to issue change management credential: ${error.message}"</span><span class="p">)</span>
            <span class="k">return</span><span class="nd">@runBlocking</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Change management credential issued: ${changeManagementCredential.id}"</span><span class="p">)</span>
    
    <span class="c1">// Step 8: Incident response credential</span>
    <span class="kd">val</span> <span class="py">incidentCredential</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">issueCredential</span><span class="p">(</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">organizationDid</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">issuerKeyId</span> <span class="p">=</span> <span class="n">orgKeyId</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="s">"incident-${Instant.now().toEpochMilli()}"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"type"</span><span class="p">,</span> <span class="s">"SecurityIncident"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"severity"</span><span class="p">,</span> <span class="s">"Low"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"description"</span><span class="p">,</span> <span class="s">"Failed authentication attempt"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"incidentDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"detectedBy"</span><span class="p">,</span> <span class="s">"Monitoring System"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"response"</span><span class="p">,</span> <span class="s">"Access denied and logged"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span> <span class="s">"Resolved"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"resolutionDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">plus</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">MINUTES</span><span class="p">).</span><span class="nf">toString</span><span class="p">())</span>
        <span class="p">},</span>
        <span class="n">types</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"IncidentResponseCredential"</span><span class="p">,</span> <span class="s">"SOC2IncidentCredential"</span><span class="p">)</span>
    <span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">it</span> <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Failed to issue incident credential: ${error.message}"</span><span class="p">)</span>
            <span class="k">return</span><span class="nd">@runBlocking</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Incident response credential issued: ${incidentCredential.id}"</span><span class="p">)</span>
    
    <span class="c1">// Step 9: Compliance report generation</span>
    <span class="kd">val</span> <span class="py">complianceReport</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"reportId"</span><span class="p">,</span> <span class="s">"SOC2-REPORT-${Instant.now().toEpochMilli()}"</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"reportDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"reportPeriod"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"startDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">minus</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">DAYS</span><span class="p">).</span><span class="nf">toString</span><span class="p">())</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"endDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
        <span class="p">})</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"controls"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"CC6"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span> <span class="s">"Compliant"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"accessCredentialsIssued"</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"accessVerifications"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">})</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"CC7"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span> <span class="s">"Compliant"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"auditLogsAnchored"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"keyRotations"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"systemChanges"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">})</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"A1"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span> <span class="s">"Compliant"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"uptime"</span><span class="p">,</span> <span class="s">"99.9%"</span><span class="p">)</span>
            <span class="p">})</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"PI"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span> <span class="s">"Compliant"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"credentialVerifications"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">})</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"C1"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span> <span class="s">"Compliant"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"encryptionEnabled"</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"incidents"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"total"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"resolved"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"open"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">})</span>
    <span class="p">}</span>
    
    <span class="c1">// Anchor compliance report</span>
    <span class="kd">val</span> <span class="py">reportAnchor</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">blockchains</span><span class="p">.</span><span class="nf">anchor</span><span class="p">(</span>
        <span class="n">data</span> <span class="p">=</span> <span class="n">complianceReport</span><span class="p">,</span>
        <span class="n">serializer</span> <span class="p">=</span> <span class="nc">JsonObject</span><span class="p">.</span><span class="nf">serializer</span><span class="p">(),</span>
        <span class="n">chainId</span> <span class="p">=</span> <span class="s">"algorand:testnet"</span>
    <span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">anchor</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Compliance report anchored: ${anchor.ref.txHash}"</span><span class="p">)</span>
            <span class="n">anchor</span>
        <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"⚠️ Compliance report anchoring failed: ${error.message}"</span><span class="p">)</span>
            <span class="k">null</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n📊 SOC2 Compliance Summary:"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Access Control: ✅ Compliant"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Audit Logging: ✅ Compliant (${auditAnchorResult?.ref?.txHash?.take(20)}...)"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Key Management: ✅ Compliant (${keyRotationAnchor?.ref?.txHash?.take(20)}...)"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Change Management: ✅ Compliant"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Incident Response: ✅ Compliant"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Compliance Reporting: ✅ Compliant (${reportAnchor?.ref?.txHash?.take(20)}...)"</span><span class="p">)</span>
    
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n"</span> <span class="p">+</span> <span class="s">"="</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ SOC2 Compliance Scenario Complete!"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"="</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p><strong>Expected Output:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre>======================================================================
SOC2 Compliance Scenario - Complete Example
======================================================================

✅ TrustWeave initialized
✅ Organization DID: did:key:z6Mk...
✅ Admin DID: did:key:z6Mk...
✅ Employee DID: did:key:z6Mk...
✅ Auditor DID: did:key:z6Mk...
✅ Admin Access Credential issued: urn:uuid:...
✅ Employee Access Credential issued: urn:uuid:...
✅ Audit log anchored: tx_...
✅ Audit log entry created and anchored
✅ Admin access credential verified
   Proof valid: true
   Issuer valid: true
✅ Key rotation credential issued: urn:uuid:...
✅ Key rotation anchored: tx_...
✅ Change management credential issued: urn:uuid:...
✅ Incident response credential issued: urn:uuid:...
✅ Compliance report anchored: tx_...

📊 SOC2 Compliance Summary:
   Access Control: ✅ Compliant
   Audit Logging: ✅ Compliant (tx_...)
   Key Management: ✅ Compliant (tx_...)
   Change Management: ✅ Compliant
   Incident Response: ✅ Compliant
   Compliance Reporting: ✅ Compliant (tx_...)

======================================================================
✅ SOC2 Compliance Scenario Complete!
======================================================================
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-3-access-control-implementation">
  
  
    <a href="#step-3-access-control-implementation" class="anchor-heading" aria-labelledby="step-3-access-control-implementation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 3: Access Control Implementation
  
  
</h2>
    

<p>Implement role-based access control using verifiable credentials:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">checkAccess</span><span class="p">(</span>
    <span class="n">userId</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">action</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">accessCredential</span><span class="p">:</span> <span class="nc">VerifiableCredential</span>
<span class="p">):</span> <span class="nc">Boolean</span> <span class="p">{</span>
    <span class="c1">// Verify credential</span>
    <span class="kd">val</span> <span class="py">verification</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">verifyCredential</span><span class="p">(</span><span class="n">accessCredential</span><span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(!</span><span class="n">verification</span><span class="p">.</span><span class="n">valid</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span>
    
    <span class="c1">// Check expiration</span>
    <span class="kd">val</span> <span class="py">expirationDate</span> <span class="p">=</span> <span class="n">accessCredential</span><span class="p">.</span><span class="n">expirationDate</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">expirationDate</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">expirationDate</span><span class="p">).</span><span class="nf">isBefore</span><span class="p">(</span><span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">()))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">false</span>
    <span class="p">}</span>
    
    <span class="c1">// Extract permissions</span>
    <span class="kd">val</span> <span class="py">permissions</span> <span class="p">=</span> <span class="n">accessCredential</span><span class="p">.</span><span class="n">credentialSubject</span>
        <span class="p">.</span><span class="n">jsonObject</span><span class="p">[</span><span class="s">"permissions"</span><span class="p">]</span><span class="o">?.</span><span class="n">jsonArray</span>
        <span class="o">?.</span><span class="nf">map</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">jsonPrimitive</span><span class="p">.</span><span class="n">content</span> <span class="p">}</span>
        <span class="o">?:</span> <span class="nf">emptyList</span><span class="p">()</span>
    
    <span class="c1">// Check if user has permission</span>
    <span class="k">return</span> <span class="n">permissions</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="p">||</span> <span class="n">permissions</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="s">"*"</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-4-audit-logging-with-blockchain-anchoring">
  
  
    <a href="#step-4-audit-logging-with-blockchain-anchoring" class="anchor-heading" aria-labelledby="step-4-audit-logging-with-blockchain-anchoring"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 4: Audit Logging with Blockchain Anchoring
  
  
</h2>
    

<p>Create immutable audit trails:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre></td><td class="rouge-code"><pre><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">logAuditEvent</span><span class="p">(</span>
    <span class="n">userId</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">action</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">resourceType</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">resourceId</span><span class="p">:</span> <span class="nc">String</span><span class="p">?,</span>
    <span class="n">result</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">details</span><span class="p">:</span> <span class="nc">Map</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">,</span> <span class="nc">String</span><span class="p">&gt;</span> <span class="p">=</span> <span class="nf">emptyMap</span><span class="p">()</span>
<span class="p">):</span> <span class="nc">String</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">auditEntry</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="s">"audit-${Instant.now().toEpochMilli()}"</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"timestamp"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"userId"</span><span class="p">,</span> <span class="n">userId</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"action"</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"resourceType"</span><span class="p">,</span> <span class="n">resourceType</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"resourceId"</span><span class="p">,</span> <span class="n">resourceId</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"result"</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"details"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="n">details</span><span class="p">.</span><span class="nf">forEach</span> <span class="p">{</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="p">-&gt;</span>
                <span class="nf">put</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">})</span>
    <span class="p">}</span>
    
    <span class="c1">// Store in database for querying</span>
    <span class="nf">saveAuditLogToDatabase</span><span class="p">(</span><span class="n">auditEntry</span><span class="p">)</span>
    
    <span class="c1">// Anchor to blockchain for immutability</span>
    <span class="kd">val</span> <span class="py">anchorResult</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">blockchains</span><span class="p">.</span><span class="nf">anchor</span><span class="p">(</span>
        <span class="n">data</span> <span class="p">=</span> <span class="n">auditEntry</span><span class="p">,</span>
        <span class="n">serializer</span> <span class="p">=</span> <span class="nc">JsonObject</span><span class="p">.</span><span class="nf">serializer</span><span class="p">(),</span>
        <span class="n">chainId</span> <span class="p">=</span> <span class="s">"algorand:testnet"</span>
    <span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">it</span> <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="c1">// Alert on anchoring failure</span>
            <span class="nf">alertOnAnchoringFailure</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="k">null</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">anchorResult</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">entryId</span> <span class="p">=</span> <span class="n">auditEntry</span><span class="p">[</span><span class="s">"id"</span><span class="p">]</span><span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span> <span class="o">?:</span> <span class="nf">error</span><span class="p">(</span><span class="s">"Missing audit entry ID"</span><span class="p">)</span>
        <span class="nf">updateAuditLogWithAnchor</span><span class="p">(</span><span class="n">entryId</span><span class="p">,</span> <span class="n">anchorResult</span><span class="p">.</span><span class="n">ref</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">auditEntry</span><span class="p">[</span><span class="s">"id"</span><span class="p">]</span><span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span> <span class="o">?:</span> <span class="nf">error</span><span class="p">(</span><span class="s">"Missing audit entry ID"</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-5-key-rotation-with-history">
  
  
    <a href="#step-5-key-rotation-with-history" class="anchor-heading" aria-labelledby="step-5-key-rotation-with-history"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 5: Key Rotation with History
  
  
</h2>
    

<p>Preserve credential verification history during key rotation:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre></td><td class="rouge-code"><pre><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">rotateKeyWithHistory</span><span class="p">(</span>
    <span class="n">issuerDid</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="n">oldKeyId</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">):</span> <span class="nc">String</span> <span class="p">{</span>
    <span class="c1">// Create new key</span>
    <span class="kd">val</span> <span class="py">newDid</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">newKeyId</span> <span class="p">=</span> <span class="n">newDid</span><span class="p">.</span><span class="n">verificationMethod</span><span class="p">.</span><span class="nf">firstOrNull</span><span class="p">()</span><span class="o">?.</span><span class="n">id</span>
        <span class="o">?:</span> <span class="nf">error</span><span class="p">(</span><span class="s">"No verification method found"</span><span class="p">)</span>
    
    <span class="c1">// Issue rotation credential</span>
    <span class="kd">val</span> <span class="py">rotationCredential</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">issueCredential</span><span class="p">(</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">issuerDid</span><span class="p">,</span>
        <span class="n">issuerKeyId</span> <span class="p">=</span> <span class="n">oldKeyId</span><span class="p">,</span> <span class="c1">// Use old key to sign rotation</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="s">"rotation-${Instant.now().toEpochMilli()}"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"type"</span><span class="p">,</span> <span class="s">"KeyRotation"</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"oldKeyId"</span><span class="p">,</span> <span class="n">oldKeyId</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"newKeyId"</span><span class="p">,</span> <span class="n">newKeyId</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"rotationDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
        <span class="p">},</span>
        <span class="n">types</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"KeyRotationCredential"</span><span class="p">)</span>
    <span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>
    
    <span class="c1">// Anchor rotation to blockchain</span>
    <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">blockchains</span><span class="p">.</span><span class="nf">anchor</span><span class="p">(</span>
        <span class="n">data</span> <span class="p">=</span> <span class="n">rotationCredential</span><span class="p">,</span>
        <span class="n">serializer</span> <span class="p">=</span> <span class="nc">VerifiableCredential</span><span class="p">.</span><span class="nf">serializer</span><span class="p">(),</span>
        <span class="n">chainId</span> <span class="p">=</span> <span class="s">"algorand:testnet"</span>
    <span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">anchor</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Key rotation anchored: ${anchor.ref.txHash}"</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Key rotation anchoring failed: ${error.message}"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="c1">// Keep old key active for 90 days (grace period for credential verification)</span>
    <span class="nf">scheduleKeyDeactivation</span><span class="p">(</span><span class="n">oldKeyId</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">plus</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">DAYS</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">newKeyId</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-6-compliance-report-generation">
  
  
    <a href="#step-6-compliance-report-generation" class="anchor-heading" aria-labelledby="step-6-compliance-report-generation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 6: Compliance Report Generation
  
  
</h2>
    

<p>Generate automated compliance reports:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre></td><td class="rouge-code"><pre><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">generateComplianceReport</span><span class="p">(</span>
    <span class="n">startDate</span><span class="p">:</span> <span class="nc">Instant</span><span class="p">,</span>
    <span class="n">endDate</span><span class="p">:</span> <span class="nc">Instant</span>
<span class="p">):</span> <span class="nc">JsonObject</span> <span class="p">{</span>
    <span class="c1">// Query audit logs</span>
    <span class="kd">val</span> <span class="py">auditLogs</span> <span class="p">=</span> <span class="nf">queryAuditLogs</span><span class="p">(</span><span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span>
    
    <span class="c1">// Count operations by type</span>
    <span class="kd">val</span> <span class="py">operationsByType</span> <span class="p">=</span> <span class="n">auditLogs</span><span class="p">.</span><span class="nf">groupBy</span> <span class="p">{</span> 
        <span class="p">(</span><span class="n">it</span> <span class="k">as</span><span class="p">?</span> <span class="nc">JsonObject</span><span class="p">)</span><span class="o">?.</span><span class="k">get</span><span class="p">(</span><span class="s">"action"</span><span class="p">)</span><span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span> <span class="o">?:</span> <span class="s">"unknown"</span>
    <span class="p">}</span>
    
    <span class="c1">// Check control compliance</span>
    <span class="kd">val</span> <span class="py">controls</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"CC6"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span> <span class="nf">checkAccessControlCompliance</span><span class="p">(</span><span class="n">auditLogs</span><span class="p">))</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"accessCredentialsIssued"</span><span class="p">,</span> <span class="nf">countAccessCredentialsIssued</span><span class="p">(</span><span class="n">auditLogs</span><span class="p">))</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"accessVerifications"</span><span class="p">,</span> <span class="nf">countAccessVerifications</span><span class="p">(</span><span class="n">auditLogs</span><span class="p">))</span>
        <span class="p">})</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"CC7"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span> <span class="nf">checkSystemOperationsCompliance</span><span class="p">(</span><span class="n">auditLogs</span><span class="p">))</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"auditLogsAnchored"</span><span class="p">,</span> <span class="nf">countAnchoredAuditLogs</span><span class="p">(</span><span class="n">auditLogs</span><span class="p">))</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"keyRotations"</span><span class="p">,</span> <span class="nf">countKeyRotations</span><span class="p">(</span><span class="n">auditLogs</span><span class="p">))</span>
        <span class="p">})</span>
        <span class="c1">// ... additional controls</span>
    <span class="p">}</span>
    
    <span class="kd">val</span> <span class="py">report</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"reportId"</span><span class="p">,</span> <span class="s">"SOC2-REPORT-${Instant.now().toEpochMilli()}"</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"reportDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"reportPeriod"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"startDate"</span><span class="p">,</span> <span class="n">startDate</span><span class="p">.</span><span class="nf">toString</span><span class="p">())</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"endDate"</span><span class="p">,</span> <span class="n">endDate</span><span class="p">.</span><span class="nf">toString</span><span class="p">())</span>
        <span class="p">})</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"controls"</span><span class="p">,</span> <span class="n">controls</span><span class="p">)</span>
        <span class="nf">put</span><span class="p">(</span><span class="s">"summary"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"totalOperations"</span><span class="p">,</span> <span class="n">auditLogs</span><span class="p">.</span><span class="n">size</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"anchoredOperations"</span><span class="p">,</span> <span class="nf">countAnchoredAuditLogs</span><span class="p">(</span><span class="n">auditLogs</span><span class="p">))</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"complianceStatus"</span><span class="p">,</span> <span class="s">"Compliant"</span><span class="p">)</span>
        <span class="p">})</span>
    <span class="p">}</span>
    
    <span class="c1">// Anchor report to blockchain</span>
    <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">blockchains</span><span class="p">.</span><span class="nf">anchor</span><span class="p">(</span>
        <span class="n">data</span> <span class="p">=</span> <span class="n">report</span><span class="p">,</span>
        <span class="n">serializer</span> <span class="p">=</span> <span class="nc">JsonObject</span><span class="p">.</span><span class="nf">serializer</span><span class="p">(),</span>
        <span class="n">chainId</span> <span class="p">=</span> <span class="s">"algorand:testnet"</span>
    <span class="p">).</span><span class="nf">fold</span><span class="p">(</span>
        <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">anchor</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Compliance report anchored: ${anchor.ref.txHash}"</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="n">onFailure</span> <span class="p">=</span> <span class="p">{</span> <span class="n">error</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Report anchoring failed: ${error.message}"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="k">return</span> <span class="n">report</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="key-benefits">
  
  
    <a href="#key-benefits" class="anchor-heading" aria-labelledby="key-benefits"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Key Benefits
  
  
</h2>
    

<ol>
  <li><strong>Immutable Audit Trails</strong>: Blockchain-anchored logs cannot be tampered with</li>
  <li><strong>Automated Compliance</strong>: Automated compliance checks and reporting</li>
  <li><strong>Access Control Proof</strong>: Verifiable credentials prove access control enforcement</li>
  <li><strong>Key Management</strong>: Secure key rotation with credential history preservation</li>
  <li><strong>Change Tracking</strong>: Verifiable credentials for all system changes</li>
  <li><strong>Auditor Confidence</strong>: Verifiable proof satisfies auditor requirements</li>
</ol>
<h2 id="real-world-integration">
  
  
    <a href="#real-world-integration" class="anchor-heading" aria-labelledby="real-world-integration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Real-World Integration
  
  
</h2>
    

<p><strong>SOC2 Type II Certification:</strong></p>
<ul>
  <li>Use VCs for access control credentials</li>
  <li>Anchor all audit logs to blockchain</li>
  <li>Generate automated compliance reports</li>
  <li>Provide verifiable evidence to auditors</li>
</ul>

<p><strong>Enterprise KMS Integration:</strong></p>
<ul>
  <li>Integrate with AWS KMS, Azure Key Vault, or HSM</li>
  <li>Use enterprise KMS for key management</li>
  <li>Maintain key rotation history</li>
</ul>

<p><strong>Audit Trail Management:</strong></p>
<ul>
  <li>Store audit logs in database for querying</li>
  <li>Anchor audit logs to blockchain for immutability</li>
  <li>Provide auditor access to audit logs</li>
</ul>
<h2 id="next-steps">
  
  
    <a href="#next-steps" class="anchor-heading" aria-labelledby="next-steps"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Next Steps
  
  
</h2>
    

<ul>
  <li>Explore <a href="/trustweave/scenarios/security-clearance-access-control-scenario/">Security Clearance Scenario</a> for access control patterns</li>
  <li>Learn about <a href="/trustweave/core-concepts/blockchain-anchoring/">Blockchain Anchoring</a> for audit trails</li>
  <li>Review <a href="/trustweave/core-concepts/key-management/">Key Management</a> for key rotation</li>
  <li>See <a href="/trustweave/security/README/">Security Best Practices</a> for comprehensive security guidance</li>
</ul>
<h2 id="related-documentation">
  
  
    <a href="#related-documentation" class="anchor-heading" aria-labelledby="related-documentation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Related Documentation
  
  
</h2>
    

<ul>
  <li><a href="/trustweave/scenarios/security-clearance-access-control-scenario/">Security Clearance Scenario</a> - Access control patterns</li>
  <li><a href="/trustweave/core-concepts/blockchain-anchoring/">Blockchain Anchoring</a> - Anchoring concepts</li>
  <li><a href="/trustweave/core-concepts/key-management/">Key Management</a> - Key management guide</li>
  <li><a href="/trustweave/security/README/">Security Best Practices</a> - Comprehensive security guidance</li>
  <li><a href="/trustweave/api-reference/core-api/">API Reference</a> - Complete API documentation</li>
</ul>

          

          
            
          
        </main>
        

  <hr>
  <footer>
    

    <!-- Hidden template for footer injection -->
<div id="footer-template" style="display: none;">
  <!-- Site Footer - Consistent across all pages -->
<footer class="site-footer">
    <div class="footer-content">
        <div class="footer-links">
            <a href="/trustweave/">Home</a>
            <a href="/trustweave/getting-started/README/">Documentation</a>
            <a href="https://github.com/geoknoesis/TrustWeave" target="_blank">GitHub</a>
            <a href="/trustweave/partnership/">Partners</a>
            <a href="https://github.com/geoknoesis/TrustWeave/blob/main/docs/README.md" target="_blank">Docs</a>
            <a href="https://github.com/geoknoesis/TrustWeave/blob/main/LICENSE" target="_blank">License</a>
            <a href="https://www.geoknoesis.com" target="_blank">Geoknoesis LLC</a>
        </div>
        <p class="footer-text">Made with ❤️ by Geoknoesis LLC</p>
    </div>
</footer>


</div>
<script>
  // Move footer from template to body bottom and make it full width
  document.addEventListener('DOMContentLoaded', function() {
    const template = document.getElementById('footer-template');
    if (template) {
      const footer = template.querySelector('.site-footer');
      if (footer) {
        // Move footer to body level (outside of any containers)
        document.body.appendChild(footer);
        template.remove();
        
        // Ensure footer spans full width by removing any parent constraints
        footer.style.position = 'relative';
        footer.style.width = '100vw';
        footer.style.marginLeft = 'calc(-50vw + 50%)';
        footer.style.marginRight = 'calc(-50vw + 50%)';
      }
    }
  });
</script>


    
  </footer>


      </div>
    </div>
    
      

<div class="search-overlay"></div>

    
  </div>

  
    





<script type="module">
  
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.esm.min.mjs';
  

  var config = {}
;
  mermaid.initialize(config);
  mermaid.run({
    querySelector: '.language-mermaid',
  });
</script>



  
</body>
</html>

