

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/trustweave/assets/css/just-the-docs-default.css">

  <link rel="stylesheet" href="/trustweave/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet">

  <style id="jtd-nav-activation">

    .site-nav ul li a {
      background-image: none;
    }

  </style>




    <script src="/trustweave/assets/js/vendor/lunr.min.js"></script>


  <script src="/trustweave/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">





  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Zero Trust Continuous Authentication Scenario | TrustWeave Developer Documentation</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Zero Trust Continuous Authentication Scenario" />
<meta name="author" content="GeoKnoesis" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin" />
<meta property="og:description" content="Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin" />
<link rel="canonical" href="http://localhost:4000/trustweave/scenarios/zero-trust-authentication-scenario/" />
<meta property="og:url" content="http://localhost:4000/trustweave/scenarios/zero-trust-authentication-scenario/" />
<meta property="og:site_name" content="TrustWeave Developer Documentation" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Zero Trust Continuous Authentication Scenario" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"GeoKnoesis"},"description":"Comprehensive developer documentation for TrustWeave - A neutral, reusable trust and identity core library for Kotlin","headline":"Zero Trust Continuous Authentication Scenario","url":"http://localhost:4000/trustweave/scenarios/zero-trust-authentication-scenario/"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Main Navigation Styles - Consistent across all pages -->
<style>
  :root {
    --primary: #2563eb;
    --primary-dark: #1e40af;
    --secondary: #7c3aed;
    --accent: #10b981;
    --text: #1f2937;
    --text-light: #6b7280;
    --bg: #ffffff;
    --bg-light: #f9fafb;
    --border: #e5e7eb;
    --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }

  .main-nav {
    position: fixed;
    top: 0;
    width: 100%;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border);
    z-index: 1000;
    padding: 0.5rem 0;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  }

  .main-nav .nav-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .main-nav .logo {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    text-decoration: none;
    transition: opacity 0.3s;
  }

  .main-nav .logo-img {
    height: 120px;
    width: auto;
    transition: opacity 0.3s;
    display: block;
  }

  .main-nav .logo-img:not([src]),
  .main-nav .logo-img[src=""],
  .main-nav .logo-img[src*="undefined"] {
    display: none;
  }


  .main-nav .logo:hover {
    opacity: 0.8;
  }

  .main-nav .logo:hover .logo-img {
    opacity: 0.8;
  }

  .main-nav .nav-links {
    display: flex;
    gap: 1.5rem;
    align-items: center;
  }

  .main-nav .nav-links .nav-link {
    text-decoration: none;
    color: var(--text);
    font-weight: 500;
    font-size: 0.95rem;
    padding: 0.5rem 0;
    transition: color 0.3s;
    position: relative;
    white-space: nowrap;
  }

  .main-nav .nav-links .nav-link:hover {
    color: var(--primary);
  }

  .main-nav .nav-links .nav-link::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 2px;
    background: var(--primary);
    transition: width 0.3s ease;
  }

  .main-nav .nav-links .nav-link:hover::after,
  .main-nav .nav-links .nav-link.active::after {
    width: 100%;
  }

  .main-nav .nav-links .nav-link.active {
    color: var(--primary);
    font-weight: 600;
  }

  /* GitHub icon button */
  .main-nav .nav-links .github-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    border-radius: 0.5rem;
    transition: all 0.3s;
    padding: 0.5rem;
    color: var(--text);
    text-decoration: none;
    margin-left: 0.5rem;
  }

  .main-nav .nav-links .github-icon:hover {
    background: var(--bg-light);
    transform: translateY(-2px);
    color: var(--primary);
  }

  .main-nav .nav-links .github-icon svg {
    width: 32px;
    height: 32px;
  }

  /* Mobile menu toggle */
  .menu-toggle {
    display: none;
    flex-direction: column;
    cursor: pointer;
    gap: 5px;
    padding: 0.5rem;
    z-index: 1001;
  }

  .menu-toggle span {
    width: 25px;
    height: 3px;
    background: var(--text);
    transition: all 0.3s;
    border-radius: 2px;
  }

  .menu-toggle.active span:nth-child(1) {
    transform: rotate(45deg) translate(8px, 8px);
  }

  .menu-toggle.active span:nth-child(2) {
    opacity: 0;
  }

  .menu-toggle.active span:nth-child(3) {
    transform: rotate(-45deg) translate(7px, -7px);
  }

  /* Footer styles */
  .site-footer {
    background: var(--text);
    color: white;
    padding: 3rem 2rem;
    text-align: center;
    margin-top: 4rem;
  }

  .site-footer .footer-content {
    max-width: 1200px;
    margin: 0 auto;
  }

  .site-footer .footer-links {
    display: flex;
    justify-content: center;
    gap: 2rem;
    margin-bottom: 2rem;
    flex-wrap: wrap;
  }

  .site-footer .footer-links a {
    color: rgba(255, 255, 255, 0.8);
    text-decoration: none;
    transition: color 0.3s;
  }

  .site-footer .footer-links a:hover {
    color: white;
  }

  .site-footer .footer-text {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.875rem;
  }

  /* Adjust content for fixed nav */
  body {
    padding-top: 160px;
  }

  /* Just the Docs theme adjustments */
  .site-header {
    margin-top: 0 !important;
  }

  /* Mobile responsive */
  @media (max-width: 968px) {
    .menu-toggle {
      display: flex;
    }

    .main-nav .nav-links {
      position: fixed;
      top: 160px;
      left: 0;
      right: 0;
      background: white;
      flex-direction: column;
      padding: 2rem;
      border-bottom: 1px solid var(--border);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transform: translateY(-100%);
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      gap: 1.5rem;
      align-items: flex-start;
      max-height: calc(100vh - 160px);
      overflow-y: auto;
    }

    .main-nav .nav-links.active {
      transform: translateY(0);
      opacity: 1;
      visibility: visible;
    }

    .main-nav .nav-links .nav-link {
      width: 100%;
      padding: 0.75rem 0;
      border-bottom: 1px solid var(--border);
    }

    .main-nav .nav-links .nav-link::after {
      display: none;
    }

    .main-nav .nav-links .github-icon {
      width: 100%;
      justify-content: flex-start;
      margin-left: 0;
      padding: 0.75rem 0;
      border-bottom: 1px solid var(--border);
    }

    .main-nav .logo-img {
      height: 120px;
    }

    .site-footer .footer-links {
      flex-direction: column;
      gap: 1rem;
    }
  }

  /* Tablet adjustments */
  @media (max-width: 968px) and (min-width: 769px) {
    .main-nav .nav-links {
      gap: 1rem;
    }

    .main-nav .nav-links .nav-link {
      font-size: 0.9rem;
    }
  }
</style>

<style>
  body { padding-top: 160px !important; }
  .main-nav { z-index: 1000; position: fixed; top: 0; width: 100%; }
  #header-template { display: none; }

  /* Ensure footer spans full width and breaks out of containers */
  .site-footer {
    position: relative !important;
    width: 100vw !important;
    max-width: 100vw !important;
    margin-left: calc(-50vw + 50%) !important;
    margin-right: calc(-50vw + 50%) !important;
    left: 0 !important;
    right: 0 !important;
    clear: both !important;
    z-index: 100 !important;
    box-sizing: border-box !important;
  }
</style>
<!-- Hidden template for header injection -->
<div id="header-template" style="display: none;">
  <!-- Site Header - Consistent across all pages -->
<nav class="main-nav">
    <div class="nav-container">
        <a href="/trustweave/" class="logo">
            <img src="/trustweave/assets/images/trustweave-logo.jpg" alt="TrustWeave Logo" class="logo-img">
        </a>
        <div class="menu-toggle" id="menuToggle" aria-label="Toggle menu">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="nav-links" id="navLinks">
            <a href="/trustweave/" class="nav-link">Home</a>
            <a href="/trustweave/#features" class="nav-link">Features</a>
            <a href="/trustweave/use-scenarios/" class="nav-link">Use Scenarios</a>
            <a href="/trustweave/getting-started/README/" class="nav-link">Docs</a>
            <a href="/trustweave/partnership/" class="nav-link">Partners</a>
            <a href="/trustweave/about/" class="nav-link">About</a>
            <a href="https://github.com/geoknoesis/TrustWeave" target="_blank" rel="noopener noreferrer" class="github-icon" title="View on GitHub" aria-label="GitHub Repository">
                <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
            </a>
        </div>
    </div>
</nav>
<script>
    // Mobile menu toggle and active page highlighting
    (function() {
        const menuToggle = document.getElementById('menuToggle');
        const navLinks = document.getElementById('navLinks');

        // Mobile menu toggle
        if (menuToggle && navLinks) {
            menuToggle.addEventListener('click', () => {
                navLinks.classList.toggle('active');
                menuToggle.classList.toggle('active');
            });

            // Close menu when clicking on a link
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.addEventListener('click', () => {
                    navLinks.classList.remove('active');
                    menuToggle.classList.remove('active');
                });
            });

            // Close menu when clicking outside
            document.addEventListener('click', (e) => {
                if (!menuToggle.contains(e.target) && !navLinks.contains(e.target)) {
                    navLinks.classList.remove('active');
                    menuToggle.classList.remove('active');
                }
            });
        }

        // Highlight active page
        const currentPath = window.location.pathname;
        const navLinksList = document.querySelectorAll('.nav-links .nav-link');

        navLinksList.forEach(link => {
            try {
                const linkUrl = new URL(link.href, window.location.origin);
                const linkPath = linkUrl.pathname;
                const baseUrl = '/trustweave' || '';

                // Normalize paths
                let cleanCurrentPath = currentPath.replace(baseUrl, '').replace(/\/$/, '') || '/';
                let cleanLinkPath = linkPath.replace(baseUrl, '').replace(/\/$/, '') || '/';

                // Handle index pages
                if (cleanCurrentPath === '' || cleanCurrentPath === '/index.html') cleanCurrentPath = '/';
                if (cleanLinkPath === '' || cleanLinkPath === '/index.html') cleanLinkPath = '/';

                // Check if current path matches link path
                if (cleanCurrentPath === cleanLinkPath) {
                    link.classList.add('active');
                } else if (cleanLinkPath !== '/' && cleanCurrentPath.startsWith(cleanLinkPath + '/')) {
                    // Handle sub-pages (e.g., /introduction/ matches /introduction/README/)
                    link.classList.add('active');
                }
            } catch (e) {
                // Fallback for relative URLs or errors
                const href = link.getAttribute('href');
                if (href && (currentPath.includes(href) || (href === '/' && currentPath.endsWith('index.html')))) {
                    link.classList.add('active');
                }
            }
        });
    })();
</script>


</div>
<script>
  // Move header from template to body top
  document.addEventListener('DOMContentLoaded', function() {
    const template = document.getElementById('header-template');
    if (template) {
      const header = template.querySelector('.main-nav');
      if (header) {
        document.body.insertBefore(header, document.body.firstChild);
        template.remove();
      }
    }
  });
</script>


</head>

<body>
  <a class="skip-to-main" href="#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>


    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>



    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>


</svg>


    <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="/trustweave/" class="site-title lh-tight">
  TrustWeave Developer Documentation

</a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </button>
  </div>

  <nav aria-label="Main" id="site-nav" class="site-nav">


    <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Introduction category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/introduction/README/" class="nav-list-link">Introduction</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/introduction/what-is-trustweave/" class="nav-list-link">What is TrustWeave?</a></li><li class="nav-list-item"><a href="/trustweave/introduction/executive-overview/" class="nav-list-link">Executive Overview: TrustWeave</a></li><li class="nav-list-item"><a href="/trustweave/introduction/key-features/" class="nav-list-link">Key Features</a></li><li class="nav-list-item"><a href="/trustweave/introduction/use-cases/" class="nav-list-link">Use Cases</a></li><li class="nav-list-item"><a href="/trustweave/introduction/architecture-overview/" class="nav-list-link">Architecture Overview</a></li><li class="nav-list-item"><a href="/trustweave/introduction/mental-model/" class="nav-list-link">TrustWeave Mental Model</a></li><li class="nav-list-item"><a href="/trustweave/introduction/web-of-trust/" class="nav-list-link">The Web of Trust: Foundation for Decentralized Trust</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Getting Started category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/getting-started/README/" class="nav-list-link">Getting Started</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/getting-started/installation/" class="nav-list-link">Installation</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/quick-start/" class="nav-list-link">Quick Start</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/your-first-application/" class="nav-list-link">Your First Application</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/project-setup/" class="nav-list-link">Project Setup</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/ide-setup/" class="nav-list-link">IDE Setup Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/common-patterns/" class="nav-list-link">Common Patterns</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/api-patterns/" class="nav-list-link">API Patterns and Best Practices</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/workflows/" class="nav-list-link">Common Workflows</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/dsl-guide/" class="nav-list-link">TrustWeave DSL Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/troubleshooting/" class="nav-list-link">Troubleshooting Guide</a></li><li class="nav-list-item"><a href="/trustweave/getting-started/production-deployment/" class="nav-list-link">Production Deployment Guide</a></li></ul></li><li class="nav-list-item"><a href="/trustweave/tutorials/README/" class="nav-list-link">Tutorials</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in How-To Guides category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/how-to/README/" class="nav-list-link">How-To Guides</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/how-to/use-trustweave-facade/" class="nav-list-link">Use TrustWeave Facade for Quick Setup</a></li><li class="nav-list-item"><a href="/trustweave/how-to/configure-trustlayer/" class="nav-list-link">Configure TrustWeave</a></li><li class="nav-list-item"><a href="/trustweave/how-to/create-dids/" class="nav-list-link">Create and Manage DIDs</a></li><li class="nav-list-item"><a href="/trustweave/how-to/issue-credentials/" class="nav-list-link">Issue Credentials</a></li><li class="nav-list-item"><a href="/trustweave/how-to/verify-credentials/" class="nav-list-link">Verify Credentials</a></li><li class="nav-list-item"><a href="/trustweave/how-to/manage-wallets/" class="nav-list-link">Manage Wallets</a></li><li class="nav-list-item"><a href="/trustweave/how-to/blockchain-anchoring/" class="nav-list-link">Anchor to Blockchain</a></li><li class="nav-list-item"><a href="/trustweave/how-to/multi-chain-anchoring/" class="nav-list-link">Multi-Chain Anchoring Patterns</a></li><li class="nav-list-item"><a href="/trustweave/how-to/exchange-credentials/" class="nav-list-link">Exchange Credentials with Multiple Protocols</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Core Concepts category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/core-concepts/README/" class="nav-list-link">Core Concepts</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/core-concepts/dids/" class="nav-list-link">Decentralized Identifiers (DIDs)</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/verifiable-credentials/" class="nav-list-link">Verifiable Credentials (VCs)</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/wallets/" class="nav-list-link">Wallets</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/blockchain-anchoring/" class="nav-list-link">Blockchain Anchoring</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/smart-contracts/" class="nav-list-link">Smart Contracts</a></li><li class="nav-list-item"><a href="/trustweave/core-concepts/key-management/" class="nav-list-link">Key Management</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in API Reference category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/api-reference/README/" class="nav-list-link">API Reference</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/api-reference/quick-reference/" class="nav-list-link">Quick Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/error-types/" class="nav-list-link">Error Types</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/data-types/" class="nav-list-link">Data Types</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/core-api/" class="nav-list-link">Core API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/wallet-api/" class="nav-list-link">Wallet API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/credential-service-api/" class="nav-list-link">Credential Service API Reference</a></li><li class="nav-list-item"><a href="/trustweave/api-reference/smart-contract-api/" class="nav-list-link">Smart Contract API Reference</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Reference category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/reference/README/" class="nav-list-link">Reference</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/modules/core-modules/" class="nav-list-link">Core Modules</a></li><li class="nav-list-item"><a href="/trustweave/faq/" class="nav-list-link">Frequently Asked Questions</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Advanced Topics category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/trustweave/advanced/README/" class="nav-list-link">Advanced Topics</a><ul class="nav-list"><li class="nav-list-item"><a href="/trustweave/advanced/error-handling/" class="nav-list-link">Error Handling</a></li></ul></li><li class="nav-list-item"><a href="/trustweave/integrations/README/" class="nav-list-link">Integration Modules</a></li><li class="nav-list-item"><a href="/trustweave/contributing/README/" class="nav-list-link">Contributing to TrustWeave</a></li></ul>

</nav>






    <footer class="site-footer">
      This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.
    </footer>

</div>


  <div class="main" id="top">
    <div id="main-header" class="main-header">



<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search TrustWeave Developer Documentation" aria-label="Search TrustWeave Developer Documentation" autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>




</div>

    <div class="main-content-wrap">

      <div id="main-content" class="main-content">
        <main>

            <h1 id="zero-trust-continuous-authentication-scenario">


    <a href="#zero-trust-continuous-authentication-scenario" class="anchor-heading" aria-labelledby="zero-trust-continuous-authentication-scenario"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Zero Trust Continuous Authentication Scenario


</h1>


<p>This guide demonstrates how to build a Zero Trust continuous authentication system using TrustWeave. You’ll learn how authentication authorities can issue short-lived authentication credentials, how users can store them in wallets, and how systems can continuously verify authentication without traditional session-based access.</p>
<h2 id="what-youll-build">


    <a href="#what-youll-build" class="anchor-heading" aria-labelledby="what-youll-build"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What You’ll Build


</h2>


<p>By the end of this tutorial, you’ll have:</p>

<ul>
  <li>✅ Created DIDs for authentication authority (issuer) and users (holder)</li>
  <li>✅ Issued Verifiable Credentials for short-lived authentication</li>
  <li>✅ Stored authentication credentials in wallet</li>
  <li>✅ Implemented continuous re-authentication</li>
  <li>✅ Created time-bound authentication credentials</li>
  <li>✅ Verified authentication without session cookies</li>
  <li>✅ Implemented device attestation integration</li>
  <li>✅ Demonstrated Zero Trust principles</li>
</ul>
<h2 id="big-picture--significance">


    <a href="#big-picture--significance" class="anchor-heading" aria-labelledby="big-picture--significance"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Big Picture &amp; Significance


</h2>

<h3 id="the-zero-trust-challenge">


    <a href="#the-zero-trust-challenge" class="anchor-heading" aria-labelledby="the-zero-trust-challenge"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The Zero Trust Challenge


</h3>


<p>Traditional authentication relies on session-based access that becomes vulnerable once a session is established. Zero Trust requires continuous verification of identity, device, and context. Verifiable credentials enable continuous authentication without traditional sessions.</p>

<p><strong>Industry Context:</strong></p>
<ul>
  <li><strong>Market Adoption</strong>: 60% of enterprises adopting Zero Trust by 2025</li>
  <li><strong>Security</strong>: Eliminates “trust but verify” model</li>
  <li><strong>Regulatory</strong>: NIST 800-207 Zero Trust Architecture</li>
  <li><strong>User Experience</strong>: Seamless authentication without constant password entry</li>
  <li><strong>Threat Landscape</strong>: Growing need for continuous verification</li>
</ul>

<p><strong>Why This Matters:</strong></p>
<ol>
  <li><strong>Security</strong>: Continuous verification prevents session hijacking</li>
  <li><strong>Compliance</strong>: Meet Zero Trust architecture requirements</li>
  <li><strong>User Experience</strong>: Seamless authentication experience</li>
  <li><strong>Device Trust</strong>: Verify device identity continuously</li>
  <li><strong>Context Awareness</strong>: Verify user context (location, time, behavior)</li>
  <li><strong>No Sessions</strong>: Eliminate vulnerable session-based access</li>
</ol>
<h3 id="the-zero-trust-problem">


    <a href="#the-zero-trust-problem" class="anchor-heading" aria-labelledby="the-zero-trust-problem"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The Zero Trust Problem


</h3>


<p>Traditional authentication faces critical issues:</p>
<ul>
  <li><strong>Session Vulnerability</strong>: Once authenticated, sessions are vulnerable</li>
  <li><strong>No Continuous Verification</strong>: Trust is granted once, not continuously</li>
  <li><strong>Device Blindness</strong>: No verification of device identity</li>
  <li><strong>Context Ignorance</strong>: No awareness of user context</li>
  <li><strong>Password Fatigue</strong>: Constant password entry frustrates users</li>
  <li><strong>Compliance Risk</strong>: May not meet Zero Trust requirements</li>
</ul>
<h2 id="value-proposition">


    <a href="#value-proposition" class="anchor-heading" aria-labelledby="value-proposition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Value Proposition


</h2>

<h3 id="problems-solved">


    <a href="#problems-solved" class="anchor-heading" aria-labelledby="problems-solved"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Problems Solved


</h3>


<ol>
  <li><strong>Continuous Verification</strong>: Verify identity continuously, not just once</li>
  <li><strong>No Sessions</strong>: Eliminate vulnerable session-based access</li>
  <li><strong>Device Trust</strong>: Verify device identity continuously</li>
  <li><strong>Context Awareness</strong>: Verify user context (location, time, behavior)</li>
  <li><strong>Seamless UX</strong>: Fast authentication without password fatigue</li>
  <li><strong>Compliance</strong>: Automated compliance with Zero Trust architecture</li>
  <li><strong>Fraud Prevention</strong>: Cryptographic proof prevents authentication fraud</li>
</ol>
<h3 id="business-benefits">


    <a href="#business-benefits" class="anchor-heading" aria-labelledby="business-benefits"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Business Benefits


</h3>


<p><strong>For System Administrators:</strong></p>
<ul>
  <li><strong>Security</strong>: Continuous verification prevents attacks</li>
  <li><strong>Compliance</strong>: Automated Zero Trust architecture compliance</li>
  <li><strong>Trust</strong>: Cryptographic proof of authentication</li>
  <li><strong>Efficiency</strong>: Streamlined authentication process</li>
  <li><strong>User Experience</strong>: Improved user satisfaction</li>
</ul>

<p><strong>For Users:</strong></p>
<ul>
  <li><strong>Convenience</strong>: Fast, seamless authentication</li>
  <li><strong>Security</strong>: Continuous protection</li>
  <li><strong>Privacy</strong>: Control authentication data</li>
  <li><strong>Portability</strong>: Authentication credentials work everywhere</li>
  <li><strong>Control</strong>: Own and control authentication credentials</li>
</ul>

<p><strong>For Authentication Authorities:</strong></p>
<ul>
  <li><strong>Efficiency</strong>: Automated credential issuance</li>
  <li><strong>Compliance</strong>: Meet Zero Trust requirements</li>
  <li><strong>Trust</strong>: Enhanced trust through verifiable credentials</li>
  <li><strong>Scalability</strong>: Handle more authentications</li>
</ul>
<h3 id="roi-considerations">


    <a href="#roi-considerations" class="anchor-heading" aria-labelledby="roi-considerations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ROI Considerations


</h3>


<ul>
  <li><strong>Security</strong>: Eliminates session-based attacks</li>
  <li><strong>Compliance</strong>: Automated Zero Trust compliance</li>
  <li><strong>User Experience</strong>: 10x faster authentication</li>
  <li><strong>Cost Reduction</strong>: 80-90% reduction in password reset costs</li>
  <li><strong>Fraud Prevention</strong>: Eliminates authentication fraud</li>
</ul>
<h2 id="understanding-the-problem">


    <a href="#understanding-the-problem" class="anchor-heading" aria-labelledby="understanding-the-problem"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Understanding the Problem


</h2>


<p>Traditional authentication has several problems:</p>

<ol>
  <li><strong>Session vulnerability</strong>: Once authenticated, sessions are vulnerable</li>
  <li><strong>No continuous verification</strong>: Trust is granted once, not continuously</li>
  <li><strong>Device blindness</strong>: No verification of device identity</li>
  <li><strong>Context ignorance</strong>: No awareness of user context</li>
  <li><strong>Password fatigue</strong>: Constant password entry frustrates users</li>
</ol>

<p>TrustWeave solves this by enabling:</p>

<ul>
  <li><strong>Continuous verification</strong>: Verify identity continuously</li>
  <li><strong>No sessions</strong>: Eliminate session-based access</li>
  <li><strong>Device trust</strong>: Verify device identity continuously</li>
  <li><strong>Context awareness</strong>: Verify user context</li>
  <li><strong>Seamless UX</strong>: Fast authentication without passwords</li>
</ul>
<h2 id="how-it-works-the-zero-trust-authentication-flow">


    <a href="#how-it-works-the-zero-trust-authentication-flow" class="anchor-heading" aria-labelledby="how-it-works-the-zero-trust-authentication-flow"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How It Works: The Zero Trust Authentication Flow


</h2>


<pre><code class="language-mermaid">flowchart TD
    A["Authentication Authority&lt;br/&gt;Issues Short-Lived&lt;br/&gt;Authentication Credential"] --&gt;|issues| B["Authentication Credential&lt;br/&gt;User DID&lt;br/&gt;Time-Bound Validity&lt;br/&gt;Device Attestation&lt;br/&gt;Cryptographic Proof"]
    B --&gt;|stored in| C["User Wallet&lt;br/&gt;Stores auth credentials&lt;br/&gt;Maintains privacy&lt;br/&gt;Controls disclosure"]
    C --&gt;|presents| D["Zero Trust System&lt;br/&gt;Continuously Verifies&lt;br/&gt;Checks Expiration&lt;br/&gt;Validates Device&lt;br/&gt;Grants Access"]

    style A fill:#1976d2,stroke:#0d47a1,stroke-width:2px,color:#fff
    style B fill:#f57c00,stroke:#e65100,stroke-width:2px,color:#fff
    style C fill:#388e3c,stroke:#1b5e20,stroke-width:2px,color:#fff
    style D fill:#c2185b,stroke:#880e4f,stroke-width:2px,color:#fff
</code></pre>
<h2 id="prerequisites">


    <a href="#prerequisites" class="anchor-heading" aria-labelledby="prerequisites"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prerequisites


</h2>


<ul>
  <li>Java 21+</li>
  <li>Kotlin 2.2.0+</li>
  <li>Gradle 8.5+</li>
  <li>Basic understanding of Kotlin and coroutines</li>
</ul>
<h2 id="step-1-add-dependencies">


    <a href="#step-1-add-dependencies" class="anchor-heading" aria-labelledby="step-1-add-dependencies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 1: Add Dependencies


</h2>


<p>Add TrustWeave dependencies to your <code class="language-plaintext highlighter-rouge">build.gradle.kts</code>:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="nf">dependencies</span> <span class="p">{</span>
    <span class="c1">// Core TrustWeave modules</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"com.trustweave:trustweave-all:1.0.0-SNAPSHOT"</span><span class="p">)</span>

    <span class="c1">// Kotlinx Serialization</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"org.jetbrains.kotlinx:kotlinx-serialization-json:1.6.0"</span><span class="p">)</span>

    <span class="c1">// Coroutines</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3"</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="step-2-complete-runnable-example">


    <a href="#step-2-complete-runnable-example" class="anchor-heading" aria-labelledby="step-2-complete-runnable-example"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 2: Complete Runnable Example


</h2>


<p>Here’s the full Zero Trust continuous authentication flow using the TrustWeave facade API:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
</pre></td><td class="rouge-code"><pre><span class="k">package</span> <span class="nn">com.example.zero.trust</span>

<span class="k">import</span> <span class="nn">com.trustweave.TrustWeave</span>
<span class="k">import</span> <span class="nn">com.trustweave.core.*</span>
<span class="k">import</span> <span class="nn">com.trustweave.credential.PresentationOptions</span>
<span class="k">import</span> <span class="nn">com.trustweave.credential.wallet.Wallet</span>
<span class="k">import</span> <span class="nn">com.trustweave.spi.services.WalletCreationOptionsBuilder</span>
<span class="k">import</span> <span class="nn">kotlinx.coroutines.runBlocking</span>
<span class="k">import</span> <span class="nn">kotlinx.serialization.json.buildJsonObject</span>
<span class="k">import</span> <span class="nn">kotlinx.serialization.json.put</span>
<span class="k">import</span> <span class="nn">java.time.Instant</span>
<span class="k">import</span> <span class="nn">java.time.temporal.ChronoUnit</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">=</span> <span class="nf">runBlocking</span> <span class="p">{</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"="</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Zero Trust Continuous Authentication Scenario - Complete End-to-End Example"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"="</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>

    <span class="c1">// Step 1: Create TrustWeave instance</span>
    <span class="kd">val</span> <span class="py">TrustWeave</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n✅ TrustWeave initialized"</span><span class="p">)</span>

    <span class="c1">// Step 2: Create DIDs for authentication authority, users, and systems</span>
    <span class="kd">val</span> <span class="py">authAuthorityDidDoc</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">authAuthorityDid</span> <span class="p">=</span> <span class="n">authAuthorityDidDoc</span><span class="p">.</span><span class="n">id</span>
    <span class="kd">val</span> <span class="py">authAuthorityKeyId</span> <span class="p">=</span> <span class="n">authAuthorityDidDoc</span><span class="p">.</span><span class="n">verificationMethod</span><span class="p">.</span><span class="nf">firstOrNull</span><span class="p">()</span><span class="o">?.</span><span class="n">id</span>
        <span class="o">?:</span> <span class="nf">error</span><span class="p">(</span><span class="s">"No verification method found"</span><span class="p">)</span>

    <span class="kd">val</span> <span class="py">userDidDoc</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">userDid</span> <span class="p">=</span> <span class="n">userDidDoc</span><span class="p">.</span><span class="n">id</span>

    <span class="kd">val</span> <span class="py">deviceDidDoc</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">deviceDid</span> <span class="p">=</span> <span class="n">deviceDidDoc</span><span class="p">.</span><span class="n">id</span>

    <span class="kd">val</span> <span class="py">systemDidDoc</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="n">dids</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">systemDid</span> <span class="p">=</span> <span class="n">systemDidDoc</span><span class="p">.</span><span class="n">id</span>

    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Authentication Authority DID: $authAuthorityDid"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ User DID: $userDid"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Device DID: $deviceDid"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ System DID: $systemDid"</span><span class="p">)</span>

    <span class="c1">// Step 3: Issue short-lived authentication credential (15 minutes)</span>
    <span class="kd">val</span> <span class="py">authCredential</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">issueCredential</span><span class="p">(</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">authAuthorityDid</span><span class="p">,</span>
        <span class="n">issuerKeyId</span> <span class="p">=</span> <span class="n">authAuthorityKeyId</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">userDid</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"authentication"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"authenticated"</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"authenticationMethod"</span><span class="p">,</span> <span class="s">"Multi-Factor"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"authenticationDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"deviceId"</span><span class="p">,</span> <span class="n">deviceDid</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"deviceAttested"</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"deviceTrustLevel"</span><span class="p">,</span> <span class="s">"High"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"context"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"location"</span><span class="p">,</span> <span class="s">"Office Building A"</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"ipAddress"</span><span class="p">,</span> <span class="s">"10.0.1.100"</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"network"</span><span class="p">,</span> <span class="s">"Corporate LAN"</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"timeOfDay"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
                <span class="p">})</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"riskScore"</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span> <span class="c1">// Low risk</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"behavioralAnalysis"</span><span class="p">,</span> <span class="s">"Normal"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"sessionId"</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="c1">// No traditional session</span>
            <span class="p">})</span>
        <span class="p">},</span>
        <span class="n">types</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"AuthenticationCredential"</span><span class="p">,</span> <span class="s">"ZeroTrustCredential"</span><span class="p">),</span>
        <span class="n">expirationDate</span> <span class="p">=</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">plus</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">MINUTES</span><span class="p">).</span><span class="nf">toString</span><span class="p">()</span> <span class="c1">// Short-lived</span>
    <span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>

    <span class="nf">println</span><span class="p">(</span><span class="s">"\n✅ Short-lived authentication credential issued: ${authCredential.id}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Validity: 15 minutes"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Device: $deviceDid"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Note: No traditional session created"</span><span class="p">)</span>

    <span class="c1">// Step 4: Create user wallet and store authentication credential</span>
    <span class="kd">val</span> <span class="py">userWallet</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">createWallet</span><span class="p">(</span>
        <span class="n">holderDid</span> <span class="p">=</span> <span class="n">userDid</span><span class="p">,</span>
        <span class="n">options</span> <span class="p">=</span> <span class="nc">WalletCreationOptionsBuilder</span><span class="p">().</span><span class="nf">apply</span> <span class="p">{</span>
            <span class="n">enableOrganization</span> <span class="p">=</span> <span class="k">true</span>
            <span class="n">enablePresentation</span> <span class="p">=</span> <span class="k">true</span>
        <span class="p">}.</span><span class="nf">build</span><span class="p">()</span>
    <span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>

    <span class="kd">val</span> <span class="py">authCredentialId</span> <span class="p">=</span> <span class="n">userWallet</span><span class="p">.</span><span class="nf">store</span><span class="p">(</span><span class="n">authCredential</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Authentication credential stored in wallet: $authCredentialId"</span><span class="p">)</span>

    <span class="c1">// Step 5: Organize credential</span>
    <span class="n">userWallet</span><span class="p">.</span><span class="nf">withOrganization</span> <span class="p">{</span> <span class="n">org</span> <span class="p">-&gt;</span>
        <span class="kd">val</span> <span class="py">authCollectionId</span> <span class="p">=</span> <span class="n">org</span><span class="p">.</span><span class="nf">createCollection</span><span class="p">(</span><span class="s">"Authentication"</span><span class="p">,</span> <span class="s">"Authentication credentials"</span><span class="p">)</span>
        <span class="n">org</span><span class="p">.</span><span class="nf">addToCollection</span><span class="p">(</span><span class="n">authCredentialId</span><span class="p">,</span> <span class="n">authCollectionId</span><span class="p">)</span>
        <span class="n">org</span><span class="p">.</span><span class="nf">tagCredential</span><span class="p">(</span><span class="n">authCredentialId</span><span class="p">,</span> <span class="nf">setOf</span><span class="p">(</span><span class="s">"authentication"</span><span class="p">,</span> <span class="s">"zero-trust"</span><span class="p">,</span> <span class="s">"short-lived"</span><span class="p">,</span> <span class="s">"device-attested"</span><span class="p">))</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Authentication credential organized"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Step 6: Initial authentication verification</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n🔐 Initial Authentication Verification:"</span><span class="p">)</span>

    <span class="kd">val</span> <span class="py">initialVerification</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">verifyCredential</span><span class="p">(</span><span class="n">authCredential</span><span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">initialVerification</span><span class="p">.</span><span class="n">valid</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">credentialSubject</span> <span class="p">=</span> <span class="n">authCredential</span><span class="p">.</span><span class="n">credentialSubject</span>
        <span class="kd">val</span> <span class="py">authentication</span> <span class="p">=</span> <span class="n">credentialSubject</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">[</span><span class="s">"authentication"</span><span class="p">]</span><span class="o">?.</span><span class="n">jsonObject</span>
        <span class="kd">val</span> <span class="py">authenticated</span> <span class="p">=</span> <span class="n">authentication</span><span class="o">?.</span><span class="k">get</span><span class="p">(</span><span class="s">"authenticated"</span><span class="p">)</span><span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span><span class="o">?.</span><span class="nf">toBoolean</span><span class="p">()</span> <span class="o">?:</span> <span class="k">false</span>
        <span class="kd">val</span> <span class="py">deviceAttested</span> <span class="p">=</span> <span class="n">authentication</span><span class="o">?.</span><span class="k">get</span><span class="p">(</span><span class="s">"deviceAttested"</span><span class="p">)</span><span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span><span class="o">?.</span><span class="nf">toBoolean</span><span class="p">()</span> <span class="o">?:</span> <span class="k">false</span>
        <span class="kd">val</span> <span class="py">riskScore</span> <span class="p">=</span> <span class="n">authentication</span><span class="o">?.</span><span class="k">get</span><span class="p">(</span><span class="s">"riskScore"</span><span class="p">)</span><span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span><span class="o">?.</span><span class="nf">toDouble</span><span class="p">()</span> <span class="o">?:</span> <span class="mf">1.0</span>

        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Authentication Credential: VALID"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Authenticated: $authenticated"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Device Attested: $deviceAttested"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Risk Score: $riskScore"</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">authenticated</span> <span class="p">&amp;&amp;</span> <span class="n">deviceAttested</span> <span class="p">&amp;&amp;</span> <span class="n">riskScore</span> <span class="p">&lt;</span> <span class="mf">0.5</span><span class="p">)</span> <span class="p">{</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Authentication requirements MET"</span><span class="p">)</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Device trust verified"</span><span class="p">)</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Risk assessment passed"</span><span class="p">)</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Access GRANTED to system"</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Authentication requirements NOT MET"</span><span class="p">)</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Access DENIED"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Authentication Credential: INVALID"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Access DENIED"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Step 7: Continuous re-authentication (after 5 minutes)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n🔐 Continuous Re-Authentication (5 minutes later):"</span><span class="p">)</span>

    <span class="c1">// Simulate time passing - in production, this would be a real-time check</span>
    <span class="kd">val</span> <span class="py">reAuthCredential</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">issueCredential</span><span class="p">(</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">authAuthorityDid</span><span class="p">,</span>
        <span class="n">issuerKeyId</span> <span class="p">=</span> <span class="n">authAuthorityKeyId</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">userDid</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"authentication"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"authenticated"</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"authenticationMethod"</span><span class="p">,</span> <span class="s">"Continuous"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"authenticationDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"deviceId"</span><span class="p">,</span> <span class="n">deviceDid</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"deviceAttested"</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"deviceTrustLevel"</span><span class="p">,</span> <span class="s">"High"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"context"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"location"</span><span class="p">,</span> <span class="s">"Office Building A"</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"ipAddress"</span><span class="p">,</span> <span class="s">"10.0.1.100"</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"network"</span><span class="p">,</span> <span class="s">"Corporate LAN"</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"timeOfDay"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
                <span class="p">})</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"riskScore"</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">)</span> <span class="c1">// Slightly higher but still low</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"behavioralAnalysis"</span><span class="p">,</span> <span class="s">"Normal"</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"previousAuthTime"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">minus</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">MINUTES</span><span class="p">).</span><span class="nf">toString</span><span class="p">())</span>
            <span class="p">})</span>
        <span class="p">},</span>
        <span class="n">types</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"AuthenticationCredential"</span><span class="p">,</span> <span class="s">"ZeroTrustCredential"</span><span class="p">),</span>
        <span class="n">expirationDate</span> <span class="p">=</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">plus</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">MINUTES</span><span class="p">).</span><span class="nf">toString</span><span class="p">()</span>
    <span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>

    <span class="kd">val</span> <span class="py">reAuthVerification</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">verifyCredential</span><span class="p">(</span><span class="n">reAuthCredential</span><span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">reAuthVerification</span><span class="p">.</span><span class="n">valid</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Re-Authentication Credential: VALID"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Continuous verification: PASSED"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Device still trusted: YES"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Risk score acceptable: YES"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Access CONTINUED"</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Re-Authentication Credential: INVALID"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Access REVOKED"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Step 8: Expired credential verification</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n🔐 Expired Credential Verification:"</span><span class="p">)</span>

    <span class="c1">// Create an expired credential</span>
    <span class="kd">val</span> <span class="py">expiredCredential</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">issueCredential</span><span class="p">(</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">authAuthorityDid</span><span class="p">,</span>
        <span class="n">issuerKeyId</span> <span class="p">=</span> <span class="n">authAuthorityKeyId</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">userDid</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"authentication"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"authenticated"</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"authenticationDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">minus</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">MINUTES</span><span class="p">).</span><span class="nf">toString</span><span class="p">())</span>
            <span class="p">})</span>
        <span class="p">},</span>
        <span class="n">types</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"AuthenticationCredential"</span><span class="p">,</span> <span class="s">"ZeroTrustCredential"</span><span class="p">),</span>
        <span class="n">expirationDate</span> <span class="p">=</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">minus</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">MINUTES</span><span class="p">).</span><span class="nf">toString</span><span class="p">()</span> <span class="c1">// Already expired</span>
    <span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>

    <span class="kd">val</span> <span class="py">expiredVerification</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">verifyCredential</span><span class="p">(</span>
        <span class="n">expiredCredential</span><span class="p">,</span>
        <span class="n">options</span> <span class="p">=</span> <span class="nc">CredentialVerificationOptions</span><span class="p">(</span><span class="n">checkExpiration</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
    <span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(!</span><span class="n">expiredVerification</span><span class="p">.</span><span class="n">valid</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Expired Credential: INVALID"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Credential expired: YES"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Access DENIED"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Note: User must re-authenticate"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Step 9: High-risk scenario verification</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n🔐 High-Risk Scenario Verification:"</span><span class="p">)</span>

    <span class="kd">val</span> <span class="py">highRiskCredential</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">issueCredential</span><span class="p">(</span>
        <span class="n">issuerDid</span> <span class="p">=</span> <span class="n">authAuthorityDid</span><span class="p">,</span>
        <span class="n">issuerKeyId</span> <span class="p">=</span> <span class="n">authAuthorityKeyId</span><span class="p">,</span>
        <span class="n">credentialSubject</span> <span class="p">=</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">userDid</span><span class="p">)</span>
            <span class="nf">put</span><span class="p">(</span><span class="s">"authentication"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"authenticated"</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"authenticationDate"</span><span class="p">,</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"deviceId"</span><span class="p">,</span> <span class="n">deviceDid</span><span class="p">)</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"deviceAttested"</span><span class="p">,</span> <span class="k">false</span><span class="p">)</span> <span class="c1">// Device not attested</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"context"</span><span class="p">,</span> <span class="nf">buildJsonObject</span> <span class="p">{</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"location"</span><span class="p">,</span> <span class="s">"Unknown"</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"ipAddress"</span><span class="p">,</span> <span class="s">"192.168.1.1"</span><span class="p">)</span>
                    <span class="nf">put</span><span class="p">(</span><span class="s">"network"</span><span class="p">,</span> <span class="s">"Public WiFi"</span><span class="p">)</span>
                <span class="p">})</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"riskScore"</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">)</span> <span class="c1">// High risk</span>
                <span class="nf">put</span><span class="p">(</span><span class="s">"behavioralAnalysis"</span><span class="p">,</span> <span class="s">"Anomalous"</span><span class="p">)</span>
            <span class="p">})</span>
        <span class="p">},</span>
        <span class="n">types</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"VerifiableCredential"</span><span class="p">,</span> <span class="s">"AuthenticationCredential"</span><span class="p">,</span> <span class="s">"ZeroTrustCredential"</span><span class="p">),</span>
        <span class="n">expirationDate</span> <span class="p">=</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">plus</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">MINUTES</span><span class="p">).</span><span class="nf">toString</span><span class="p">()</span>
    <span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>

    <span class="kd">val</span> <span class="py">highRiskVerification</span> <span class="p">=</span> <span class="nc">TrustWeave</span><span class="p">.</span><span class="nf">verifyCredential</span><span class="p">(</span><span class="n">highRiskCredential</span><span class="p">).</span><span class="nf">getOrThrow</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">highRiskVerification</span><span class="p">.</span><span class="n">valid</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">credentialSubject</span> <span class="p">=</span> <span class="n">highRiskCredential</span><span class="p">.</span><span class="n">credentialSubject</span>
        <span class="kd">val</span> <span class="py">authentication</span> <span class="p">=</span> <span class="n">credentialSubject</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">[</span><span class="s">"authentication"</span><span class="p">]</span><span class="o">?.</span><span class="n">jsonObject</span>
        <span class="kd">val</span> <span class="py">deviceAttested</span> <span class="p">=</span> <span class="n">authentication</span><span class="o">?.</span><span class="k">get</span><span class="p">(</span><span class="s">"deviceAttested"</span><span class="p">)</span><span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span><span class="o">?.</span><span class="nf">toBoolean</span><span class="p">()</span> <span class="o">?:</span> <span class="k">false</span>
        <span class="kd">val</span> <span class="py">riskScore</span> <span class="p">=</span> <span class="n">authentication</span><span class="o">?.</span><span class="k">get</span><span class="p">(</span><span class="s">"riskScore"</span><span class="p">)</span><span class="o">?.</span><span class="n">jsonPrimitive</span><span class="o">?.</span><span class="n">content</span><span class="o">?.</span><span class="nf">toDouble</span><span class="p">()</span> <span class="o">?:</span> <span class="mf">1.0</span>

        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Authentication Credential: VALID (structurally)"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Device Attested: $deviceAttested"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Risk Score: $riskScore"</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(!</span><span class="n">deviceAttested</span> <span class="p">||</span> <span class="n">riskScore</span> <span class="p">&gt;</span> <span class="mf">0.5</span><span class="p">)</span> <span class="p">{</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Security requirements NOT MET"</span><span class="p">)</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Device not trusted or risk too high"</span><span class="p">)</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"❌ Access DENIED - Additional verification required"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Step 10: Create privacy-preserving authentication presentation</span>
    <span class="kd">val</span> <span class="py">authPresentation</span> <span class="p">=</span> <span class="n">userWallet</span><span class="p">.</span><span class="nf">withPresentation</span> <span class="p">{</span> <span class="n">pres</span> <span class="p">-&gt;</span>
        <span class="n">pres</span><span class="p">.</span><span class="nf">createPresentation</span><span class="p">(</span>
            <span class="n">credentialIds</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="n">authCredentialId</span><span class="p">),</span>
            <span class="n">holderDid</span> <span class="p">=</span> <span class="n">userDid</span><span class="p">,</span>
            <span class="n">options</span> <span class="p">=</span> <span class="nc">PresentationOptions</span><span class="p">(</span>
                <span class="n">holderDid</span> <span class="p">=</span> <span class="n">userDid</span><span class="p">,</span>
                <span class="n">challenge</span> <span class="p">=</span> <span class="s">"zero-trust-auth-${System.currentTimeMillis()}"</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">}</span> <span class="o">?:</span> <span class="nf">error</span><span class="p">(</span><span class="s">"Presentation capability not available"</span><span class="p">)</span>

    <span class="nf">println</span><span class="p">(</span><span class="s">"\n✅ Privacy-preserving authentication presentation created"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Holder: ${authPresentation.holder}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Credentials: ${authPresentation.verifiableCredential.size}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Note: Only authentication status shared, no personal details"</span><span class="p">)</span>

    <span class="c1">// Step 11: Demonstrate privacy - verify no personal information is exposed</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n🔒 Privacy Verification:"</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">presentationCredential</span> <span class="p">=</span> <span class="n">authPresentation</span><span class="p">.</span><span class="n">verifiableCredential</span><span class="p">.</span><span class="nf">firstOrNull</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">presentationCredential</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">subject</span> <span class="p">=</span> <span class="n">presentationCredential</span><span class="p">.</span><span class="n">credentialSubject</span>
        <span class="kd">val</span> <span class="py">hasFullName</span> <span class="p">=</span> <span class="n">subject</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">.</span><span class="nf">containsKey</span><span class="p">(</span><span class="s">"fullName"</span><span class="p">)</span>
        <span class="kd">val</span> <span class="py">hasEmail</span> <span class="p">=</span> <span class="n">subject</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">.</span><span class="nf">containsKey</span><span class="p">(</span><span class="s">"email"</span><span class="p">)</span>
        <span class="kd">val</span> <span class="py">hasPassword</span> <span class="p">=</span> <span class="n">subject</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">.</span><span class="nf">containsKey</span><span class="p">(</span><span class="s">"password"</span><span class="p">)</span>
        <span class="kd">val</span> <span class="py">hasAuthentication</span> <span class="p">=</span> <span class="n">subject</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">.</span><span class="nf">containsKey</span><span class="p">(</span><span class="s">"authentication"</span><span class="p">)</span>

        <span class="nf">println</span><span class="p">(</span><span class="s">"   Full Name exposed: $hasFullName ❌"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Email exposed: $hasEmail ❌"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Password exposed: $hasPassword ❌"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"   Authentication status: $hasAuthentication ✅"</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"✅ Privacy preserved - only authentication status shared"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Step 12: Display wallet statistics</span>
    <span class="kd">val</span> <span class="py">stats</span> <span class="p">=</span> <span class="n">userWallet</span><span class="p">.</span><span class="nf">getStatistics</span><span class="p">()</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n📊 User Wallet Statistics:"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Total credentials: ${stats.totalCredentials}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Valid credentials: ${stats.validCredentials}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Collections: ${stats.collectionsCount}"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Tags: ${stats.tagsCount}"</span><span class="p">)</span>

    <span class="c1">// Step 13: Summary</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"\n"</span> <span class="p">+</span> <span class="s">"="</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"✅ ZERO TRUST CONTINUOUS AUTHENTICATION SYSTEM COMPLETE"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Short-lived authentication credentials issued"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Continuous re-authentication implemented"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Device attestation integrated"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   Risk-based access control enabled"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"   No traditional sessions used"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"="</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p><strong>Expected Output:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
</pre></td><td class="rouge-code"><pre>======================================================================
Zero Trust Continuous Authentication Scenario - Complete End-to-End Example
======================================================================

✅ TrustWeave initialized
✅ Authentication Authority DID: did:key:z6Mk...
✅ User DID: did:key:z6Mk...
✅ Device DID: did:key:z6Mk...
✅ System DID: did:key:z6Mk...

✅ Short-lived authentication credential issued: urn:uuid:...
   Validity: 15 minutes
   Device: did:key:z6Mk...
   Note: No traditional session created
✅ Authentication credential stored in wallet: urn:uuid:...
✅ Authentication credential organized

🔐 Initial Authentication Verification:
✅ Authentication Credential: VALID
   Authenticated: true
   Device Attested: true
   Risk Score: 0.1
✅ Authentication requirements MET
✅ Device trust verified
✅ Risk assessment passed
✅ Access GRANTED to system

🔐 Continuous Re-Authentication (5 minutes later):
✅ Re-Authentication Credential: VALID
   Continuous verification: PASSED
   Device still trusted: YES
   Risk score acceptable: YES
✅ Access CONTINUED

🔐 Expired Credential Verification:
❌ Expired Credential: INVALID
   Credential expired: YES
   Access DENIED
   Note: User must re-authenticate

🔐 High-Risk Scenario Verification:
✅ Authentication Credential: VALID (structurally)
   Device Attested: false
   Risk Score: 0.85
❌ Security requirements NOT MET
❌ Device not trusted or risk too high
❌ Access DENIED - Additional verification required

✅ Privacy-preserving authentication presentation created
   Holder: did:key:z6Mk...
   Credentials: 1

🔒 Privacy Verification:
   Full Name exposed: false ❌
   Email exposed: false ❌
   Password exposed: false ❌
   Authentication status: true ✅
✅ Privacy preserved - only authentication status shared

📊 User Wallet Statistics:
   Total credentials: 1
   Valid credentials: 1
   Collections: 1
   Tags: 4

======================================================================
✅ ZERO TRUST CONTINUOUS AUTHENTICATION SYSTEM COMPLETE
   Short-lived authentication credentials issued
   Continuous re-authentication implemented
   Device attestation integrated
   Risk-based access control enabled
   No traditional sessions used
======================================================================
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="key-features-demonstrated">


    <a href="#key-features-demonstrated" class="anchor-heading" aria-labelledby="key-features-demonstrated"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Key Features Demonstrated


</h2>


<ol>
  <li><strong>Short-Lived Credentials</strong>: 15-minute validity for continuous verification</li>
  <li><strong>No Sessions</strong>: Eliminate traditional session-based access</li>
  <li><strong>Device Attestation</strong>: Verify device identity continuously</li>
  <li><strong>Risk-Based Access</strong>: Risk scoring for access decisions</li>
  <li><strong>Continuous Re-Auth</strong>: Re-authenticate periodically</li>
  <li><strong>Context Awareness</strong>: Verify user context (location, network, time)</li>
</ol>
<h2 id="real-world-extensions">


    <a href="#real-world-extensions" class="anchor-heading" aria-labelledby="real-world-extensions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Real-World Extensions


</h2>


<ul>
  <li><strong>Behavioral Biometrics</strong>: Integrate behavioral analysis</li>
  <li><strong>Adaptive Validity</strong>: Adjust credential validity based on risk</li>
  <li><strong>Multi-Device Support</strong>: Support authentication across multiple devices</li>
  <li><strong>Location-Based Policies</strong>: Enforce location-based access policies</li>
  <li><strong>Time-Based Policies</strong>: Enforce time-of-day access policies</li>
  <li><strong>Revocation</strong>: Revoke compromised authentication credentials</li>
  <li><strong>Blockchain Anchoring</strong>: Anchor authentication events for audit trails</li>
</ul>
<h2 id="related-documentation">


    <a href="#related-documentation" class="anchor-heading" aria-labelledby="related-documentation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Related Documentation


</h2>


<ul>
  <li><a href="/trustweave/getting-started/quick-start/">Quick Start</a> - Get started with TrustWeave</li>
  <li><a href="/trustweave/scenarios/security-clearance-access-control-scenario/">Security Clearance Scenario</a> - Related access control scenario</li>
  <li><a href="/trustweave/scenarios/iot-device-identity-scenario/">IoT Device Identity Scenario</a> - Device attestation integration</li>
  <li><a href="/trustweave/getting-started/common-patterns/">Common Patterns</a> - Reusable code patterns</li>
  <li><a href="/trustweave/api-reference/core-api/">API Reference</a> - Complete API documentation</li>
  <li><a href="/trustweave/getting-started/troubleshooting/">Troubleshooting</a> - Common issues and solutions</li>
</ul>






        </main>


  <hr>
  <footer>


    <!-- Hidden template for footer injection -->
<div id="footer-template" style="display: none;">
  <!-- Site Footer - Consistent across all pages -->
<footer class="site-footer">
    <div class="footer-content">
        <div class="footer-links">
            <a href="/trustweave/">Home</a>
            <a href="/trustweave/getting-started/README/">Documentation</a>
            <a href="https://github.com/geoknoesis/TrustWeave" target="_blank">GitHub</a>
            <a href="/trustweave/partnership/">Partners</a>
            <a href="https://github.com/geoknoesis/TrustWeave/blob/main/docs/README.md" target="_blank">Docs</a>
            <a href="https://github.com/geoknoesis/TrustWeave/blob/main/LICENSE" target="_blank">License</a>
            <a href="https://www.geoknoesis.com" target="_blank">Geoknoesis LLC</a>
        </div>
        <p class="footer-text">Made with ❤️ by Geoknoesis LLC</p>
    </div>
</footer>


</div>
<script>
  // Move footer from template to body bottom and make it full width
  document.addEventListener('DOMContentLoaded', function() {
    const template = document.getElementById('footer-template');
    if (template) {
      const footer = template.querySelector('.site-footer');
      if (footer) {
        // Move footer to body level (outside of any containers)
        document.body.appendChild(footer);
        template.remove();

        // Ensure footer spans full width by removing any parent constraints
        footer.style.position = 'relative';
        footer.style.width = '100vw';
        footer.style.marginLeft = 'calc(-50vw + 50%)';
        footer.style.marginRight = 'calc(-50vw + 50%)';
        footer.style.marginTop = 'auto'; // Push to bottom in flexbox layout
        footer.style.zIndex = '0'; // Below search overlay
      }
    }

    // Function to update footer visibility based on search state
    function updateFooterVisibility() {
      const footer = document.querySelector('.site-footer');
      const htmlElement = document.documentElement;

      if (footer && htmlElement) {
        const isSearchActive = htmlElement.classList.contains('search-active');
        if (isSearchActive) {
          // Hide footer when search is active - use multiple methods to ensure it's hidden
          footer.style.display = 'none';
          footer.style.visibility = 'hidden';
          footer.style.opacity = '0';
          footer.style.zIndex = '-999';
          footer.style.pointerEvents = 'none';
        } else {
          // Show footer when search is not active
          footer.style.display = 'block';
          footer.style.visibility = 'visible';
          footer.style.opacity = '1';
          footer.style.marginTop = 'auto';
          footer.style.position = 'relative';
          footer.style.zIndex = '-1';
          footer.style.pointerEvents = 'auto';
        }
      }
    }

    // Monitor search state and hide/show footer appropriately
    const observer = new MutationObserver(function(mutations) {
      updateFooterVisibility();
    });

    // Also listen for input events on search input as a backup
    // This ensures footer is hidden immediately when user starts typing
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
      // Use requestAnimationFrame for better performance
      const handleSearchChange = function() {
        requestAnimationFrame(updateFooterVisibility);
      };

      searchInput.addEventListener('input', handleSearchChange);
      searchInput.addEventListener('focus', handleSearchChange);
      searchInput.addEventListener('keydown', handleSearchChange);
    }

    // Observe documentElement (html) for class changes (like search-active)
    // The search script adds 'search-active' to documentElement, not body
    if (document.documentElement) {
      observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['class']
      });

      // Initial check
      updateFooterVisibility();
    }
  });
</script>



  </footer>


      </div>
    </div>



<div class="search-overlay"></div>


  </div>








<script type="module">

  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.esm.min.mjs';


  var config = {}
;
  mermaid.initialize(config);
  mermaid.run({
    querySelector: '.language-mermaid',
  });
</script>




</body>
</html>

